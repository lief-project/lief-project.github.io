<!doctype html><html lang=en-us prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb#"><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=description content><meta name=HandheldFriendly content="True"><meta name=MobileOptimized content="320"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=google-site-verification content="OcWjYs0PdsQZtqu1ms5QSr5FplDf_t5GEneU---wWzM"><meta name=description content="This blog post describes the recent updates in LIEF Rust bindings"><meta name=keywords content><meta property="og:type" content="article"><meta property="og:description" content="This blog post describes the recent updates in LIEF Rust bindings"><meta property="og:title" content="LIEF Rust bindings updates"><meta property="og:site_name" content="LIEF"><meta property="og:image" content="https://lief.re/blog/2024-06-16-rust-update/featured.webp"><meta property="og:image:type" content="image/png"><meta property="og:image:width" content><meta property="og:image:height" content><meta property="og:url" content="https://lief.re/blog/2024-06-16-rust-update/"><meta property="og:locale" content="en-us"><meta property="article:published_time" content="2024-06-16
"><meta property="article:modified_time" content="2024-06-16
"><meta name=twitter:card content="summary"><meta name=twitter:site content="@lief_project"><meta name=twitter:creator content="@lief_project"><meta name=twitter:title content="LIEF Rust bindings updates | LIEF"><meta name=twitter:description content="This blog post describes the recent updates in LIEF Rust bindings | LIEF"><meta property="twitter:image:src" content="https://lief.re/blog/2024-06-16-rust-update/featured.webp"><meta name=twitter:domain content="https://lief.re/blog/2024-06-16-rust-update/"><title>LIEF</title><link rel=canonical href=https://lief.re/blog/2024-06-16-rust-update/><link rel=stylesheet type=text/css href=https://lief.re//css/theme.min.css><link rel=stylesheet type=text/css href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.0/css/all.min.css><link rel=stylesheet type=text/css href=https://lief.re//css/vendor.min.css><link rel=stylesheet type=text/css href=https://lief.re//css/termynal.css><link rel=stylesheet type=text/css href=https://lief.re//css/animate.css><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:ital,wght@0,100..800;1,100..800&display=swap" rel=stylesheet type=text/css><link rel=apple-touch-icon href=https://lief.re//img/favicon.ico type=image/x-icon><link rel="shortcut icon" href=https://lief.re//img/favicon.ico type=image/x-icon><link rel=icon href=https://lief.re//img/favicon.ico type=image/x-icon><style></style></head><body class=bg-light><nav class="navbar navbar-expand-lg navbar-light bg-light position-absolute w-100 bg-white" role=navigation><div class="container position-relative"><a href=https://lief.re/ class=navbar-brand>LIEF</a>
<button class=navbar-toggler data-toggle=collapse data-target=#navbar-collapse>
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse justify-content-end mt-2 mt-lg-0" id=navbar-collapse><ul class=navbar-nav><li class=nav-item><a class=nav-link href=https://lief.re/><i class="fa-solid fa-house mr-3"></i>
Home</a></li><li class=nav-item><a class=nav-link href=https://lief.re/blog><i class="fa-solid fa-rss mr-3"></i>
Blog</a></li><li class=nav-item><a class=nav-link href=https://lief.re/download><i class="fa-solid fa-download mr-3"></i>
Download</a></li><li class="nav-item dropdown"><a href=https://lief.re/doc/latest class="nav-link dropdown-toggle" data-toggle=dropdown><i class="fa-solid fa-book mr-3"></i>
Documentation</a><div class="dropdown-menu px-4" role=menu><a class="dropdown-item d-flex align-items-center border-bottom border-gray-100 p-2" href=https://lief.re/doc/latest/><span class="svg-icon text-purple mr-3"><svg width="512" height="512" viewBox="0 0 512 512"><title>ionicons-v5-m</title><path d="M160 389a20.91 20.91.0 01-13.82-5.2l-128-112a21 21 0 010-31.6l128-112a21 21 0 0127.66 31.61L63.89 256l109.94 96.19A21 21 0 01160 389z"/><path d="M352 389a21 21 0 01-13.84-36.81L448.11 256 338.17 159.81a21 21 0 0127.66-31.61l128 112a21 21 0 010 31.6l-128 112A20.89 20.89.0 01352 389z"/></svg>
</span><span><p class=mb-0>API
<span class="badge badge-pastel-success font-weight-bold pt-2 ml-1">Latest</span></p><span class=text-secondary>Sphinx & Doxygen API documentation</span>
</span></a><a class="dropdown-item d-flex align-items-center border-bottom border-gray-100 p-2" href=https://lief.re/doc/stable/><span class="svg-icon text-purple mr-3"><svg width="512" height="512" viewBox="0 0 512 512"><title>ionicons-v5-m</title><path d="M160 389a20.91 20.91.0 01-13.82-5.2l-128-112a21 21 0 010-31.6l128-112a21 21 0 0127.66 31.61L63.89 256l109.94 96.19A21 21 0 01160 389z"/><path d="M352 389a21 21 0 01-13.84-36.81L448.11 256 338.17 159.81a21 21 0 0127.66-31.61l128 112a21 21 0 010 31.6l-128 112A20.89 20.89.0 01352 389z"/></svg>
</span><span><p class=mb-0>API
<span class="badge badge-pastel-primary font-weight-bold pt-2 ml-1">Stable</span></p><span class=text-secondary>Sphinx & Doxygen API documentation</span>
</span></a><a class="dropdown-item d-flex align-items-center border-bottom border-gray-100 p-2" href=https://lief.re/doc/latest/changelog.html><span class="svg-icon text-purple mr-3"><svg width="512" height="512" viewBox="0 0 512 512"><title>ionicons-v5-j</title><path d="M256 256s-48-96-126-96c-54.12.0-98 43-98 96s43.88 96 98 96c30 0 56.45-13.18 78-32" style="fill:none;stroke:#000;stroke-linecap:round;stroke-miterlimit:10;stroke-width:48px"/><path d="M256 256s48 96 126 96c54.12.0 98-43 98-96s-43.88-96-98-96c-29.37.0-56.66 13.75-78 32" style="fill:none;stroke:#000;stroke-linecap:round;stroke-miterlimit:10;stroke-width:48px"/></svg>
</span><span><p class=mb-0>Changelog</p><span class=text-secondary>See all updates</span></span></a></div></li><li class=nav-item><a class=nav-link href=https://lief.re/about><i class="fa-solid fa-bars-staggered mr-3"></i>
About</a></li><li class="nav-item ml-lg-3 mt-3 mt-lg-0"><a class="hover-lift-light mt-1" href=https://github.com/lief-project/LIEF target=_blank><i class="fab fa-2x fa-github text-darkblue"></i></a></li><li class="nav-item ml-lg-3 mt-3 mt-lg-0"><a class="hover-lift-light mt-1" href=https://discord.gg/jGQtyAYChJ target=_blank><i class="fab fa-2x fa-discord text-darkblue mr-3"></i></a></li><li class="nav-item ml-lg-3 mt-3 mt-lg-0"><a href=https://github.com/sponsors/lief-project/ class="btn btn-outline-pink" target=_blank><i class="fa-solid fa-heart mr-3"></i> Sponsor</a></li></ul></div></div></nav><div class="h-200 h-md-250 bg-light"></div><section class="bg-light pb-8"><div class="container fx-fade-up"><div class="row justify-content-center"><div class="col-lg-12 bg-white shadow-light-lg rounded py-5 px-4 px-md-7 mt-n6"><div class="avatar d-block mx-auto mt-n6 relative-top--7"><a href=https://www.romainthomas.fr target=_blank><img src=https://lief.re/img/avatar/romain.png class="rounded-circle avatar-image shadow" alt=Avatar></a></div><h2 class="text-center font-weight-normal mt-4">LIEF Rust bindings updates</h2><div class="text-center text-muted font-size-sm mt-3"><span class=mr-3><span class="svg-icon svg-icon-sm text-muted relative-top--1 mr-1"><svg width="512" height="512" viewBox="0 0 512 512"><title>ionicons-v5-k</title><polygon points="364.13 125.25 87 403 64 448 108.99 425 386.75 147.87 364.13 125.25" style="fill:none;stroke:#000;stroke-linecap:round;stroke-linejoin:round;stroke-width:32px"/><path d="M420.69 68.69 398.07 91.31l22.62 22.63 22.62-22.63a16 16 0 000-22.62h0a16 16 0 00-22.62.0z" style="fill:none;stroke:#000;stroke-linecap:round;stroke-linejoin:round;stroke-width:32px"/></svg>
</span><a href=https://www.romainthomas.fr target=_blank>Romain Thomas </a></span><span class=ml-3><i class="far fa-calendar fa-xs mr-1 relative-top--1"></i>
June 16, 2024</span></div><img src=https://lief.re//img/waves.png class="d-block mx-auto mt-4 mb-5" alt=Wave><div class=text-dark><p>The rust bindings for LIEF are getting more and more production-ready for the next
official release of LIEF (<code>v0.15.0</code>). This blog post exposes the recent updates on
these bindings and some use cases.</p><h2 id=documentation>Documentation</h2><p>The Rust documentation for the current bindings is now almost complete such as most
of the functions and structures are documented:</p><p><a href=https://lief-rs.s3.fr-par.scw.cloud/doc/latest/lief/pe/struct.Signature.html#method.check><img src=./doc.png alt="LIEF Rust Documentation"></a></p><p>One can access the nightly doc at this address:
<a href=https://lief-rs.s3.fr-par.scw.cloud/doc/latest/lief/index.html>https://lief-rs.s3.fr-par.scw.cloud/doc/latest/lief/index.html</a></p><h2 id=new-architectures-supported>New Architectures Supported</h2><p>As mentioned in the <a href=https://lief.re/blog/2024-04-28-rust/>previous blog post</a>,
the Rust bindings work with a &ldquo;pre-compilation&rdquo; step. Since the previous blog post,
I added the support of iOS (i.e. <code>aarch64-apple-ios</code>) and for Linux ARM64 (i.e. <code>aarch64-unknown-linux-gnu</code>)
which gives us this support in LIEF compared to the <a href=https://doc.rust-lang.org/nightly/rustc/platform-support.html#platform-support>Rust Platform Support</a></p><h3 id=rust-tier-1-support>Rust Tier 1 Support</h3><table><thead><tr><th>Triplet</th><th>Support</th><th>Comment</th></tr></thead><tbody><tr><td><code>aarch64-unknown-linux-gnu</code></td><td>&#9989;</td><td></td></tr><tr><td><code>i686-pc-windows-gnu</code></td><td>&#x274c;</td><td></td></tr><tr><td><code>i686-pc-windows-msvc</code></td><td>&#x1f937;</td><td>Could be supported if needed</td></tr><tr><td><code>i686-unknown-linux-gnu</code></td><td>&#x1f937;</td><td>Could be supported if needed</td></tr><tr><td><code>x86_64-apple-darwin</code></td><td>&#9989;</td><td></td></tr><tr><td><code>x86_64-pc-windows-gnu</code></td><td>&#x274c;</td><td></td></tr><tr><td><code>x86_64-pc-windows-msvc</code></td><td>&#9989;</td><td></td></tr><tr><td><code>x86_64-unknown-linux-gnu</code></td><td>&#9989;</td><td></td></tr></tbody></table><h3 id=rust-tier-2-support>Rust Tier 2 Support</h3><table><thead><tr><th>Triplet</th><th>Support</th><th>Comment</th></tr></thead><tbody><tr><td><code>aarch64-apple-ios</code></td><td>&#9989;</td><td></td></tr><tr><td><code>aarch64-apple-ios-sim</code></td><td>&#x1f937;</td><td>Could be supported if needed</td></tr><tr><td><code>aarch64-linux-android</code></td><td>&#9201;&#xfe0f;</td><td>Planned</td></tr><tr><td><code>aarch64-apple-darwin</code></td><td>&#9989;</td><td></td></tr><tr><td><code>x86_64-unknown-linux-musl</code></td><td>&#9201;&#xfe0f;</td><td>Planned</td></tr></tbody></table><p>The support for some triplets like <code>i686-pc-windows-msvc</code> will be done on an as-needed
basis so feel free to reach out or to open an issue/discussion on GitHub if you need this
support.</p><h2 id=uses-cases>Uses Cases</h2><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span><span style=color:#57606a>// This code checks the PE Authenticode
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span><span style=color:#57606a></span><span style=color:#fff>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span><span style=color:#fff></span><span style=color:#cf222e>let</span><span style=color:#fff> </span>path<span style=color:#fff> </span><span style=color:#0550ae>=</span><span style=color:#fff> </span>std::env::args<span style=color:#1f2328>().</span>last<span style=color:#1f2328>().</span>unwrap<span style=color:#1f2328>();</span><span style=color:#fff>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span><span style=color:#fff></span><span style=color:#cf222e>let</span><span style=color:#fff> </span><span style=color:#cf222e>mut</span><span style=color:#fff> </span>file<span style=color:#fff> </span><span style=color:#0550ae>=</span><span style=color:#fff> </span>std::fs::File::open<span style=color:#1f2328>(</span>path<span style=color:#1f2328>).</span>expect<span style=color:#1f2328>(</span><span style=color:#0a3069>&#34;Can&#39;t open the file&#34;</span><span style=color:#1f2328>);</span><span style=color:#fff>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span><span style=color:#fff>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span><span style=color:#fff></span><span style=color:#cf222e>if</span><span style=color:#fff> </span><span style=color:#cf222e>let</span><span style=color:#fff> </span><span style=color:#6639ba>Some</span><span style=color:#1f2328>(</span>lief::Binary::<span style=color:#0550ae>PE</span><span style=color:#1f2328>(</span>pe<span style=color:#1f2328>))</span><span style=color:#fff> </span><span style=color:#0550ae>=</span><span style=color:#fff> </span>lief::Binary::from<span style=color:#1f2328>(</span><span style=color:#0550ae>&amp;</span><span style=color:#cf222e>mut</span><span style=color:#fff> </span>file<span style=color:#1f2328>)</span><span style=color:#fff> </span><span style=color:#1f2328>{</span><span style=color:#fff>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span><span style=color:#fff>    </span><span style=color:#cf222e>let</span><span style=color:#fff> </span>result<span style=color:#fff> </span><span style=color:#0550ae>=</span><span style=color:#fff> </span>pe<span style=color:#1f2328>.</span>verify_signature<span style=color:#1f2328>(</span>pe::signature::VerificationChecks::<span style=color:#0550ae>DEFAULT</span><span style=color:#1f2328>);</span><span style=color:#fff>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span><span style=color:#fff>    </span><span style=color:#cf222e>if</span><span style=color:#fff> </span>result<span style=color:#1f2328>.</span>is_ok<span style=color:#1f2328>()</span><span style=color:#fff> </span><span style=color:#1f2328>{</span><span style=color:#fff>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span><span style=color:#fff>        </span><span style=color:#6639ba>println!</span><span style=color:#1f2328>(</span><span style=color:#0a3069>&#34;Valid signature!&#34;</span><span style=color:#1f2328>);</span><span style=color:#fff>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span><span style=color:#fff>    </span><span style=color:#1f2328>}</span><span style=color:#fff> </span><span style=color:#cf222e>else</span><span style=color:#fff> </span><span style=color:#1f2328>{</span><span style=color:#fff>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span><span style=color:#fff>        </span><span style=color:#6639ba>println!</span><span style=color:#1f2328>(</span><span style=color:#0a3069>&#34;Signature not valid: </span><span style=color:#0a3069>{}</span><span style=color:#0a3069>&#34;</span><span style=color:#1f2328>,</span><span style=color:#fff> </span>result<span style=color:#1f2328>);</span><span style=color:#fff>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span><span style=color:#fff>    </span><span style=color:#1f2328>}</span><span style=color:#fff>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span><span style=color:#fff>    </span><span style=color:#cf222e>return</span><span style=color:#fff> </span>ExitCode::<span style=color:#0550ae>SUCCESS</span><span style=color:#1f2328>;</span><span style=color:#fff>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span><span style=color:#fff></span><span style=color:#1f2328>}</span><span style=color:#fff>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span><span style=color:#fff></span>ExitCode::<span style=color:#0550ae>FAILURE</span><span style=color:#fff>
</span></span></span></code></pre></div><hr><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span><span style=color:#57606a>// This code list all the libraries needed by an ELF binary as well as
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span><span style=color:#57606a>// the versioning of the symbols.
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span><span style=color:#57606a>// Example of output:
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span><span style=color:#57606a>// Dependencies:
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span><span style=color:#57606a>//   - libclang-cpp.so.17
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span><span style=color:#57606a>//   - libLLVM-17.so
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span><span style=color:#57606a>//   - libstdc++.so.6
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span><span style=color:#57606a>//   - libc.so.6
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span><span style=color:#57606a>// Versions:
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span><span style=color:#57606a>//   From libc.so.6
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span><span style=color:#57606a>//     - GLIBC_ABI_DT_RELR
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span><span style=color:#57606a>//     - GLIBC_2.14
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span><span style=color:#57606a>//     - GLIBC_2.34
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span><span style=color:#57606a>//     - GLIBC_2.32
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span><span style=color:#57606a>//   From libstdc++.so.6
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span><span><span style=color:#57606a>//     - GLIBCXX_3.4.29
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span><span><span style=color:#57606a>//     - GLIBCXX_3.4.30
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span><span><span style=color:#57606a>//   From libLLVM-17.so
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19</span><span><span style=color:#57606a>//     - LLVM_17
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20</span><span><span style=color:#57606a></span><span style=color:#fff>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21</span><span><span style=color:#fff></span><span style=color:#cf222e>let</span><span style=color:#fff> </span><span style=color:#cf222e>mut</span><span style=color:#fff> </span>args<span style=color:#fff> </span><span style=color:#0550ae>=</span><span style=color:#fff> </span>std::env::args<span style=color:#1f2328>();</span><span style=color:#fff>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22</span><span><span style=color:#fff></span><span style=color:#cf222e>if</span><span style=color:#fff> </span>args<span style=color:#1f2328>.</span>len<span style=color:#1f2328>()</span><span style=color:#fff> </span><span style=color:#0550ae>!=</span><span style=color:#fff> </span><span style=color:#0550ae>2</span><span style=color:#fff> </span><span style=color:#1f2328>{</span><span style=color:#fff>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23</span><span><span style=color:#fff>    </span><span style=color:#6639ba>println!</span><span style=color:#1f2328>(</span><span style=color:#0a3069>&#34;Usage: </span><span style=color:#0a3069>{}</span><span style=color:#0a3069> &lt;binary&gt;&#34;</span><span style=color:#1f2328>,</span><span style=color:#fff> </span>args<span style=color:#1f2328>.</span>next<span style=color:#1f2328>().</span>unwrap<span style=color:#1f2328>());</span><span style=color:#fff>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">24</span><span><span style=color:#fff>    </span><span style=color:#cf222e>return</span><span style=color:#fff> </span>ExitCode::<span style=color:#0550ae>FAILURE</span><span style=color:#1f2328>;</span><span style=color:#fff>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">25</span><span><span style=color:#fff></span><span style=color:#1f2328>}</span><span style=color:#fff>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">26</span><span><span style=color:#fff>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">27</span><span><span style=color:#fff></span><span style=color:#cf222e>let</span><span style=color:#fff> </span>path<span style=color:#fff> </span><span style=color:#0550ae>=</span><span style=color:#fff> </span>std::env::args<span style=color:#1f2328>().</span>last<span style=color:#1f2328>().</span>unwrap<span style=color:#1f2328>();</span><span style=color:#fff>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">28</span><span><span style=color:#fff></span><span style=color:#cf222e>let</span><span style=color:#fff> </span><span style=color:#cf222e>mut</span><span style=color:#fff> </span>file<span style=color:#fff> </span><span style=color:#0550ae>=</span><span style=color:#fff> </span>std::fs::File::open<span style=color:#1f2328>(</span><span style=color:#0550ae>&amp;</span>path<span style=color:#1f2328>).</span>expect<span style=color:#1f2328>(</span><span style=color:#0a3069>&#34;Can&#39;t open the file&#34;</span><span style=color:#1f2328>);</span><span style=color:#fff>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">29</span><span><span style=color:#fff></span><span style=color:#cf222e>if</span><span style=color:#fff> </span><span style=color:#cf222e>let</span><span style=color:#fff> </span><span style=color:#6639ba>Some</span><span style=color:#1f2328>(</span>lief::Binary::<span style=color:#0550ae>ELF</span><span style=color:#1f2328>(</span>elf<span style=color:#1f2328>))</span><span style=color:#fff> </span><span style=color:#0550ae>=</span><span style=color:#fff> </span>lief::Binary::from<span style=color:#1f2328>(</span><span style=color:#0550ae>&amp;</span><span style=color:#cf222e>mut</span><span style=color:#fff> </span>file<span style=color:#1f2328>)</span><span style=color:#fff> </span><span style=color:#1f2328>{</span><span style=color:#fff>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">30</span><span><span style=color:#fff>    </span><span style=color:#6639ba>println!</span><span style=color:#1f2328>(</span><span style=color:#0a3069>&#34;Dependencies:&#34;</span><span style=color:#1f2328>);</span><span style=color:#fff>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">31</span><span><span style=color:#fff>    </span><span style=color:#cf222e>for</span><span style=color:#fff> </span>entry<span style=color:#fff> </span><span style=color:#cf222e>in</span><span style=color:#fff> </span>elf<span style=color:#1f2328>.</span>dynamic_entries<span style=color:#1f2328>()</span><span style=color:#fff> </span><span style=color:#1f2328>{</span><span style=color:#fff>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">32</span><span><span style=color:#fff>        </span><span style=color:#cf222e>if</span><span style=color:#fff> </span><span style=color:#cf222e>let</span><span style=color:#fff> </span>dynamic::Entries::Library<span style=color:#1f2328>(</span>lib<span style=color:#1f2328>)</span><span style=color:#fff> </span><span style=color:#0550ae>=</span><span style=color:#fff> </span>entry<span style=color:#fff> </span><span style=color:#1f2328>{</span><span style=color:#fff>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">33</span><span><span style=color:#fff>            </span><span style=color:#6639ba>println!</span><span style=color:#1f2328>(</span><span style=color:#0a3069>&#34;  - </span><span style=color:#0a3069>{}</span><span style=color:#0a3069>&#34;</span><span style=color:#1f2328>,</span><span style=color:#fff> </span>lib<span style=color:#1f2328>.</span>name<span style=color:#1f2328>());</span><span style=color:#fff>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">34</span><span><span style=color:#fff>        </span><span style=color:#1f2328>}</span><span style=color:#fff>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">35</span><span><span style=color:#fff>    </span><span style=color:#1f2328>}</span><span style=color:#fff>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">36</span><span><span style=color:#fff>    </span><span style=color:#6639ba>println!</span><span style=color:#1f2328>(</span><span style=color:#0a3069>&#34;Versions:&#34;</span><span style=color:#1f2328>);</span><span style=color:#fff>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">37</span><span><span style=color:#fff>    </span><span style=color:#cf222e>for</span><span style=color:#fff> </span>version<span style=color:#fff> </span><span style=color:#cf222e>in</span><span style=color:#fff> </span>elf<span style=color:#1f2328>.</span>symbols_version_requirement<span style=color:#1f2328>()</span><span style=color:#fff> </span><span style=color:#1f2328>{</span><span style=color:#fff>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">38</span><span><span style=color:#fff>        </span><span style=color:#6639ba>println!</span><span style=color:#1f2328>(</span><span style=color:#0a3069>&#34;  From </span><span style=color:#0a3069>{}</span><span style=color:#0a3069>&#34;</span><span style=color:#1f2328>,</span><span style=color:#fff> </span>version<span style=color:#1f2328>.</span>name<span style=color:#1f2328>());</span><span style=color:#fff>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">39</span><span><span style=color:#fff>        </span><span style=color:#cf222e>for</span><span style=color:#fff> </span>aux<span style=color:#fff> </span><span style=color:#cf222e>in</span><span style=color:#fff> </span>version<span style=color:#1f2328>.</span>auxiliary_symbols<span style=color:#1f2328>()</span><span style=color:#fff> </span><span style=color:#1f2328>{</span><span style=color:#fff>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">40</span><span><span style=color:#fff>            </span><span style=color:#6639ba>println!</span><span style=color:#1f2328>(</span><span style=color:#0a3069>&#34;    - </span><span style=color:#0a3069>{}</span><span style=color:#0a3069>&#34;</span><span style=color:#1f2328>,</span><span style=color:#fff> </span>aux<span style=color:#1f2328>.</span>name<span style=color:#1f2328>());</span><span style=color:#fff>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">41</span><span><span style=color:#fff>        </span><span style=color:#1f2328>}</span><span style=color:#fff>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">42</span><span><span style=color:#fff>    </span><span style=color:#1f2328>}</span><span style=color:#fff>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">43</span><span><span style=color:#fff>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">44</span><span><span style=color:#fff>    </span><span style=color:#cf222e>return</span><span style=color:#fff> </span>ExitCode::<span style=color:#0550ae>SUCCESS</span><span style=color:#1f2328>;</span><span style=color:#fff>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">45</span><span><span style=color:#fff></span><span style=color:#1f2328>}</span><span style=color:#fff>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">46</span><span><span style=color:#fff></span><span style=color:#6639ba>println!</span><span style=color:#1f2328>(</span><span style=color:#0a3069>&#34;Can&#39;t process </span><span style=color:#0a3069>{}</span><span style=color:#0a3069>&#34;</span><span style=color:#1f2328>,</span><span style=color:#fff> </span>path<span style=color:#1f2328>);</span><span style=color:#fff>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">47</span><span><span style=color:#fff></span>ExitCode::<span style=color:#0550ae>FAILURE</span><span style=color:#fff>
</span></span></span></code></pre></div><hr><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span><span style=color:#57606a>// Inspecting the PE rich header
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span><span style=color:#57606a></span><span style=color:#fff>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span><span style=color:#fff></span><span style=color:#cf222e>let</span><span style=color:#fff> </span>path<span style=color:#fff> </span><span style=color:#0550ae>=</span><span style=color:#fff> </span>std::env::args<span style=color:#1f2328>().</span>last<span style=color:#1f2328>().</span>unwrap<span style=color:#1f2328>();</span><span style=color:#fff>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span><span style=color:#fff></span><span style=color:#cf222e>let</span><span style=color:#fff> </span><span style=color:#cf222e>mut</span><span style=color:#fff> </span>file<span style=color:#fff> </span><span style=color:#0550ae>=</span><span style=color:#fff> </span>std::fs::File::open<span style=color:#1f2328>(</span><span style=color:#0550ae>&amp;</span>path<span style=color:#1f2328>).</span>expect<span style=color:#1f2328>(</span><span style=color:#0a3069>&#34;Can&#39;t open the file&#34;</span><span style=color:#1f2328>);</span><span style=color:#fff>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span><span style=color:#fff>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span><span style=color:#fff></span><span style=color:#cf222e>if</span><span style=color:#fff> </span><span style=color:#cf222e>let</span><span style=color:#fff> </span><span style=color:#6639ba>Some</span><span style=color:#1f2328>(</span>lief::Binary::<span style=color:#0550ae>PE</span><span style=color:#1f2328>(</span>pe<span style=color:#1f2328>))</span><span style=color:#fff> </span><span style=color:#0550ae>=</span><span style=color:#fff> </span>lief::Binary::from<span style=color:#1f2328>(</span><span style=color:#0550ae>&amp;</span><span style=color:#cf222e>mut</span><span style=color:#fff> </span>file<span style=color:#1f2328>)</span><span style=color:#fff> </span><span style=color:#1f2328>{</span><span style=color:#fff>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span><span style=color:#fff>    </span><span style=color:#cf222e>let</span><span style=color:#fff> </span>rich_header<span style=color:#fff> </span><span style=color:#0550ae>=</span><span style=color:#fff> </span>pe<span style=color:#1f2328>.</span>rich_header<span style=color:#1f2328>().</span>unwrap_or_else<span style=color:#1f2328>(</span><span style=color:#0550ae>||</span><span style=color:#fff> </span><span style=color:#1f2328>{</span><span style=color:#fff>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span><span style=color:#fff>        </span><span style=color:#6639ba>println!</span><span style=color:#1f2328>(</span><span style=color:#0a3069>&#34;Rich header not found!&#34;</span><span style=color:#1f2328>);</span><span style=color:#fff>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span><span style=color:#fff>        </span>process::exit<span style=color:#1f2328>(</span><span style=color:#0550ae>0</span><span style=color:#1f2328>);</span><span style=color:#fff>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span><span style=color:#fff>    </span><span style=color:#1f2328>});</span><span style=color:#fff>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span><span style=color:#fff>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span><span style=color:#fff>    </span><span style=color:#6639ba>println!</span><span style=color:#1f2328>(</span><span style=color:#0a3069>&#34;Rich header key: 0x</span><span style=color:#0a3069>{:x}</span><span style=color:#0a3069>&#34;</span><span style=color:#1f2328>,</span><span style=color:#fff> </span>rich_header<span style=color:#1f2328>.</span>key<span style=color:#1f2328>());</span><span style=color:#fff>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span><span style=color:#fff>    </span><span style=color:#cf222e>for</span><span style=color:#fff> </span>entry<span style=color:#fff> </span><span style=color:#cf222e>in</span><span style=color:#fff> </span>rich_header<span style=color:#1f2328>.</span>entries<span style=color:#1f2328>()</span><span style=color:#fff> </span><span style=color:#1f2328>{</span><span style=color:#fff>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span><span style=color:#fff>        </span><span style=color:#6639ba>println!</span><span style=color:#1f2328>(</span><span style=color:#0a3069>&#34;id: 0x</span><span style=color:#0a3069>{:04x}</span><span style=color:#0a3069> build_id: 0x</span><span style=color:#0a3069>{:04x}</span><span style=color:#0a3069> count: #</span><span style=color:#0a3069>{}</span><span style=color:#0a3069>&#34;</span><span style=color:#1f2328>,</span><span style=color:#fff>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span><span style=color:#fff>                 </span>entry<span style=color:#1f2328>.</span>id<span style=color:#1f2328>(),</span><span style=color:#fff> </span>entry<span style=color:#1f2328>.</span>build_id<span style=color:#1f2328>(),</span><span style=color:#fff> </span>entry<span style=color:#1f2328>.</span>count<span style=color:#1f2328>());</span><span style=color:#fff>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span><span><span style=color:#fff>    </span><span style=color:#1f2328>}</span><span style=color:#fff>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span><span><span style=color:#fff>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span><span><span style=color:#fff>    </span><span style=color:#cf222e>return</span><span style=color:#fff> </span>ExitCode::<span style=color:#0550ae>SUCCESS</span><span style=color:#1f2328>;</span><span style=color:#fff>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19</span><span><span style=color:#fff></span><span style=color:#1f2328>}</span><span style=color:#fff>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20</span><span><span style=color:#fff></span><span style=color:#6639ba>println!</span><span style=color:#1f2328>(</span><span style=color:#0a3069>&#34;Can&#39;t process </span><span style=color:#0a3069>{}</span><span style=color:#0a3069>&#34;</span><span style=color:#1f2328>,</span><span style=color:#fff> </span>path<span style=color:#1f2328>);</span><span style=color:#fff>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21</span><span><span style=color:#fff></span>ExitCode::<span style=color:#0550ae>FAILURE</span><span style=color:#fff>
</span></span></span></code></pre></div><hr><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span><span style=color:#57606a>// Dumping which section of an iOS app is encrypted
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span><span style=color:#57606a></span><span style=color:#fff>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span><span style=color:#fff></span><span style=color:#cf222e>let</span><span style=color:#fff> </span>path<span style=color:#fff> </span><span style=color:#0550ae>=</span><span style=color:#fff> </span>std::env::args<span style=color:#1f2328>().</span>last<span style=color:#1f2328>().</span>unwrap<span style=color:#1f2328>();</span><span style=color:#fff>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span><span style=color:#fff></span><span style=color:#cf222e>let</span><span style=color:#fff> </span><span style=color:#cf222e>mut</span><span style=color:#fff> </span>file<span style=color:#fff> </span><span style=color:#0550ae>=</span><span style=color:#fff> </span>std::fs::File::open<span style=color:#1f2328>(</span><span style=color:#0550ae>&amp;</span>path<span style=color:#1f2328>).</span>expect<span style=color:#1f2328>(</span><span style=color:#0a3069>&#34;Can&#39;t open the file&#34;</span><span style=color:#1f2328>);</span><span style=color:#fff>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span><span style=color:#fff>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span><span style=color:#fff></span><span style=color:#cf222e>if</span><span style=color:#fff> </span><span style=color:#cf222e>let</span><span style=color:#fff> </span><span style=color:#6639ba>Some</span><span style=color:#1f2328>(</span>lief::Binary::MachO<span style=color:#1f2328>(</span>fat<span style=color:#1f2328>))</span><span style=color:#fff> </span><span style=color:#0550ae>=</span><span style=color:#fff> </span>lief::Binary::from<span style=color:#1f2328>(</span><span style=color:#0550ae>&amp;</span><span style=color:#cf222e>mut</span><span style=color:#fff> </span>file<span style=color:#1f2328>)</span><span style=color:#fff> </span><span style=color:#1f2328>{</span><span style=color:#fff>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span><span style=color:#fff>    </span><span style=color:#cf222e>for</span><span style=color:#fff> </span>macho<span style=color:#fff> </span><span style=color:#cf222e>in</span><span style=color:#fff> </span>fat<span style=color:#1f2328>.</span>iter<span style=color:#1f2328>()</span><span style=color:#fff> </span><span style=color:#1f2328>{</span><span style=color:#fff>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span><span style=color:#fff>        </span><span style=color:#cf222e>for</span><span style=color:#fff> </span>cmd<span style=color:#fff> </span><span style=color:#cf222e>in</span><span style=color:#fff> </span>macho<span style=color:#1f2328>.</span>commands<span style=color:#1f2328>()</span><span style=color:#fff> </span><span style=color:#1f2328>{</span><span style=color:#fff>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span><span style=color:#fff>            </span><span style=color:#cf222e>if</span><span style=color:#fff> </span><span style=color:#cf222e>let</span><span style=color:#fff> </span>lief::macho::Commands::EncryptionInfo<span style=color:#1f2328>(</span>info<span style=color:#1f2328>)</span><span style=color:#fff> </span><span style=color:#0550ae>=</span><span style=color:#fff> </span>cmd<span style=color:#fff> </span><span style=color:#1f2328>{</span><span style=color:#fff>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span><span style=color:#fff>                </span><span style=color:#6639ba>println!</span><span style=color:#1f2328>(</span><span style=color:#0a3069>&#34;Encrypted area: 0x</span><span style=color:#0a3069>{:08x}</span><span style=color:#0a3069> - 0x</span><span style=color:#0a3069>{:08x}</span><span style=color:#0a3069> (id: </span><span style=color:#0a3069>{}</span><span style=color:#0a3069>)&#34;</span><span style=color:#1f2328>,</span><span style=color:#fff>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span><span style=color:#fff>                    </span>info<span style=color:#1f2328>.</span>crypt_offset<span style=color:#1f2328>(),</span><span style=color:#fff> </span>info<span style=color:#1f2328>.</span>crypt_offset<span style=color:#1f2328>()</span><span style=color:#fff> </span><span style=color:#0550ae>+</span><span style=color:#fff> </span>info<span style=color:#1f2328>.</span>crypt_size<span style=color:#1f2328>(),</span><span style=color:#fff>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span><span style=color:#fff>                    </span>info<span style=color:#1f2328>.</span>crypt_id<span style=color:#1f2328>()</span><span style=color:#fff>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span><span style=color:#fff>                </span><span style=color:#1f2328>)</span><span style=color:#fff>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span><span style=color:#fff>            </span><span style=color:#1f2328>}</span><span style=color:#fff>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span><span style=color:#fff>        </span><span style=color:#1f2328>}</span><span style=color:#fff>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span><span><span style=color:#fff>    </span><span style=color:#1f2328>}</span><span style=color:#fff>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span><span><span style=color:#fff>    </span><span style=color:#cf222e>return</span><span style=color:#fff> </span>ExitCode::<span style=color:#0550ae>SUCCESS</span><span style=color:#1f2328>;</span><span style=color:#fff>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span><span><span style=color:#fff></span><span style=color:#1f2328>}</span><span style=color:#fff>
</span></span></span></code></pre></div></div><div class="d-flex flex-column flex-sm-row align-items-center border-top border-gray-200 mt-6 py-5"><div class=media><div class="avatar mr-4"><img src=https://lief.re/img/avatar/romain.png class="avatar-image rounded-circle" alt=Avatar></div><div class=media-body><span class="text-darkblue text-uppercase-xs font-weight-bolder"><a href=https://www.romainthomas.fr target=_blank>Romain Thomas
</a></span><span class="text-muted font-size-sm d-block">Posted on June 16, 2024</span></div></div></div></div></div></div></section><footer class="footer footer-dark bg-dark"><div class="container text-center"><div class=row><div class="col-12 col-md"><h6 class="footer-header mb-4 pb-md-2">LIEF</h6><a href=https://github.com/lief-project/LIEF class=footer-link>Github
</a><a href=https://lief.re//download class="footer-link mt-2">Download
</a><a href=https://lief.re//doc/latest class="footer-link mt-2">Documentation</a></div><div class="col-12 col-md mt-5 mt-md-0"><h6 class="footer-header mb-4 pb-md-2">Quarkslab</h6><a href=https://blog.quarkslab.com/ class=footer-link>Blog
</a><a href=https://quarkslab.com/ class="footer-link mt-2">Website</a></div><div class="col-12 col-md mt-5 mt-md-0"><h6 class="footer-header mb-4 pb-md-2">Other Tools</h6><a href=https://qbdi.quarkslab.com/ class=footer-link>QBDI
</a><a href=https://triton.quarkslab.com/ class="footer-link mt-2">Triton</a></div></div><div class="d-flex justify-content-center mt-6"><a href=https://infosec.exchange/@rh0main class="hover-lift-light text-decoration-none mx-2"><span class="icon-circle footer-social-icon"><i class="fab fa-mastodon fa-lg"></i>
</span></a><a href=https://x.com/lief_project class="hover-lift-light text-decoration-none mx-2"><span class="icon-circle footer-social-icon"><i class="fab fa-x-twitter fa-lg"></i>
</span></a><a href=https://crates.io/crates/lief class="hover-lift-light text-decoration-none mx-2"><span class="icon-circle footer-social-icon"><i class="fab fa-rust fa-lg"></i>
</span></a><a href=https://pypi.org/project/lief/ class="hover-lift-light text-decoration-none mx-2"><span class="icon-circle footer-social-icon"><i class="fab fa-python fa-lg"></i>
</span></a><a href=https://github.com/lief-project/LIEF class="hover-lift-light text-decoration-none mx-2"><span class="icon-circle footer-social-icon"><i class="fab fa-github fa-lg"></i>
</span></a><a href=https://discord.gg/jGQtyAYChJ class="hover-lift-light text-decoration-none mx-2"><span class="icon-circle footer-social-icon"><i class="fab fa-discord fa-lg"></i></span></a></div></div></footer><script src=https://lief.re//js/vendor.min.js></script><script src=https://lief.re//js/theme.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js></script><script>$("#copy").tooltip({trigger:"click",placement:"bottom"});function setTooltip(e){$("#copy").tooltip("hide").attr("data-original-title",e).tooltip("show")}function hideTooltip(){setTimeout(function(){$("#copy").tooltip("hide")},1e3)}var clipboard=new ClipboardJS("#copy");clipboard.on("success",function(){setTooltip("Copied!"),hideTooltip()}),clipboard.on("error",function(){setTooltip("Failed!"),hideTooltip()})</script></body></html>