<!doctype html><html lang=en-us prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb#"><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=description content><meta name=HandheldFriendly content="True"><meta name=MobileOptimized content="320"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=google-site-verification content="OcWjYs0PdsQZtqu1ms5QSr5FplDf_t5GEneU---wWzM"><meta name=description content="Blog post about the open-sourcing of LIEF"><meta name=keywords content><meta property="og:type" content="article"><meta property="og:description" content="Blog post about the open-sourcing of LIEF"><meta property="og:title" content="LIEF - Library to Instrument Executable Formats"><meta property="og:site_name" content="LIEF"><meta property="og:image" content="https://lief.re/blog/2017-04-18-lief/featured.png"><meta property="og:image:type" content="image/png"><meta property="og:image:width" content><meta property="og:image:height" content><meta property="og:url" content="https://lief.re/blog/2017-04-18-lief/"><meta property="og:locale" content="en-us"><meta property="article:published_time" content="2017-04-18
"><meta property="article:modified_time" content="2017-04-18
"><meta name=twitter:card content="summary"><meta name=twitter:site content="@lief_project"><meta name=twitter:creator content="@lief_project"><meta name=twitter:title content="LIEF - Library to Instrument Executable Formats | LIEF"><meta name=twitter:description content="Blog post about the open-sourcing of LIEF | LIEF"><meta property="twitter:image:src" content="https://lief.re/blog/2017-04-18-lief/featured.png"><meta name=twitter:domain content="https://lief.re/blog/2017-04-18-lief/"><title>LIEF</title><link rel=canonical href=https://lief.re/blog/2017-04-18-lief/><link rel=stylesheet type=text/css href=https://lief.re//css/theme.min.css><link rel=stylesheet type=text/css href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.0/css/all.min.css><link rel=stylesheet type=text/css href=https://lief.re//css/vendor.min.css><link rel=stylesheet type=text/css href=https://lief.re//css/termynal.css><link rel=stylesheet type=text/css href=https://lief.re//css/animate.css><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:ital,wght@0,100..800;1,100..800&display=swap" rel=stylesheet type=text/css><link rel=apple-touch-icon href=https://lief.re//img/favicon.ico type=image/x-icon><link rel="shortcut icon" href=https://lief.re//img/favicon.ico type=image/x-icon><link rel=icon href=https://lief.re//img/favicon.ico type=image/x-icon><style></style></head><body class=bg-light><nav class="navbar navbar-expand-lg navbar-light bg-light position-absolute w-100 bg-white" role=navigation><div class="container position-relative"><a href=https://lief.re/ class=navbar-brand>LIEF</a>
<button class=navbar-toggler data-toggle=collapse data-target=#navbar-collapse>
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse justify-content-end mt-2 mt-lg-0" id=navbar-collapse><ul class=navbar-nav><li class=nav-item><a class=nav-link href=https://lief.re/><i class="fa-solid fa-house mr-3"></i>
Home</a></li><li class=nav-item><a class=nav-link href=https://lief.re/blog><i class="fa-solid fa-rss mr-3"></i>
Blog</a></li><li class=nav-item><a class=nav-link href=https://lief.re/download><i class="fa-solid fa-download mr-3"></i>
Download</a></li><li class="nav-item dropdown"><a href=https://lief.re/doc/latest class="nav-link dropdown-toggle" data-toggle=dropdown><i class="fa-solid fa-book mr-3"></i>
Documentation</a><div class="dropdown-menu px-4" role=menu><a class="dropdown-item d-flex align-items-center border-bottom border-gray-100 p-2" href=https://lief.re/doc/latest/><span class="svg-icon text-purple mr-3"><svg width="512" height="512" viewBox="0 0 512 512"><title>ionicons-v5-m</title><path d="M160 389a20.91 20.91.0 01-13.82-5.2l-128-112a21 21 0 010-31.6l128-112a21 21 0 0127.66 31.61L63.89 256l109.94 96.19A21 21 0 01160 389z"/><path d="M352 389a21 21 0 01-13.84-36.81L448.11 256 338.17 159.81a21 21 0 0127.66-31.61l128 112a21 21 0 010 31.6l-128 112A20.89 20.89.0 01352 389z"/></svg>
</span><span><p class=mb-0>API
<span class="badge badge-pastel-success font-weight-bold pt-2 ml-1">Latest</span></p><span class=text-secondary>Sphinx & Doxygen API documentation</span>
</span></a><a class="dropdown-item d-flex align-items-center border-bottom border-gray-100 p-2" href=https://lief.re/doc/stable/><span class="svg-icon text-purple mr-3"><svg width="512" height="512" viewBox="0 0 512 512"><title>ionicons-v5-m</title><path d="M160 389a20.91 20.91.0 01-13.82-5.2l-128-112a21 21 0 010-31.6l128-112a21 21 0 0127.66 31.61L63.89 256l109.94 96.19A21 21 0 01160 389z"/><path d="M352 389a21 21 0 01-13.84-36.81L448.11 256 338.17 159.81a21 21 0 0127.66-31.61l128 112a21 21 0 010 31.6l-128 112A20.89 20.89.0 01352 389z"/></svg>
</span><span><p class=mb-0>API
<span class="badge badge-pastel-primary font-weight-bold pt-2 ml-1">Stable</span></p><span class=text-secondary>Sphinx & Doxygen API documentation</span>
</span></a><a class="dropdown-item d-flex align-items-center border-bottom border-gray-100 p-2" href=https://lief.re/doc/latest/changelog.html><span class="svg-icon text-purple mr-3"><svg width="512" height="512" viewBox="0 0 512 512"><title>ionicons-v5-j</title><path d="M256 256s-48-96-126-96c-54.12.0-98 43-98 96s43.88 96 98 96c30 0 56.45-13.18 78-32" style="fill:none;stroke:#000;stroke-linecap:round;stroke-miterlimit:10;stroke-width:48px"/><path d="M256 256s48 96 126 96c54.12.0 98-43 98-96s-43.88-96-98-96c-29.37.0-56.66 13.75-78 32" style="fill:none;stroke:#000;stroke-linecap:round;stroke-miterlimit:10;stroke-width:48px"/></svg>
</span><span><p class=mb-0>Changelog</p><span class=text-secondary>See all updates</span></span></a></div></li><li class=nav-item><a class=nav-link href=https://lief.re/about><i class="fa-solid fa-bars-staggered mr-3"></i>
About</a></li><li class="nav-item ml-lg-3 mt-3 mt-lg-0"><a class="hover-lift-light mt-1" href=https://github.com/lief-project/LIEF target=_blank><i class="fab fa-2x fa-github text-darkblue"></i></a></li><li class="nav-item ml-lg-3 mt-3 mt-lg-0"><a class="hover-lift-light mt-1" href=https://discord.gg/jGQtyAYChJ target=_blank><i class="fab fa-2x fa-discord text-darkblue mr-3"></i></a></li><li class="nav-item ml-lg-3 mt-3 mt-lg-0"><a href=https://github.com/sponsors/lief-project/ class="btn btn-outline-pink" target=_blank><i class="fa-solid fa-heart mr-3"></i> Sponsor</a></li></ul></div></div></nav><div class="h-200 h-md-250 bg-light"></div><section class="bg-light pb-8"><div class="container fx-fade-up"><div class="row justify-content-center"><div class="col-lg-12 bg-white shadow-light-lg rounded py-5 px-4 px-md-7 mt-n6"><div class="avatar d-block mx-auto mt-n6 relative-top--7"><a href=https://www.romainthomas.fr target=_blank><img src=https://lief.re/img/avatar/romain.png class="rounded-circle avatar-image shadow" alt=Avatar></a></div><h2 class="text-center font-weight-normal mt-4">LIEF - Library to Instrument Executable Formats</h2><div class="text-center text-muted font-size-sm mt-3"><span class=mr-3><span class="svg-icon svg-icon-sm text-muted relative-top--1 mr-1"><svg width="512" height="512" viewBox="0 0 512 512"><title>ionicons-v5-k</title><polygon points="364.13 125.25 87 403 64 448 108.99 425 386.75 147.87 364.13 125.25" style="fill:none;stroke:#000;stroke-linecap:round;stroke-linejoin:round;stroke-width:32px"/><path d="M420.69 68.69 398.07 91.31l22.62 22.63 22.62-22.63a16 16 0 000-22.62h0a16 16 0 00-22.62.0z" style="fill:none;stroke:#000;stroke-linecap:round;stroke-linejoin:round;stroke-width:32px"/></svg>
</span><a href=https://www.romainthomas.fr target=_blank>Romain Thomas </a></span><span class=ml-3><i class="far fa-calendar fa-xs mr-1 relative-top--1"></i>
April 18, 2017</span></div><img src=https://lief.re//img/waves.png class="d-block mx-auto mt-4 mb-5" alt=Wave><div class=text-dark><div class="admonition abstract"><p class=admonition-title>Tl;DR</p>LIEF is a library to parse and manipulate ELF, PE and Mach-O formats.
Source code is available on <a href=https://github.com/lief-project/LIEF>GitHub</a> and use cases
are <a href=http://lief.quarkslab.com/doc/latest/tutorials/index.html>here</a>.</div><h3 id=executable-file-formats-in-a-nutshell>Executable File Formats in a Nutshell</h3><p>When dealing with executable files, the first layer of information is the format in which the code is wrapped. We can see an executable file format
as an envelope. It contains information so that the postman (i.e. Operating System) can handle and deliver (i.e. execute) it.
The message wrapped by this envelope would be the machine code.</p><p>There are mainly three mainstream formats, one per OS:</p><ul><li><strong>P</strong>ortable <strong>E</strong>xecutable (<strong>PE</strong>) for Windows systems</li><li><strong>E</strong>xecutable and <strong>L</strong>inkable <strong>F</strong>ormat (<strong>ELF</strong>) for UN*X systems (Linux, Android&mldr;).</li><li>Mach-O for OS-X, iOS&mldr;</li></ul><p>Other executable file formats, such as <code>COFF</code>, exist but they are less relevant.</p><p>Usually each format has a header which describes at least the target architecture, the program&rsquo;s entry point and the type of the wrapped object (executable, library&mldr;)
Then we have blocks of data that will be mapped by the OS&rsquo;s loader. These blocks of data could hold machine code (<code>.text</code>), read-only data (<code>.rodata</code>) or other OS specific information.</p><p>For PE there is only one kind of such block: <strong>Section</strong>. For ELF and Mach-O formats, a section has a different meaning. In these formats,
sections are used by the <strong>linker</strong> at the <strong>compilation</strong> step, whereas <strong>segments</strong> (second type of block) are used by the OS&rsquo;s loader at <strong>execution</strong> step. Thus
sections are not mandatory for ELF and Mach-O formats and can be removed without affecting the execution.</p><h4 id=purpose-of-lief>Purpose of LIEF</h4><p>It turns out that many projects need to parse executable file formats but don&rsquo;t use a <em>standard</em> library and re-implement their own parser (and the wheel).
Moreover, these parsers are usually bound to one language.</p><p>On Unix system one can find the <code>objdump</code> and <code>objcopy</code> utilities but they are limited to Unix and the API is not user-friendly.</p><p>The purpose of LIEF is to fill this void:</p><ul><li>Providing a cross platform library which can parse and modify (in a certain extent) ELF, PE and Mach-O formats using a common abstraction</li><li>Providing an API for different languages (Python, C++, C&mldr;)</li><li>Abstract common features from the different formats (Section, header, entry point, symbols&mldr;)</li></ul><p>The following snippets show how to obtain information about an executable using different API of LIEF:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span><span style=color:#cf222e>import</span> <span style=color:#24292e>lief</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span><span style=color:#57606a># ELF</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span>binary <span style=color:#0550ae>=</span> lief<span style=color:#0550ae>.</span>parse<span style=color:#1f2328>(</span><span style=color:#0a3069>&#34;/usr/bin/ls&#34;</span><span style=color:#1f2328>)</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span><span style=color:#6639ba>print</span><span style=color:#1f2328>(</span>binary<span style=color:#1f2328>)</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span><span style=color:#57606a># PE</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span>binary <span style=color:#0550ae>=</span> lief<span style=color:#0550ae>.</span>parse<span style=color:#1f2328>(</span><span style=color:#0a3069>&#34;C:</span><span style=color:#0a3069>\\</span><span style=color:#0a3069>Windows</span><span style=color:#0a3069>\\</span><span style=color:#0a3069>explorer.exe&#34;</span><span style=color:#1f2328>)</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span><span style=color:#6639ba>print</span><span style=color:#1f2328>(</span>binary<span style=color:#1f2328>)</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span><span style=color:#57606a># Mach-O</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span>binary <span style=color:#0550ae>=</span> lief<span style=color:#0550ae>.</span>parse<span style=color:#1f2328>(</span><span style=color:#0a3069>&#34;/usr/bin/ls&#34;</span><span style=color:#1f2328>)</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span><span style=color:#6639ba>print</span><span style=color:#1f2328>(</span>binary<span style=color:#1f2328>)</span>
</span></span></code></pre></div><p>With the <code>C++</code> API:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span><span style=color:#57606a>#include</span> <span style=color:#57606a>&lt;LIEF/LIEF.hpp&gt;</span><span style=color:#57606a>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span><span style=color:#57606a></span><span style=color:#cf222e>int</span> <span style=color:#6639ba>main</span><span style=color:#1f2328>(</span><span style=color:#cf222e>int</span> argc<span style=color:#1f2328>,</span> <span style=color:#cf222e>const</span> <span style=color:#cf222e>char</span><span style=color:#0550ae>**</span> argv<span style=color:#1f2328>)</span> <span style=color:#1f2328>{</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span>  LIEF<span style=color:#0550ae>::</span>ELF<span style=color:#0550ae>::</span>Binary<span style=color:#0550ae>*</span>   elf   <span style=color:#0550ae>=</span> LIEF<span style=color:#0550ae>::</span>ELF<span style=color:#0550ae>::</span>Parser<span style=color:#0550ae>::</span>parse<span style=color:#1f2328>(</span><span style=color:#0a3069>&#34;/usr/bin/ls&#34;</span><span style=color:#1f2328>);</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span>  LIEF<span style=color:#0550ae>::</span>PE<span style=color:#0550ae>::</span>Binary<span style=color:#0550ae>*</span>    pe    <span style=color:#0550ae>=</span> LIEF<span style=color:#0550ae>::</span>PE<span style=color:#0550ae>::</span>Parser<span style=color:#0550ae>::</span>parse<span style=color:#1f2328>(</span><span style=color:#0a3069>&#34;C:</span><span style=color:#0a3069>\\</span><span style=color:#0a3069>Windows</span><span style=color:#0a3069>\\</span><span style=color:#0a3069>explorer.exe&#34;</span><span style=color:#1f2328>);</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span>  LIEF<span style=color:#0550ae>::</span>MachO<span style=color:#0550ae>::</span>Binary<span style=color:#0550ae>*</span> macho <span style=color:#0550ae>=</span> LIEF<span style=color:#0550ae>::</span>MachO<span style=color:#0550ae>::</span>Parser<span style=color:#0550ae>::</span>parse<span style=color:#1f2328>(</span><span style=color:#0a3069>&#34;/usr/bin/ls&#34;</span><span style=color:#1f2328>);</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span>  std<span style=color:#0550ae>::</span>cout <span style=color:#0550ae>&lt;&lt;</span> <span style=color:#0550ae>*</span>elf   <span style=color:#0550ae>&lt;&lt;</span> std<span style=color:#0550ae>::</span>endl<span style=color:#1f2328>;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span>  std<span style=color:#0550ae>::</span>cout <span style=color:#0550ae>&lt;&lt;</span> <span style=color:#0550ae>*</span>pe    <span style=color:#0550ae>&lt;&lt;</span> std<span style=color:#0550ae>::</span>endl<span style=color:#1f2328>;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span>  std<span style=color:#0550ae>::</span>cout <span style=color:#0550ae>&lt;&lt;</span> <span style=color:#0550ae>*</span>macho <span style=color:#0550ae>&lt;&lt;</span> std<span style=color:#0550ae>::</span>endl<span style=color:#1f2328>;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span>  <span style=color:#cf222e>delete</span> elf<span style=color:#1f2328>;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span>  <span style=color:#cf222e>delete</span> pe<span style=color:#1f2328>;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span>  <span style=color:#cf222e>delete</span> macho<span style=color:#1f2328>;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span><span style=color:#1f2328>}</span>
</span></span></code></pre></div><p>And finally with the <code>C</code> API:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span><span style=color:#57606a>#include</span> <span style=color:#57606a>&lt;LIEF/LIEF.h&gt;</span><span style=color:#57606a>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span><span style=color:#57606a></span><span style=color:#cf222e>int</span> <span style=color:#6639ba>main</span><span style=color:#1f2328>(</span><span style=color:#cf222e>int</span> argc<span style=color:#1f2328>,</span> <span style=color:#cf222e>const</span> <span style=color:#cf222e>char</span><span style=color:#0550ae>**</span> argv<span style=color:#1f2328>)</span> <span style=color:#1f2328>{</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span>  Elf_Binary_t<span style=color:#0550ae>*</span>    elf_binary     <span style=color:#0550ae>=</span> <span style=color:#6639ba>elf_parse</span><span style=color:#1f2328>(</span><span style=color:#0a3069>&#34;/usr/bin/ls&#34;</span><span style=color:#1f2328>);</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span>  Pe_Binary_t<span style=color:#0550ae>*</span>     pe_binary      <span style=color:#0550ae>=</span> <span style=color:#6639ba>pe_parse</span><span style=color:#1f2328>(</span><span style=color:#0a3069>&#34;C:</span><span style=color:#0a3069>\\</span><span style=color:#0a3069>Windows</span><span style=color:#0a3069>\\</span><span style=color:#0a3069>explorer.exe&#34;</span><span style=color:#1f2328>);</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span>  Macho_Binary_t<span style=color:#0550ae>**</span> macho_binaries <span style=color:#0550ae>=</span> <span style=color:#6639ba>macho_parse</span><span style=color:#1f2328>(</span><span style=color:#0a3069>&#34;/usr/bin/ls&#34;</span><span style=color:#1f2328>);</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span>  Pe_Section_t<span style=color:#0550ae>**</span>    pe_sections    <span style=color:#0550ae>=</span> pe_binary<span style=color:#0550ae>-&gt;</span>sections<span style=color:#1f2328>;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span>  Elf_Section_t<span style=color:#0550ae>**</span>   elf_sections   <span style=color:#0550ae>=</span> elf_binary<span style=color:#0550ae>-&gt;</span>sections<span style=color:#1f2328>;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span>  Macho_Section_t<span style=color:#0550ae>**</span> macho_sections <span style=color:#0550ae>=</span> macho_binaries<span style=color:#1f2328>[</span><span style=color:#0550ae>0</span><span style=color:#1f2328>]</span><span style=color:#0550ae>-&gt;</span>sections<span style=color:#1f2328>;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span>  <span style=color:#cf222e>for</span> <span style=color:#1f2328>(</span><span style=color:#cf222e>size_t</span> i <span style=color:#0550ae>=</span> <span style=color:#0550ae>0</span><span style=color:#1f2328>;</span> pe_sections<span style=color:#1f2328>[</span>i<span style=color:#1f2328>]</span> <span style=color:#0550ae>!=</span> <span style=color:#6639ba>NULL</span><span style=color:#1f2328>;</span> <span style=color:#0550ae>++</span>i<span style=color:#1f2328>)</span> <span style=color:#1f2328>{</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span>    <span style=color:#6639ba>printf</span><span style=color:#1f2328>(</span><span style=color:#0a3069>&#34;%s</span><span style=color:#0a3069>\n</span><span style=color:#0a3069>&#34;</span><span style=color:#1f2328>,</span> pe_sections<span style=color:#1f2328>[</span>i<span style=color:#1f2328>]</span><span style=color:#0550ae>-&gt;</span>name<span style=color:#1f2328>)</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span>  <span style=color:#1f2328>}</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span><span>  <span style=color:#cf222e>for</span> <span style=color:#1f2328>(</span><span style=color:#cf222e>size_t</span> i <span style=color:#0550ae>=</span> <span style=color:#0550ae>0</span><span style=color:#1f2328>;</span> elf_sections<span style=color:#1f2328>[</span>i<span style=color:#1f2328>]</span> <span style=color:#0550ae>!=</span> <span style=color:#6639ba>NULL</span><span style=color:#1f2328>;</span> <span style=color:#0550ae>++</span>i<span style=color:#1f2328>)</span> <span style=color:#1f2328>{</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span><span>    <span style=color:#6639ba>printf</span><span style=color:#1f2328>(</span><span style=color:#0a3069>&#34;%s</span><span style=color:#0a3069>\n</span><span style=color:#0a3069>&#34;</span><span style=color:#1f2328>,</span> elf_sections<span style=color:#1f2328>[</span>i<span style=color:#1f2328>]</span><span style=color:#0550ae>-&gt;</span>name<span style=color:#1f2328>)</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span><span>  <span style=color:#1f2328>}</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20</span><span>  <span style=color:#cf222e>for</span> <span style=color:#1f2328>(</span><span style=color:#cf222e>size_t</span> i <span style=color:#0550ae>=</span> <span style=color:#0550ae>0</span><span style=color:#1f2328>;</span> macho_sections<span style=color:#1f2328>[</span>i<span style=color:#1f2328>]</span> <span style=color:#0550ae>!=</span> <span style=color:#6639ba>NULL</span><span style=color:#1f2328>;</span> <span style=color:#0550ae>++</span>i<span style=color:#1f2328>)</span> <span style=color:#1f2328>{</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21</span><span>    <span style=color:#6639ba>printf</span><span style=color:#1f2328>(</span><span style=color:#0a3069>&#34;%s</span><span style=color:#0a3069>\n</span><span style=color:#0a3069>&#34;</span><span style=color:#1f2328>,</span> macho_sections<span style=color:#1f2328>[</span>i<span style=color:#1f2328>]</span><span style=color:#0550ae>-&gt;</span>name<span style=color:#1f2328>)</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22</span><span>  <span style=color:#1f2328>}</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">24</span><span>  <span style=color:#6639ba>elf_binary_destroy</span><span style=color:#1f2328>(</span>elf_binary<span style=color:#1f2328>);</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">25</span><span>  <span style=color:#6639ba>pe_binary_destroy</span><span style=color:#1f2328>(</span>pe_binary<span style=color:#1f2328>);</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">26</span><span>  <span style=color:#6639ba>macho_binaries_destroy</span><span style=color:#1f2328>(</span>macho_binaries<span style=color:#1f2328>);</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">27</span><span><span style=color:#1f2328>}</span>
</span></span></code></pre></div><p>LIEF supports FAT-MachO and one can iterate over binaries as follows:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span><span style=color:#cf222e>import</span> <span style=color:#24292e>lief</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span>binaries <span style=color:#0550ae>=</span> lief<span style=color:#0550ae>.</span>MachO<span style=color:#0550ae>.</span>parse<span style=color:#1f2328>(</span><span style=color:#0a3069>&#34;/usr/lib/libc++abi.dylib&#34;</span><span style=color:#1f2328>)</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span><span style=color:#cf222e>for</span> binary <span style=color:#0550ae>in</span> binaries<span style=color:#1f2328>:</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span><span>  <span style=color:#6639ba>print</span><span style=color:#1f2328>(</span>binary<span style=color:#1f2328>)</span>
</span></span></code></pre></div><div class="admonition note"><p class=admonition-title>Note</p>The above script uses the <code>lief.MachO.parse</code> function instead of the <code>lief.parse</code>
function because <code>lief.parse</code> returns a <b>single</b> <code>lief.MachO.binary</code> object
whereas <code>lief.MachO.parse</code> returns a <b>list</b> of <code>lief.MachO.binary</code> (according to the FAT-MachO format).</div><p>Along with standard format components like headers, sections, import table, load commands, symbols, etc. LIEF is also able to parse PE Authenticode:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span><span style=color:#cf222e>import</span> <span style=color:#24292e>lief</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span>driver <span style=color:#0550ae>=</span> lief<span style=color:#0550ae>.</span>parse<span style=color:#1f2328>(</span><span style=color:#0a3069>&#34;driver.sys&#34;</span><span style=color:#1f2328>)</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span><span><span style=color:#cf222e>for</span> crt <span style=color:#0550ae>in</span> driver<span style=color:#0550ae>.</span>signature<span style=color:#0550ae>.</span>certificates<span style=color:#1f2328>:</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5</span><span>  <span style=color:#6639ba>print</span><span style=color:#1f2328>(</span>crt<span style=color:#1f2328>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>Version:             <span style=color:#0550ae>3</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span>Serial Number:       61:07:02:dc:00:00:00:00:00:0b
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span>Signature Algorithm: SHA1_WITH_RSA_ENCRYPTION
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span><span>Valid from:          2005-9-15 21:55:41
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5</span><span>Valid to:            2016-3-15 22:5:41
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6</span><span>Issuer:              <span style=color:#953800>DC</span><span style=color:#0550ae>=</span>com, <span style=color:#953800>DC</span><span style=color:#0550ae>=</span>microsoft, <span style=color:#953800>CN</span><span style=color:#0550ae>=</span>Microsoft Root Certificate Authority
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">7</span><span>Subject:             <span style=color:#953800>C</span><span style=color:#0550ae>=</span>US, <span style=color:#953800>ST</span><span style=color:#0550ae>=</span>Washington, <span style=color:#953800>L</span><span style=color:#0550ae>=</span>Redmond, <span style=color:#953800>O</span><span style=color:#0550ae>=</span>Microsoft Corporation, <span style=color:#953800>CN</span><span style=color:#0550ae>=</span>Microsoft Windows Verification PCA
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">8</span><span>...
</span></span></code></pre></div><p>Full API documentation is available here</p><ul><li><a href=http://lief.quarkslab.com/doc/latest/api/python/index.html>Python API</a></li><li><a href=http://lief.quarkslab.com/doc/latest/api/cpp/index.html>C++ API</a></li><li><a href=http://lief.quarkslab.com/doc/latest/api/c/index.html>C API</a></li></ul><h3 id=architecture>Architecture</h3><p>In the <code>LIEF</code> architecture, each format implements at least the following classes:</p><ul><li><strong>Parser</strong>: Parse the format and decompose it into a <code>Binary</code> class</li><li><strong>Binary</strong>: Modelize the format and provide an API to modify and explore it.</li><li><strong>Builder</strong>: Transform the binary object into a valid file.</li></ul><center><img class=img-fluid src=archi.png alt=Architecture></center><p>To factor common characteristics in formats we have an inheritance relationship between these characteristics.</p><p>For symbols it gives the following diagram:</p><center><img class=img-fluid src=symbol_inheritance.png alt="LIEF Symbol Inheritance"></center><p>It enables to write cross-format utility like <code>nm</code>. <code>nm</code> is a Unix utility to list symbols in an executable.
The source code is available here: <a href=https://github.com/gittup/binutils/blob/0af702d47a443acea853b84157c2e81f6c131e77/binutils/nm.c>binutils</a></p><p>With the given inheritance relationship one can write this utility for the three formats in a single script:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span><span style=color:#cf222e>import</span> <span style=color:#24292e>lief</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span><span style=color:#cf222e>import</span> <span style=color:#24292e>sys</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span><span style=color:#cf222e>def</span> <span style=color:#6639ba>nm</span><span style=color:#1f2328>(</span>binary<span style=color:#1f2328>):</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span>  <span style=color:#cf222e>for</span> symbol <span style=color:#0550ae>in</span> binary<span style=color:#0550ae>.</span>symbols<span style=color:#1f2328>:</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span>    <span style=color:#6639ba>print</span><span style=color:#1f2328>(</span>symbol<span style=color:#1f2328>)</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span>  <span style=color:#cf222e>return</span> <span style=color:#0550ae>0</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span><span style=color:#cf222e>if</span> <span style=color:#953800>__name__</span> <span style=color:#0550ae>==</span> <span style=color:#0a3069>&#34;__main__&#34;</span><span style=color:#1f2328>:</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span>  r <span style=color:#0550ae>=</span> nm<span style=color:#1f2328>(</span>sys<span style=color:#0550ae>.</span>argv<span style=color:#1f2328>[</span><span style=color:#0550ae>1</span><span style=color:#1f2328>])</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span>  sys<span style=color:#0550ae>.</span>exit<span style=color:#1f2328>(</span>r<span style=color:#1f2328>)</span>
</span></span></code></pre></div><h3 id=conclusion>Conclusion</h3><p>As LIEF is still a young project we hope to have feedback, ideas, suggestions and pull requests.</p><p>The source code is available here: <a href=https://github.com/lief-project>https://github.com/lief-project</a> (under Apache 2.0 license) and the associated website: <a href=http://lief.quarkslab.com>http://lief.quarkslab.com</a></p><p>If you are interested in use cases, you can take a look at these tutorials:</p><ul><li><a href=http://lief.quarkslab.com/doc/latest/tutorials/01_play_with_formats.html>Parse and manipulate formats</a></li><li><a href=http://lief.quarkslab.com/doc/latest/tutorials/02_pe_from_scratch.html>Create a PE from scratch</a></li><li><a href=http://lief.quarkslab.com/doc/latest/tutorials/03_elf_change_symbols.html>Play with ELF symbols</a></li><li><a href=http://lief.quarkslab.com/doc/latest/tutorials/04_elf_hooking.html>Hooking</a></li><li><a href=http://lief.quarkslab.com/doc/latest/tutorials/05_elf_infect_plt_got.html>Infecting the PLT/GOT</a></li></ul><p>The project will be presented at the <a href=http://cyber.science-japon.org/>Third French Japanese Meeting on Cybersecurity</a></p><h4 id=contact>Contact</h4><ul><li>lief [at] quarkslab [dot] com</li><li>Gitter: <a href=https://gitter.im/lief-project>lief-project</a></li></ul><h4 id=thanks>Thanks</h4><p>Thanks to Serge Guelton and Adrien Guinet for their advice about the design and their code review. Thanks to Quarkslab for making this project open-source.</p></div><div class="d-flex flex-column flex-sm-row align-items-center border-top border-gray-200 mt-6 py-5"><div class=media><div class="avatar mr-4"><img src=https://lief.re/img/avatar/romain.png class="avatar-image rounded-circle" alt=Avatar></div><div class=media-body><span class="text-darkblue text-uppercase-xs font-weight-bolder"><a href=https://www.romainthomas.fr target=_blank>Romain Thomas
</a></span><span class="text-muted font-size-sm d-block">Posted on April 18, 2017</span></div></div></div></div></div></div></section><footer class="footer footer-dark bg-dark"><div class="container text-center"><div class=row><div class="col-12 col-md"><h6 class="footer-header mb-4 pb-md-2">LIEF</h6><a href=https://github.com/lief-project/LIEF class=footer-link>Github
</a><a href=https://lief.re//download class="footer-link mt-2">Download
</a><a href=https://lief.re//doc/latest class="footer-link mt-2">Documentation</a></div><div class="col-12 col-md mt-5 mt-md-0"><h6 class="footer-header mb-4 pb-md-2">Quarkslab</h6><a href=https://blog.quarkslab.com/ class=footer-link>Blog
</a><a href=https://quarkslab.com/ class="footer-link mt-2">Website</a></div><div class="col-12 col-md mt-5 mt-md-0"><h6 class="footer-header mb-4 pb-md-2">Other Tools</h6><a href=https://qbdi.quarkslab.com/ class=footer-link>QBDI
</a><a href=https://triton.quarkslab.com/ class="footer-link mt-2">Triton</a></div></div><div class="d-flex justify-content-center mt-6"><a href=https://infosec.exchange/@rh0main class="hover-lift-light text-decoration-none mx-2"><span class="icon-circle footer-social-icon"><i class="fab fa-mastodon fa-lg"></i>
</span></a><a href=https://x.com/lief_project class="hover-lift-light text-decoration-none mx-2"><span class="icon-circle footer-social-icon"><i class="fab fa-x-twitter fa-lg"></i>
</span></a><a href=https://crates.io/crates/lief class="hover-lift-light text-decoration-none mx-2"><span class="icon-circle footer-social-icon"><i class="fab fa-rust fa-lg"></i>
</span></a><a href=https://pypi.org/project/lief/ class="hover-lift-light text-decoration-none mx-2"><span class="icon-circle footer-social-icon"><i class="fab fa-python fa-lg"></i>
</span></a><a href=https://github.com/lief-project/LIEF class="hover-lift-light text-decoration-none mx-2"><span class="icon-circle footer-social-icon"><i class="fab fa-github fa-lg"></i>
</span></a><a href=https://discord.gg/jGQtyAYChJ class="hover-lift-light text-decoration-none mx-2"><span class="icon-circle footer-social-icon"><i class="fab fa-discord fa-lg"></i></span></a></div></div></footer><script src=https://lief.re//js/vendor.min.js></script><script src=https://lief.re//js/theme.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js></script><script>$("#copy").tooltip({trigger:"click",placement:"bottom"});function setTooltip(e){$("#copy").tooltip("hide").attr("data-original-title",e).tooltip("show")}function hideTooltip(){setTimeout(function(){$("#copy").tooltip("hide")},1e3)}var clipboard=new ClipboardJS("#copy");clipboard.on("success",function(){setTooltip("Copied!"),hideTooltip()}),clipboard.on("error",function(){setTooltip("Failed!"),hideTooltip()})</script></body></html>