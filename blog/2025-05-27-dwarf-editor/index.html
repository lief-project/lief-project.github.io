<!doctype html><html lang=en-us prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb#"><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=description content><meta name=HandheldFriendly content="True"><meta name=MobileOptimized content="320"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=google-site-verification content="OcWjYs0PdsQZtqu1ms5QSr5FplDf_t5GEneU---wWzM"><meta name=description content="This blog post introduces a new API in LIEF to create DWARF files"><meta name=keywords content><meta property="og:type" content="article"><meta property="og:description" content="This blog post introduces a new API in LIEF to create DWARF files"><meta property="og:title" content="DWARF as a Shared Reverse Engineering Format"><meta property="og:site_name" content="LIEF"><meta property="og:image" content="https://lief.re/blog/2025-05-27-dwarf-editor/featured.webp"><meta property="og:image:type" content="image/png"><meta property="og:image:width" content><meta property="og:image:height" content><meta property="og:url" content="https://lief.re/blog/2025-05-27-dwarf-editor/"><meta property="og:locale" content="en-us"><meta property="article:published_time" content="2025-05-27
"><meta property="article:modified_time" content="2025-05-27
"><meta name=twitter:card content="summary"><meta name=twitter:site content="@lief_project"><meta name=twitter:creator content="@lief_project"><meta name=twitter:title content="DWARF as a Shared Reverse Engineering Format | LIEF"><meta name=twitter:description content="This blog post introduces a new API in LIEF to create DWARF files | LIEF"><meta property="twitter:image:src" content="https://lief.re/blog/2025-05-27-dwarf-editor/featured.webp"><meta name=twitter:domain content="https://lief.re/blog/2025-05-27-dwarf-editor/"><title>LIEF</title><link rel=canonical href=https://lief.re/blog/2025-05-27-dwarf-editor/><link rel=stylesheet type=text/css href=https://lief.re//css/theme.min.css><link rel=stylesheet type=text/css href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.0/css/all.min.css><link rel=stylesheet type=text/css href=https://lief.re//css/vendor.min.css><link rel=stylesheet type=text/css href=https://lief.re//css/termynal.css><link rel=stylesheet type=text/css href=https://lief.re//css/animate.css><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:ital,wght@0,100..800;1,100..800&display=swap" rel=stylesheet type=text/css><link rel=apple-touch-icon href=https://lief.re//img/favicon.ico type=image/x-icon><link rel="shortcut icon" href=https://lief.re//img/favicon.ico type=image/x-icon><link rel=icon href=https://lief.re//img/favicon.ico type=image/x-icon><style></style></head><body class=bg-light><nav class="navbar navbar-expand-lg navbar-light bg-light position-absolute w-100 bg-white" role=navigation><div class="container position-relative"><a href=https://lief.re/ class=navbar-brand>LIEF</a>
<button class=navbar-toggler data-toggle=collapse data-target=#navbar-collapse>
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse justify-content-end mt-2 mt-lg-0" id=navbar-collapse><ul class=navbar-nav><li class=nav-item><a class=nav-link href=https://lief.re/><i class="fa-solid fa-house mr-3"></i>
Home</a></li><li class=nav-item><a class=nav-link href=https://lief.re/blog><i class="fa-solid fa-rss mr-3"></i>
Blog</a></li><li class=nav-item><a class=nav-link href=https://lief.re/download><i class="fa-solid fa-download mr-3"></i>
Download</a></li><li class="nav-item dropdown"><a href=https://lief.re/doc/latest class="nav-link dropdown-toggle" data-toggle=dropdown><i class="fa-solid fa-book mr-3"></i>
Documentation</a><div class="dropdown-menu px-4" role=menu><a class="dropdown-item d-flex align-items-center border-bottom border-gray-100 p-2" href=https://lief.re/doc/latest/><span class="svg-icon text-purple mr-3"><svg width="512" height="512" viewBox="0 0 512 512"><title>ionicons-v5-m</title><path d="M160 389a20.91 20.91.0 01-13.82-5.2l-128-112a21 21 0 010-31.6l128-112a21 21 0 0127.66 31.61L63.89 256l109.94 96.19A21 21 0 01160 389z"/><path d="M352 389a21 21 0 01-13.84-36.81L448.11 256 338.17 159.81a21 21 0 0127.66-31.61l128 112a21 21 0 010 31.6l-128 112A20.89 20.89.0 01352 389z"/></svg>
</span><span><p class=mb-0>API
<span class="badge badge-pastel-success font-weight-bold pt-2 ml-1">Latest</span></p><span class=text-secondary>Sphinx & Doxygen API documentation</span>
</span></a><a class="dropdown-item d-flex align-items-center border-bottom border-gray-100 p-2" href=https://lief.re/doc/stable/><span class="svg-icon text-purple mr-3"><svg width="512" height="512" viewBox="0 0 512 512"><title>ionicons-v5-m</title><path d="M160 389a20.91 20.91.0 01-13.82-5.2l-128-112a21 21 0 010-31.6l128-112a21 21 0 0127.66 31.61L63.89 256l109.94 96.19A21 21 0 01160 389z"/><path d="M352 389a21 21 0 01-13.84-36.81L448.11 256 338.17 159.81a21 21 0 0127.66-31.61l128 112a21 21 0 010 31.6l-128 112A20.89 20.89.0 01352 389z"/></svg>
</span><span><p class=mb-0>API
<span class="badge badge-pastel-primary font-weight-bold pt-2 ml-1">Stable</span></p><span class=text-secondary>Sphinx & Doxygen API documentation</span>
</span></a><a class="dropdown-item d-flex align-items-center border-bottom border-gray-100 p-2" href=https://lief.re/doc/latest/changelog.html><span class="svg-icon text-purple mr-3"><svg width="512" height="512" viewBox="0 0 512 512"><title>ionicons-v5-j</title><path d="M256 256s-48-96-126-96c-54.12.0-98 43-98 96s43.88 96 98 96c30 0 56.45-13.18 78-32" style="fill:none;stroke:#000;stroke-linecap:round;stroke-miterlimit:10;stroke-width:48px"/><path d="M256 256s48 96 126 96c54.12.0 98-43 98-96s-43.88-96-98-96c-29.37.0-56.66 13.75-78 32" style="fill:none;stroke:#000;stroke-linecap:round;stroke-miterlimit:10;stroke-width:48px"/></svg>
</span><span><p class=mb-0>Changelog</p><span class=text-secondary>See all updates</span></span></a></div></li><li class=nav-item><a class=nav-link href=https://lief.re/about><i class="fa-solid fa-bars-staggered mr-3"></i>
About</a></li><li class="nav-item ml-lg-3 mt-3 mt-lg-0"><a class="hover-lift-light mt-1" href=https://github.com/lief-project/LIEF target=_blank><i class="fab fa-2x fa-github text-darkblue"></i></a></li><li class="nav-item ml-lg-3 mt-3 mt-lg-0"><a class="hover-lift-light mt-1" href=https://discord.gg/jGQtyAYChJ target=_blank><i class="fab fa-2x fa-discord text-darkblue mr-3"></i></a></li><li class="nav-item ml-lg-3 mt-3 mt-lg-0"><a href=https://github.com/sponsors/lief-project/ class="btn btn-outline-pink" target=_blank><i class="fa-solid fa-heart mr-3"></i> Sponsor</a></li></ul></div></div></nav><div class="h-200 h-md-250 bg-light"></div><section class="bg-light pb-8"><div class="container fx-fade-up"><div class="row justify-content-center"><div class="col-lg-12 bg-white shadow-light-lg rounded py-5 px-4 px-md-7 mt-n6"><div class="avatar d-block mx-auto mt-n6 relative-top--7"><a href=https://www.romainthomas.fr target=_blank><img src=https://lief.re/img/avatar/romain.png class="rounded-circle avatar-image shadow" alt=Avatar></a></div><h2 class="text-center font-weight-normal mt-4">DWARF as a Shared Reverse Engineering Format</h2><div class="text-center text-muted font-size-sm mt-3"><span class=mr-3><span class="svg-icon svg-icon-sm text-muted relative-top--1 mr-1"><svg width="512" height="512" viewBox="0 0 512 512"><title>ionicons-v5-k</title><polygon points="364.13 125.25 87 403 64 448 108.99 425 386.75 147.87 364.13 125.25" style="fill:none;stroke:#000;stroke-linecap:round;stroke-linejoin:round;stroke-width:32px"/><path d="M420.69 68.69 398.07 91.31l22.62 22.63 22.62-22.63a16 16 0 000-22.62h0a16 16 0 00-22.62.0z" style="fill:none;stroke:#000;stroke-linecap:round;stroke-linejoin:round;stroke-width:32px"/></svg>
</span><a href=https://www.romainthomas.fr target=_blank>Romain Thomas </a></span><span class=ml-3><i class="far fa-calendar fa-xs mr-1 relative-top--1"></i>
May 27, 2025</span></div><img src=https://lief.re//img/waves.png class="d-block mx-auto mt-4 mb-5" alt=Wave><div class=text-dark><p><img src=./featured.webp alt="Featuring Image"><br><br></p><h1 id=introduction>Introduction</h1><p>When reverse engineering binaries, we could want, at some point, to share the reverse-engineered
information with others. The DWARF format, originally designed to hold debug
information associated with the original source code, is also well-suited for
storing reverse-engineered informations such as structure, function names.</p><p>This blog post introduces a new API in <em>LIEF extended</em> to create DWARF files.
It also introduces two plugins for Ghidra and BinaryNinja to export binary analysis
into DWARF.</p><h2 id=creating-dwarf-with-lief-extended>Creating DWARF with LIEF (extended)</h2><p><a href=https://lief.re/doc/latest/extended/intro.html>LIEF extended</a> now provides a
comprehensive API to create DWARF files.</p><p>This API is available in Python, Rust, and C++ and it looks like this:</p><div class=highlight><pre tabindex=0 style=background-color:#f7f7f7;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-python data-lang=python><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span><span style=color:#cf222e>import</span> <span style=color:#24292e>lief</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span>elf <span style=color:#0550ae>=</span> lief<span style=color:#0550ae>.</span>ELF<span style=color:#0550ae>.</span>parse<span style=color:#1f2328>(</span><span style=color:#0a3069>&#34;./libd5A7BCF0524B8.so&#34;</span><span style=color:#1f2328>)</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span>editor<span style=color:#1f2328>:</span> lief<span style=color:#0550ae>.</span>dwarf<span style=color:#0550ae>.</span>Editor <span style=color:#0550ae>=</span> lief<span style=color:#0550ae>.</span>dwarf<span style=color:#0550ae>.</span>Editor<span style=color:#0550ae>.</span>from_binary<span style=color:#1f2328>(</span>elf<span style=color:#1f2328>)</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span>unit<span style=color:#1f2328>:</span> lief<span style=color:#0550ae>.</span>dwarf<span style=color:#0550ae>.</span>editor<span style=color:#0550ae>.</span>CompilationUnit <span style=color:#0550ae>=</span> editor<span style=color:#0550ae>.</span>create_compilation_unit<span style=color:#1f2328>()</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span>unit<span style=color:#0550ae>.</span>set_producer<span style=color:#1f2328>(</span><span style=color:#0a3069>&#34;Generated by LIEF (LLVM backend)&#34;</span><span style=color:#1f2328>)</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span>func<span style=color:#1f2328>:</span> lief<span style=color:#0550ae>.</span>dwarf<span style=color:#0550ae>.</span>editor<span style=color:#0550ae>.</span>Function <span style=color:#0550ae>=</span> unit<span style=color:#0550ae>.</span>create_function<span style=color:#1f2328>(</span><span style=color:#0a3069>&#34;vm_set_register&#34;</span><span style=color:#1f2328>)</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span>func<span style=color:#0550ae>.</span>set_address<span style=color:#1f2328>(</span><span style=color:#0550ae>0x1400023</span><span style=color:#1f2328>)</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span>editor<span style=color:#0550ae>.</span>write<span style=color:#1f2328>(</span><span style=color:#0a3069>&#34;libd5A7BCF0524B8.dwarf&#34;</span><span style=color:#1f2328>)</span>
</span></span></code></pre></div><p>Under the hood, LIEF uses the LLVM&rsquo;s DWARF backend to create and generate the final DWARF.
In contrast to LLVM&rsquo;s low-level API, LIEF provides an abstraction that simplifies
the implementation details of the DWARF format.</p><p>For instance, if we want to create a DWARF for a function
that contains a <strong>stack variable</strong> at the offset (on the stack) <code>8</code>,
we can use the following API:</p><div class=highlight><pre tabindex=0 style=background-color:#f7f7f7;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-python data-lang=python><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>func<span style=color:#1f2328>:</span> lief<span style=color:#0550ae>.</span>dwarf<span style=color:#0550ae>.</span>editor<span style=color:#0550ae>.</span>Function <span style=color:#0550ae>=</span> unit<span style=color:#0550ae>.</span>create_function<span style=color:#1f2328>(</span><span style=color:#0a3069>&#34;vm_set_register&#34;</span><span style=color:#1f2328>)</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span>var<span style=color:#1f2328>:</span> lief<span style=color:#0550ae>.</span>dwarf<span style=color:#0550ae>.</span>editor<span style=color:#0550ae>.</span>Variable <span style=color:#0550ae>=</span> func<span style=color:#0550ae>.</span>create_stack_variable<span style=color:#1f2328>(</span><span style=color:#0a3069>&#34;my_stack_variable&#34;</span><span style=color:#1f2328>)</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span><span>var<span style=color:#0550ae>.</span>set_stack_offset<span style=color:#1f2328>(</span><span style=color:#0550ae>8</span><span style=color:#1f2328>)</span>
</span></span></code></pre></div><p>This code generates the following DWARF:</p><div class=highlight><pre tabindex=0 style=background-color:#f7f7f7;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-text data-lang=text><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span>0x0000000c: DW_TAG_compile_unit
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span>              DW_AT_producer    (&#34;Generated by LIEF (LLVM backend)&#34;)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span>0x00000011:   DW_TAG_subprogram
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span>                DW_AT_name      (&#34;vm_set_register&#34;)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span>                DW_AT_entry_pc  (0x0000000001400023)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span>0x0000001e:     DW_TAG_variable
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span>                  DW_AT_name    (&#34;my_stack_variable&#34;)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span>                  DW_AT_location        (DW_OP_fbreg -8)
</span></span></code></pre></div><p>Defining the <code>DW_AT_location</code> for a stack variable is not as simple as it sounds.
It requires defining some kind of DWARF expression and if you are curious about
the actual implementation, you can check this <a href=https://gist.github.com/romainthomas/1f7ba555c4439d9b4b457e293834ec5a>Github Gist</a>.</p><div class="admonition tip"><p class=admonition-title>Summary</p><p>LIEF exposes a high-level API to create DWARF based on the LLVM's low-level API</div><h2 id=dwarf-and-reverse-engineering>DWARF and Reverse Engineering</h2><p>Reverse engineering tools typically use their own format to store information about
analyzed binaries such as <code>*.idb</code> and <code>*.bndb</code>. Most of these tools are not compatible
with each other, except Binary Ninja which has a support for loading IDB (<a href=https://docs.binary.ninja/guide/migration/migrationguideida.html><em>Migrating from IDA</em></a>).
For Ghidra, importing IDA database is a non-goal (c.f. <a href=https://github.com/NationalSecurityAgency/ghidra/issues/2921>issue #2921</a>)</p><p>One alternative is to export binary information using <a href=https://github.com/google/binexport>BinExport</a>
or <a href=https://github.com/quarkslab/quokka>quokka</a>,
but many tools lack support for <strong>importing</strong> the exported data.</p><p>In contrast, Binary Ninja, Ghidra, and IDA all have built-in support for loading
DWARF files and external DWARF files.
The DWARF format is primarily designed to hold information about the original
source code, and the purpose of reverse engineering is to recover the semantic
of the source code information from the binary.</p><p>Therefore, we could use the DWARF as a reverse-engineering shared format to
export types, functions, and variables from reverse-engineered binaries.</p><p><img src=./tool2dw.webp alt></p><p>It&rsquo;s worth noting that DWARF is compatible with PE binaries, even though this
is not the default format for storing debug information on Windows.</p><div class="admonition note"><p class=admonition-title>PE / DWARF</p><p>If you compile a Windows executable with <code>clang[-cl]</code> and with the flags <code>-g -gdwarf-5</code>,
the final PE will contains DWARF information along with an external <code>.pdb</code>.</div><p>Currently, Binary Ninja is the only tool with a built-in plugin that can generate
a DWARF file from a <code>BinaryView</code> representation. However, it lacks the ability to
export stack-based variables, which can be crucial information.</p><p>The next section introduces two plugins for Ghidra and BinaryNinja to generate DWARF
from these tools.</p><h2 id=binaryninja--ghidra-plugins>BinaryNinja & Ghidra Plugins</h2><p><img src=./plugins.webp alt></p><p>To provide some background on this feature, I initially developed the BinaryNinja&rsquo;s DWARF exporter plugin
for my own needs before Vector35 team released an official plugin in BinaryNinja 3.5.
I use this plugin in my reverse engineering workflow to
symbolize <a href=https://github.com/QBDI/QBDI>QBDI</a> traces from DWARF information:</p><ol><li>I statically reverse-engineer the binary</li><li>I generate a DWARF file</li><li>I trace the binary with QBDI that uses the DWARF file to symbolize:<ul><li>Stack accesses (hence the need to stack variables in the DWARF)</li><li>Function calls and their parameters</li><li>Static variables accesses</li></ul></li><li>goto 1.</li></ol><p>For instance, I used this process to reverse engineer the <a href=https://www.romainthomas.fr/publication/22-sstic-blackhat-droidguard-safetynet/>DroidGuard VM</a>
a few years ago.
I&rsquo;ll take this blog post as an opportunity to share the DWARF associated with
my reverse engineering of the VM <code>libd5A7BCF0524B8.so</code>:</p><ul><li><strong>Original Binary:</strong> <a href=./libd5A7BCF0524B8.so>libd5A7BCF0524B8.so</a></li><li><strong>Binary with generated DWARF:</strong> <a href=./libd5A7BCF0524B8.so.debug>libd5A7BCF0524B8.so.debug</a></li></ul><p>As mentioned earlier, this functionality is integrated into BinaryNinja since version 3.5,
so I&rsquo;ll focus more on the Ghidra plugin. For those interested in more details about the
BinaryNinja plugin, you can visit this page: <a href=https://lief.re/doc/latest/plugins/binaryninja/index.html>LIEF - BinaryNinja</a></p><p>The Ghidra plugin allows us to export Ghidra&rsquo;s Program information into a DWARF file.
This can be done from the Project Manager interface by selecting the <code>DWARF</code> format
in the export section:</p><p><img src=project-dwarf-export.webp alt></p><p>You can also use this plugin from the <code>CodeBrowser</code> tool, by left-clicking on
the LIEF menu and selecting <code>Export as DWARF</code>:</p><p><img src=./codebrowser-export-dwarf.webp alt></p><p>The plugin is primarily written in Java (using the JNI) and you can also generate a
DWARF file from a headless Java script:</p><div class=highlight><pre tabindex=0 style=background-color:#f7f7f7;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-java data-lang=java><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span><span style=color:#cf222e>import</span><span style=color:#fff> </span><span style=color:#24292e>lief.ghidra.core.dwarf.export.Manager</span><span style=color:#1f2328>;</span><span style=color:#fff>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span><span style=color:#cf222e>import</span><span style=color:#fff> </span><span style=color:#24292e>lief.ghidra.core.NativeBridge</span><span style=color:#1f2328>;</span><span style=color:#fff>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span><span style=color:#fff>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span><span style=color:#cf222e>public</span><span style=color:#fff> </span><span style=color:#cf222e>class</span> <span style=color:#1f2328>LiefDwarfExportScript</span><span style=color:#fff> </span><span style=color:#cf222e>extends</span><span style=color:#fff> </span>GhidraScript<span style=color:#fff> </span><span style=color:#1f2328>{</span><span style=color:#fff>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span><span style=color:#fff>  </span><span style=color:#0550ae>@Override</span><span style=color:#fff>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span><span style=color:#fff>  </span><span style=color:#cf222e>protected</span><span style=color:#fff> </span><span style=color:#cf222e>void</span><span style=color:#fff> </span><span style=color:#6639ba>run</span><span style=color:#1f2328>()</span><span style=color:#fff> </span><span style=color:#cf222e>throws</span><span style=color:#fff> </span>Exception<span style=color:#fff> </span><span style=color:#1f2328>{</span><span style=color:#fff>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span><span style=color:#fff>    </span>NativeBridge<span style=color:#1f2328>.</span><span style=color:#1f2328>init</span><span style=color:#1f2328>();</span><span style=color:#fff>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span><span style=color:#fff>    </span>Manager<span style=color:#fff> </span>manager<span style=color:#fff> </span><span style=color:#0550ae>=</span><span style=color:#fff> </span><span style=color:#cf222e>new</span><span style=color:#fff> </span>Manager<span style=color:#1f2328>(</span>currentProgram<span style=color:#1f2328>);</span><span style=color:#fff>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span><span style=color:#fff>    </span>File<span style=color:#fff> </span>output<span style=color:#fff> </span><span style=color:#0550ae>=</span><span style=color:#fff> </span><span style=color:#cf222e>new</span><span style=color:#fff> </span>File<span style=color:#1f2328>(</span><span style=color:#0a3069>&#34;/home/romain/output.dwarf&#34;</span><span style=color:#1f2328>);</span><span style=color:#fff>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span><span style=color:#fff>    </span>manager<span style=color:#1f2328>.</span><span style=color:#1f2328>export</span><span style=color:#1f2328>(</span>output<span style=color:#1f2328>);</span><span style=color:#fff>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span><span style=color:#fff>  </span><span style=color:#1f2328>}</span><span style=color:#fff>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span><span style=color:#1f2328>}</span><span style=color:#fff>
</span></span></span></code></pre></div><div class="admonition note"><p class=admonition-title>IDA Support</p><p>I do not plan to support IDA for this functionality. However, if there is strong
demand for it, feel free to reach out to me. You can also create your own IDA
script using the Python or C++ API.</div><h2 id=last-word>Last Word</h2><p>This DWARF export functionality is still in early development, so I cannot
guarantee it is free of bugs. Additionally, the current version does not export
comments, but I plan to support this feature in the future.</p><p>The source code for the plugins are here:</p><ul><li><a href=https://github.com/lief-project/LIEF/tree/main/plugins/binaryninja>plugins/binaryninja</a></li><li><a href=https://github.com/lief-project/LIEF/tree/main/plugins/ghidra>plugins/ghidra</a></li></ul><p>Thank you for using LIEF.</p><p>Romain.</p></div><div class="d-flex flex-column flex-sm-row align-items-center border-top border-gray-200 mt-6 py-5"><div class=media><div class="avatar mr-4"><img src=https://lief.re/img/avatar/romain.png class="avatar-image rounded-circle" alt=Avatar></div><div class=media-body><span class="text-darkblue text-uppercase-xs font-weight-bolder"><a href=https://www.romainthomas.fr target=_blank>Romain Thomas
</a></span><span class="text-muted font-size-sm d-block">Posted on May 27, 2025</span></div></div></div></div></div></div></section><footer class="footer footer-dark bg-dark"><div class="container text-center"><div class=row><div class="col-12 col-md"><h6 class="footer-header mb-4 pb-md-2">LIEF</h6><a href=https://github.com/lief-project/LIEF class=footer-link>Github
</a><a href=https://lief.re//download class="footer-link mt-2">Download
</a><a href=https://lief.re//doc/latest class="footer-link mt-2">Documentation</a></div><div class="col-12 col-md mt-5 mt-md-0"><h6 class="footer-header mb-4 pb-md-2">Quarkslab</h6><a href=https://blog.quarkslab.com/ class=footer-link>Blog
</a><a href=https://quarkslab.com/ class="footer-link mt-2">Website</a></div><div class="col-12 col-md mt-5 mt-md-0"><h6 class="footer-header mb-4 pb-md-2">Other Tools</h6><a href=https://qbdi.quarkslab.com/ class=footer-link>QBDI
</a><a href=https://triton.quarkslab.com/ class="footer-link mt-2">Triton</a></div></div><div class="d-flex justify-content-center mt-6"><a href=https://infosec.exchange/@rh0main class="hover-lift-light text-decoration-none mx-2"><span class="icon-circle footer-social-icon"><i class="fab fa-mastodon fa-lg"></i>
</span></a><a href=https://x.com/lief_project class="hover-lift-light text-decoration-none mx-2"><span class="icon-circle footer-social-icon"><i class="fab fa-x-twitter fa-lg"></i>
</span></a><a href=https://crates.io/crates/lief class="hover-lift-light text-decoration-none mx-2"><span class="icon-circle footer-social-icon"><i class="fab fa-rust fa-lg"></i>
</span></a><a href=https://pypi.org/project/lief/ class="hover-lift-light text-decoration-none mx-2"><span class="icon-circle footer-social-icon"><i class="fab fa-python fa-lg"></i>
</span></a><a href=https://github.com/lief-project/LIEF class="hover-lift-light text-decoration-none mx-2"><span class="icon-circle footer-social-icon"><i class="fab fa-github fa-lg"></i>
</span></a><a href=https://discord.gg/jGQtyAYChJ class="hover-lift-light text-decoration-none mx-2"><span class="icon-circle footer-social-icon"><i class="fab fa-discord fa-lg"></i></span></a></div></div></footer><script src=https://lief.re//js/vendor.min.js></script><script src=https://lief.re//js/theme.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js></script><script>$("#copy").tooltip({trigger:"click",placement:"bottom"});function setTooltip(e){$("#copy").tooltip("hide").attr("data-original-title",e).tooltip("show")}function hideTooltip(){setTimeout(function(){$("#copy").tooltip("hide")},1e3)}var clipboard=new ClipboardJS("#copy");clipboard.on("success",function(){setTooltip("Copied!"),hideTooltip()}),clipboard.on("error",function(){setTooltip("Failed!"),hideTooltip()})</script></body></html>