<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">
  <meta name="Description" content="LIEF Documentation">

  
    <link href="https://fonts.gstatic.com/" rel="preconnect" crossorigin>
  

  <script src="../_static/javascripts/vendor.min.js"></script>

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.0/css/all.min.css">
  
  
    <link rel="apple-touch-icon" href="../_static/favicon.ico"/>
  
  
  
    <title>13 - PE Authenticode &#8212; LIEF Documentation</title>
  <link rel="stylesheet" href="../_static/fonts/material-icons.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/vendor.min.css"/>
  <script defer src="https://cdn.jsdelivr.net/npm/img-comparison-slider@8/dist/index.js" ></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/img-comparison-slider@8/dist/styles.css" />
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=d8a2add5" />
    <link rel="stylesheet" type="text/css" href="../_static/basic.css?v=29da98fa" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=4ae1632d" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=968db012" />
    <script src="../_static/documentation_options.js?v=8d563738"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="References" href="../references.html" />
    <link rel="prev" title="12 - ELF Coredump" href="12_elf_coredump.html" />
   
  <link rel="stylesheet" href="../_static/stylesheets/theme.css"/>

  </head>
  <body dir=ltr
        data-md-color-primary=blue data-md-color-accent=cyan>
  <nav class="navbar navbar-expand-lg navbar-light bg-white border-bottom fixed-top" role="navigation">
  <a href="../index.html" class="navbar-brand">LIEF Documentation</a>
  <button class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
    <span class="navbar-toggler-icon"></span>
  </button>
  <div class="collapse navbar-collapse justify-content-center mt-2 mt-lg-0" id="navbar-collapse">
    <ul class="navbar-nav position-relative px-lg-6 px-xl-8">
          
          <li class="nav-item">
              <a class="nav-link" href="https://lief.re">
                <i class="fa-solid fa-house mr-3"></i>Home
              </a>
          </li>
          
          <li class="nav-item">
              <a class="nav-link" href="https://lief.re/blog">
                <i class="fa-solid fa-rss mr-3"></i>Blog
              </a>
          </li>
          
          <li class="nav-item">
              <a class="nav-link" href="https://lief.re/download">
                <i class="fa-solid fa-download mr-3"></i>Download
              </a>
          </li>
        <li class="nav-item dropdown">

            <a class="nav-link dropdown-toggle" href="#" role="button" data-toggle="dropdown" aria-expanded="false">
                <i class="fa-solid fa-book mr-3"></i>Documentation
            </a>
            <div class="dropdown-menu" role="menu">
             <a class="dropdown-item" href="https://lief.re/doc/latest/doxygen">Doxygen</a>
            </div>
          </li>
        
          
          <li class="nav-item">
              <a class="nav-link" href="https://lief.re/about">
                <i class="fa-solid fa-bars-staggered mr-3"></i>About
              </a>
          </li>
        <li class="nav-item ml-lg-3 mt-3 mt-lg-0">
          <a class="hover-lift-light mt-1" href="https://discord.gg/jGQtyAYChJ" target="_blank">
            <i class="fab fa-2x fa-discord text-darkblue  mr-3"></i>
          </a>
        </li>
        <li class="nav-item">
          <a href="https://github.com/sponsors/lief-project" class="btn btn-outline-pink"
            target="_blank">
            <i class="fa-solid fa-heart mr-3"></i>
            Sponsor
          </a>
        </li>
    </ul>
  </div>
</nav>



  <div class="container-fluid container-docs">
    <div class="row">
      
<div class="col-12 col-lg-3 col-xl-2 border-lg-right py-lg-5 pl-lg-4 docs-sidebar docs-sidebar-left">
  <div class="collapse d-lg-block mb-6 mb-lg-0" id="sidebar-collapse">
    <form action="../search.html" method="GET" name="search">
      <input type="text" class="form-control" placeholder="Search" autocapitalize="off" autocomplete="off" spellcheck="false"
             data-md-component="query" data-md-state="active" name="q">
    </form>

    

      
        <ul class="list-unstyled mt-3">
          <li><a href="../intro.html" class="text-darkblue font-size-sm d-block mb-2"><em class="fa fa-solid fa-door-open"></em> Introduction</a></li>
          
        </ul>
      

      
        <ul class="list-unstyled mt-3">
          <li><a href="../installation.html" class="text-darkblue font-size-sm d-block mb-2"><em class="fa fa-solid fa-gears"></em> Installation and Integration</a></li>
          
        </ul>
      

      
        <ul class="list-unstyled mt-3">
          <li><a href="../compilation.html" class="text-darkblue font-size-sm d-block mb-2"><em class="fa fa-solid fa-laptop-code"></em> Compilation</a></li>
          
        </ul>
      

      
        <div class="text-darkblue text-uppercase font-size-normal font-weight-bolder mt-4 pt-2 mb-2">
          <span class="caption-text"><i class="fa-solid fa-sitemap"> </i>Formats</span>
        </div>
      

      
        <ul class="list-unstyled mt-3">
          <li><a href="../formats/elf/index.html" class="text-darkblue font-size-sm d-block mb-2"><em class="fa fa-brands fa-linux"></em> ELF</a></li>
          
        </ul>
      

      
        <ul class="list-unstyled mt-3">
          <li><a href="../formats/macho/index.html" class="text-darkblue font-size-sm d-block mb-2"><em class="fa fa-brands fa-apple"></em>  Mach-O</a></li>
          
        </ul>
      

      
        <ul class="list-unstyled mt-3">
          <li><a href="../formats/pe/index.html" class="text-darkblue font-size-sm d-block mb-2"><em class="fa fa-brands fa-windows"></em>  PE</a></li>
          
        </ul>
      

      
        <ul class="list-unstyled mt-3">
          <li><a href="../formats/coff/index.html" class="text-darkblue font-size-sm d-block mb-2"><em class="fa fa-brands fa-windows"></em>  COFF</a></li>
          
        </ul>
      

      
        <ul class="list-unstyled mt-3">
          <li><a href="../formats/android/index.html" class="text-darkblue font-size-sm d-block mb-2"><em class="fa fa-brands fa-android"></em> Android</a></li>
          
        </ul>
      

      
        <div class="text-darkblue text-uppercase font-size-normal font-weight-bolder mt-4 pt-2 mb-2">
          <span class="caption-text"><i class="fa-solid fa-code"> </i>API</span>
        </div>
      

      
        <ul class="list-unstyled mt-3">
          <li><a href="../api/binary_abstraction/index.html" class="text-darkblue font-size-sm d-block mb-2"><em class="fa fa-brands fa-uncharted"></em> Binary Abstraction</a></li>
          
        </ul>
      

      
        <ul class="list-unstyled mt-3">
          <li><a href="../api/utilities/index.html" class="text-darkblue font-size-sm d-block mb-2"><em class="fa fa-solid fa-hand-holding-hand"></em> Utilities</a></li>
          
        </ul>
      

      
        <ul class="list-unstyled mt-3">
          <li><a href="../api/error_handling/index.html" class="text-darkblue font-size-sm d-block mb-2"><em class="fa fa-solid fa-triangle-exclamation"></em> Error Handling</a></li>
          
        </ul>
      

      
        <ul class="list-unstyled mt-3">
          <li><a href="../api/logging/index.html" class="text-darkblue font-size-sm d-block mb-2"><em class="fa fa-regular fa-rectangle-list"></em> Logging</a></li>
          
        </ul>
      

      
        <ul class="list-unstyled mt-3">
          <li><a href="../api/cpp/index.html" class="text-darkblue font-size-sm d-block mb-2"><em class="fa fa-regular fa-file-code"></em> C++</a></li>
          
        </ul>
      

      
        <ul class="list-unstyled mt-3">
          <li><a href="../api/rust/index.html" class="text-darkblue font-size-sm d-block mb-2"><em class="fa fa-brands fa-rust"></em> Rust</a></li>
          
        </ul>
      

      
        <div class="text-darkblue text-uppercase font-size-normal font-weight-bolder mt-4 pt-2 mb-2">
          <span class="caption-text"><i class="fa-solid fa-hat-wizard"> </i>LIEF Extended</span>
        </div>
      

      
        <ul class="list-unstyled mt-3">
          <li><a href="../extended/intro.html" class="text-darkblue font-size-sm d-block mb-2"><em class="fa fa-cubes"></em> What is LIEF Extended?</a></li>
          
        </ul>
      

      
        <ul class="list-unstyled mt-3">
          <li><a href="../extended/debug_info/index.html" class="text-darkblue font-size-sm d-block mb-2"><em class="fa fa-solid fa-magnifying-glass"></em> Debug Info</a></li>
          
        </ul>
      

      
        <ul class="list-unstyled mt-3">
          <li><a href="../extended/dwarf/index.html" class="text-darkblue font-size-sm d-block mb-2"><em class="fa fa-solid fa-bars-staggered"></em> DWARF</a></li>
          
        </ul>
      

      
        <ul class="list-unstyled mt-3">
          <li><a href="../extended/pdb/index.html" class="text-darkblue font-size-sm d-block mb-2"><em class="fa fa-brands fa-windows"></em> PDB</a></li>
          
        </ul>
      

      
        <ul class="list-unstyled mt-3">
          <li><a href="../extended/objc/index.html" class="text-darkblue font-size-sm d-block mb-2"><em class="fa fa-brands fa-apple"></em> Objective-C</a></li>
          
        </ul>
      

      
        <ul class="list-unstyled mt-3">
          <li><a href="../extended/dsc/index.html" class="text-darkblue font-size-sm d-block mb-2"><em class="fa fa-solid fa-diagram-predecessor"></em> Dyld Shared Cache</a></li>
          
        </ul>
      

      
        <ul class="list-unstyled mt-3">
          <li><a href="../extended/disassembler/index.html" class="text-darkblue font-size-sm d-block mb-2"><em class="fa fa-solid fa-dna"></em> Disassembler</a></li>
          
        </ul>
      

      
        <ul class="list-unstyled mt-3">
          <li><a href="../extended/assembler/index.html" class="text-darkblue font-size-sm d-block mb-2"><em class="fa fa-solid fa-user-secret"></em> Assembler</a></li>
          
        </ul>
      

      
        <div class="text-darkblue text-uppercase font-size-normal font-weight-bolder mt-4 pt-2 mb-2">
          <span class="caption-text"><i class="fa-solid fa-puzzle-piece"> </i>Plugins</span>
        </div>
      

      
        <ul class="list-unstyled mt-3">
          <li><a href="../plugins/ghidra/index.html" class="text-darkblue font-size-sm d-block mb-2"><em class="fa fa-solid fa-dragon"></em> Ghidra</a></li>
          
        </ul>
      

      
        <ul class="list-unstyled mt-3">
          <li><a href="../plugins/binaryninja/index.html" class="text-darkblue font-size-sm d-block mb-2"><em class="fa fa-solid fa-user-ninja"></em> BinaryNinja</a></li>
          
        </ul>
      

      
        <div class="text-darkblue text-uppercase font-size-normal font-weight-bolder mt-4 pt-2 mb-2">
          <span class="caption-text"><i class="fa-solid fa-toolbox"> </i>Tools</span>
        </div>
      

      
        <ul class="list-unstyled mt-3">
          <li><a href="../tools/lief-patchelf/index.html" class="text-darkblue font-size-sm d-block mb-2"><em class="fa fa-solid fa-screwdriver-wrench"></em> lief-patchelf</a></li>
          
        </ul>
      

      
        <div class="text-darkblue text-uppercase font-size-normal font-weight-bolder mt-4 pt-2 mb-2">
          <span class="caption-text"><i class="fa-solid fa-layer-group"> </i>Tutorials</span>
        </div>
      

      
        <ul class="list-unstyled mt-3">
          <li><a href="01_play_with_formats.html" class="text-darkblue font-size-sm d-block mb-2">01 - Parse and manipulate formats</a></li>
          
        </ul>
      

      
        <ul class="list-unstyled mt-3">
          <li><a href="02_pe_from_scratch.html" class="text-darkblue font-size-sm d-block mb-2">02 - Create a PE from scratch (Deprecated)</a></li>
          
        </ul>
      

      
        <ul class="list-unstyled mt-3">
          <li><a href="03_elf_change_symbols.html" class="text-darkblue font-size-sm d-block mb-2">03 - Play with ELF symbols</a></li>
          
        </ul>
      

      
        <ul class="list-unstyled mt-3">
          <li><a href="04_elf_hooking.html" class="text-darkblue font-size-sm d-block mb-2">04 - ELF Hooking</a></li>
          
        </ul>
      

      
        <ul class="list-unstyled mt-3">
          <li><a href="05_elf_infect_plt_got.html" class="text-darkblue font-size-sm d-block mb-2">05 - Infecting the plt/got</a></li>
          
        </ul>
      

      
        <ul class="list-unstyled mt-3">
          <li><a href="06_pe_hooking.html" class="text-darkblue font-size-sm d-block mb-2">06 - PE Hooking (Deprecated)</a></li>
          
        </ul>
      

      
        <ul class="list-unstyled mt-3">
          <li><a href="07_pe_resource.html" class="text-darkblue font-size-sm d-block mb-2">07 - PE Resources</a></li>
          
        </ul>
      

      
        <ul class="list-unstyled mt-3">
          <li><a href="08_elf_bin2lib.html" class="text-darkblue font-size-sm d-block mb-2">08 - Transforming an ELF executable into a library</a></li>
          
        </ul>
      

      
        <ul class="list-unstyled mt-3">
          <li><a href="09_frida_lief.html" class="text-darkblue font-size-sm d-block mb-2">09 - How to use frida on a non-rooted device</a></li>
          
        </ul>
      

      
        <ul class="list-unstyled mt-3">
          <li><a href="10_android_formats.html" class="text-darkblue font-size-sm d-block mb-2">10 - Android formats</a></li>
          
        </ul>
      

      
        <ul class="list-unstyled mt-3">
          <li><a href="11_macho_modification.html" class="text-darkblue font-size-sm d-block mb-2">11 - Mach-O Modification</a></li>
          
        </ul>
      

      
        <ul class="list-unstyled mt-3">
          <li><a href="12_elf_coredump.html" class="text-darkblue font-size-sm d-block mb-2">12 - ELF Coredump</a></li>
          
        </ul>
      

      
        <ul class="list-unstyled mt-3">
          <li><a href="#" class="text-darkblue font-size-sm d-block mb-2">13 - PE Authenticode</a></li>
          
        </ul>
      

      
        <div class="text-darkblue text-uppercase font-size-normal font-weight-bolder mt-4 pt-2 mb-2">
          <span class="caption-text"><i class="fa-brands fa-space-awesome"> </i>Extra Information</span>
        </div>
      

      
        <ul class="list-unstyled mt-3">
          <li><a href="../references.html" class="text-darkblue font-size-sm d-block mb-2"><em class="fa fa-fa-solid fa-book-bookmark"></em> References</a></li>
          
        </ul>
      

      
        <ul class="list-unstyled mt-3">
          <li><a href="../changelog.html" class="text-darkblue font-size-sm d-block mb-2"><em class="fa fa-solid fa-code-compare"></em> Changelog</a></li>
          
        </ul>
      
  </div>
  <hr />
  <span class="svg-icon text-purple mr-1 relative-top--1">
  <svg xmlns="http://www.w3.org/2000/svg" width="512" height="512" viewBox="0 0 512 512"><title>ionicons-v5-d</title><circle cx="160" cy="96" r="48" style="fill:none;stroke:#000;stroke-linecap:round;stroke-linejoin:round;stroke-width:32px"></circle><circle cx="160" cy="416" r="48" style="fill:none;stroke:#000;stroke-linecap:round;stroke-linejoin:round;stroke-width:32px"></circle><line x1="160" y1="368" x2="160" y2="144" style="fill:none;stroke:#000;stroke-linecap:round;stroke-linejoin:round;stroke-width:32px"></line><circle cx="352" cy="160" r="48" style="fill:none;stroke:#000;stroke-linecap:round;stroke-linejoin:round;stroke-width:32px"></circle><path d="M352,208c0,128-192,48-192,160" style="fill:none;stroke:#000;stroke-linecap:round;stroke-linejoin:round;stroke-width:32px"></path></svg>
  </span>
  <a href="https://github.com/lief-project/LIEF/commits/5e10f16d" class="text-darkblue">1.0.0 (5e10f16d)</a>
    <br>
    Updated on 01/11/2025, 19:38:22.
</div>



      <div class="col-12 col-lg-9 col-xl-8 offset-lg-3 offset-xl-2 py-lg-5 px-lg-6 mb-8">
        
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb">
            
            <li class="breadcrumb-item">
              <a href="../index.html" aria-label="Home"><i class="fa-solid fa-home"></i></a>
            </li>
            <li class="breadcrumb-item active" aria-current="page"><a href="#">13 - PE Authenticode</a></li>
          </ol>
        </nav>
        
        
  <section id="pe-authenticode">
<span id="id1"></span><h1 id="tutorials-13-pe-authenticode--page-root">13 - PE Authenticode<a class="headerlink" href="#tutorials-13-pe-authenticode--page-root" title="Link to this heading">¶</a></h1>
<p>This tutorial explains how to process and verify PE authenticode with LIEF</p>
<p>By Romain Thomas - <a class="reference external" href="https://twitter.com/rh0main">@rh0main</a></p>
<hr class="docutils"/>
<section id="introduction">
<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Link to this heading">¶</a></h2>
<p>PE authenticode is the signature scheme used by Windows to sign and verify the integrity of PE executables.
The signature is associated with the data directory <a class="reference internal" href="../formats/pe/python.html#lief.PE.DataDirectory.TYPES.CERTIFICATE_TABLE" title="lief.PE.DataDirectory.TYPES.CERTIFICATE_TABLE"><code class="xref py py-attr docutils literal notranslate"><span class="pre">CERTIFICATE_TABLE</span></code></a>
that is not always tied to a section (it implies that the signature is not necessarily mapped in memory).
In fact, the data directory entry points to a file offset, not a RVA.
This signature is wrapped in a PKCS #7 container with custom object types as defined
in the official documentation <a class="footnote-reference brackets" href="#id10" id="id2" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a>.</p>
<p>This signature is not new in PE files and since the beginning of LIEF, we aimed to parse it.
Before the version <a class="reference internal" href="../changelog.html#release-0110"><span class="std std-ref">v0.11.0</span></a>, the implementation was somehow incomplete and inaccurate but
since the version <a class="reference internal" href="../changelog.html#release-0110"><span class="std std-ref">v0.11.0</span></a> and thanks to the sponsoring of the <a class="reference external" href="https://www.govcert.lu/en/">CERT Gouvernemental of Luxembourg</a>,
we refactored the design of the authenticode parser <a class="footnote-reference brackets" href="#id11" id="id3" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a> and we implemented functions to verify the signature.</p>
</section>
<section id="exploring-pkcs-7-signature">
<h2 id="exploring-pkcs-7-signature">Exploring PKCS #7 Signature<a class="headerlink" href="#exploring-pkcs-7-signature" title="Link to this heading">¶</a></h2>
<p>LIEF API tries to expose most of the internal components of the PKCS #7 container associated with the
Authenticode.
First, we can access the PE’s signature through the <a class="reference internal" href="../formats/pe/python.html#lief.PE.Binary.signatures" title="lief.PE.Binary.signatures"><code class="xref py py-attr docutils literal notranslate"><span class="pre">lief.PE.Binary.signatures</span></code></a> attribute
<a class="footnote-reference brackets" href="#id12" id="id4" role="doc-noteref"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">lief</span>
<span class="n">pe</span> <span class="o">=</span> <span class="n">lief</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s2">"avast_free_antivirus_setup_online.exe"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pe</span><span class="o">.</span><span class="n">signatures</span><span class="p">))</span>

<span class="n">signature</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">signatures</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<p>Although we usually find only <strong>one</strong> signature, PE executables can embed multiple signatures thanks to
the <code class="docutils literal notranslate"><span class="pre">/as</span></code> command of <code class="docutils literal notranslate"><span class="pre">signtool.exe</span></code>. This is why the <a class="reference internal" href="../formats/pe/python.html#lief.PE.Binary.signatures" title="lief.PE.Binary.signatures"><code class="xref py py-attr docutils literal notranslate"><span class="pre">signatures</span></code></a> attribute returns an
<strong>iterator</strong> over the signatures parsed by LIEF.</p>
<p>The <a class="reference internal" href="../formats/pe/python.html#lief.PE.Signature" title="lief.PE.Signature"><code class="xref py py-class docutils literal notranslate"><span class="pre">signature</span></code></a> variable is actually a <a class="reference internal" href="../formats/pe/python.html#lief.PE.Signature" title="lief.PE.Signature"><code class="xref py py-class docutils literal notranslate"><span class="pre">lief.PE.Signature</span></code></a> object which basically
mirrors the PKCS #7 container plus some method to verify its integrity.</p>
<p>Within this object, we can access the following attributes:</p>
<ul>
<li><p><a class="reference internal" href="../formats/pe/python.html#lief.PE.x509" title="lief.PE.x509"><code class="xref py py-class docutils literal notranslate"><span class="pre">x509</span></code></a> certificates used to sign the executable: <a class="reference internal" href="../formats/pe/python.html#lief.PE.Signature.certificates" title="lief.PE.Signature.certificates"><code class="xref py py-attr docutils literal notranslate"><span class="pre">lief.PE.Signature.certificates</span></code></a></p></li>
<li><p>The <a class="reference internal" href="../formats/pe/python.html#lief.PE.ContentInfo" title="lief.PE.ContentInfo"><code class="xref py py-class docutils literal notranslate"><span class="pre">ContentInfo</span></code></a> object that contains the authentihash value: <a class="reference internal" href="../formats/pe/python.html#lief.PE.ContentInfo.digest" title="lief.PE.ContentInfo.digest"><code class="xref py py-attr docutils literal notranslate"><span class="pre">lief.PE.ContentInfo.digest</span></code></a></p></li>
<li><p>The <a class="reference internal" href="../formats/pe/python.html#lief.PE.SignerInfo" title="lief.PE.SignerInfo"><code class="xref py py-class docutils literal notranslate"><span class="pre">SignerInfo</span></code></a> structure: <a class="reference internal" href="../formats/pe/python.html#lief.PE.Signature.signers" title="lief.PE.Signature.signers"><code class="xref py py-attr docutils literal notranslate"><span class="pre">lief.PE.Signature.signers</span></code></a></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>While the PKCS #7 standard enables multiple signers, Microsoft specifications require <strong>one</strong> and <strong>only one</strong>
signer.</p>
</div>
</li>
</ul>
<p>The <code class="docutils literal notranslate"><span class="pre">__str__()</span></code> functions of these objects are overloaded so that we can pretty-print the content of these objects easily:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Print certificates information</span>
<span class="k">for</span> <span class="n">crt</span> <span class="ow">in</span> <span class="n">signature</span><span class="o">.</span><span class="n">certificates</span><span class="p">:</span>
  <span class="nb">print</span><span class="p">(</span><span class="n">crt</span><span class="p">)</span>

<span class="c1"># Print the authentihash value embedded in the signature</span>
<span class="nb">print</span><span class="p">(</span><span class="n">signature</span><span class="o">.</span><span class="n">content_info</span><span class="o">.</span><span class="n">digest</span><span class="o">.</span><span class="n">hex</span><span class="p">())</span>

<span class="c1"># Print signer information</span>
<span class="nb">print</span><span class="p">(</span><span class="n">signature</span><span class="o">.</span><span class="n">signers</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>cert. version     : 3
serial number     : 04:09:18:1B:5F:D5:BB:66:75:53:43:B5:6F:95:50:08
issuer name       : C=US, O=DigiCert Inc, OU=www.digicert.com, CN=DigiCert Assured ID Root CA
subject name      : C=US, O=DigiCert Inc, OU=www.digicert.com, CN=DigiCert SHA2 Assured ID Code Signing CA
issued  on        : 2013-10-22 12:00:00
expires on        : 2028-10-22 12:00:00
signed using      : RSA with SHA-256
RSA key size      : 2048 bits
basic constraints : CA=true, max_pathlen=0
key usage         : Digital Signature, Key Cert Sign, CRL Sign
ext key usage     : Code Signing

cert. version     : 3
serial number     : 09:70:EF:4B:AD:5C:C4:4A:1C:2B:C3:D9:64:01:67:4C
issuer name       : C=US, O=DigiCert Inc, OU=www.digicert.com, CN=DigiCert SHA2 Assured ID Code Signing CA
subject name      : C=CZ, L=Praha, O=Avast Software s.r.o., OU=RE stapler cistodc, CN=Avast Software s.r.o.
issued  on        : 2020-04-02 00:00:00
expires on        : 2023-03-09 12:00:00
signed using      : RSA with SHA-256
RSA key size      : 2048 bits
basic constraints : CA=false
key usage         : Digital Signature
ext key usage     : Code Signing

a738da4446a4e78ab647db7e53427eb07961c994317f4c59d7edbea5cc786d80
SHA_256/RSA - C=US, O=DigiCert Inc, OU=www.digicert.com, CN=DigiCert SHA2 Assured ID Code Signing CA - 4 auth attr - 1 unauth attr
</pre></div>
</div>
<p>Regarding the PE files, the authentihash is computed through the function <a class="reference internal" href="../formats/pe/python.html#lief.PE.Binary.authentihash" title="lief.PE.Binary.authentihash"><code class="xref py py-meth docutils literal notranslate"><span class="pre">lief.PE.Binary.authentihash()</span></code></a>
which takes a <a class="reference internal" href="../formats/pe/python.html#lief.PE.ALGORITHMS" title="lief.PE.ALGORITHMS"><code class="xref py py-class docutils literal notranslate"><span class="pre">lief.PE.ALGORITHMS</span></code></a> enum as parameter to define which hash algorithm must be
used to compute the digest.</p>
<p>For instance, to compute the SHA-256 value of the authenticode, we just have to pass <a class="reference internal" href="../formats/pe/python.html#lief.PE.ALGORITHMS.SHA_256" title="lief.PE.ALGORITHMS.SHA_256"><code class="xref py py-attr docutils literal notranslate"><span class="pre">lief.PE.ALGORITHMS.SHA_256</span></code></a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">pe</span><span class="o">.</span><span class="n">authentihash</span><span class="p">(</span><span class="n">lief</span><span class="o">.</span><span class="n">PE</span><span class="o">.</span><span class="n">ALGORITHMS</span><span class="o">.</span><span class="n">SHA_256</span><span class="p">)</span><span class="o">.</span><span class="n">hex</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>a738da4446a4e78ab647db7e53427eb07961c994317f4c59d7edbea5cc786d80
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To compare the <a class="reference internal" href="../formats/pe/python.html#lief.PE.Binary.authentihash" title="lief.PE.Binary.authentihash"><code class="xref py py-meth docutils literal notranslate"><span class="pre">lief.PE.Binary.authentihash()</span></code></a> value with the signed one (i.e. <a class="reference internal" href="../formats/pe/python.html#lief.PE.ContentInfo.digest" title="lief.PE.ContentInfo.digest"><code class="xref py py-attr docutils literal notranslate"><span class="pre">lief.PE.ContentInfo.digest</span></code></a>)
we must use the same hash algorithm as defined by <a class="reference internal" href="../formats/pe/python.html#lief.PE.Signature.digest_algorithm" title="lief.PE.Signature.digest_algorithm"><code class="xref py py-attr docutils literal notranslate"><span class="pre">lief.PE.Signature.digest_algorithm</span></code></a></p>
</div>
<p>We also expose shortcut attributes in the Python API to compute the authentihash values for:</p>
<table>
<thead>
<tr class="row-odd"><th class="head"><p>Hash Algorithm</p></th>
<th class="head"><p>Binary’s Attribute</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>MD5</p></td>
<td><p><a class="reference internal" href="../formats/pe/python.html#lief.PE.Binary.authentihash_md5" title="lief.PE.Binary.authentihash_md5"><code class="xref py py-attr docutils literal notranslate"><span class="pre">authentihash_md5</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p>SHA1</p></td>
<td><p><a class="reference internal" href="../formats/pe/python.html#lief.PE.Binary.authentihash_sha1" title="lief.PE.Binary.authentihash_sha1"><code class="xref py py-attr docutils literal notranslate"><span class="pre">authentihash_sha1</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p>SHA-256</p></td>
<td><p><a class="reference internal" href="../formats/pe/python.html#lief.PE.Binary.authentihash_sha256" title="lief.PE.Binary.authentihash_sha256"><code class="xref py py-attr docutils literal notranslate"><span class="pre">authentihash_sha256</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p>SHA-512</p></td>
<td><p><a class="reference internal" href="../formats/pe/python.html#lief.PE.Binary.authentihash_sha512" title="lief.PE.Binary.authentihash_sha512"><code class="xref py py-attr docutils literal notranslate"><span class="pre">authentihash_sha512</span></code></a></p></td>
</tr>
</tbody>
</table>
<p>LIEF also exposes the original raw signature blob through the property <a class="reference internal" href="../formats/pe/python.html#lief.PE.Signature.raw_der" title="lief.PE.Signature.raw_der"><code class="xref py py-attr docutils literal notranslate"><span class="pre">lief.PE.Signature.raw_der</span></code></a> which
enables to export the signature:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>

<span class="n">Path</span><span class="p">(</span><span class="s2">"/tmp/extracted.p7b"</span><span class="p">)</span><span class="o">.</span><span class="n">write_bytes</span><span class="p">(</span><span class="n">signature</span><span class="o">.</span><span class="n">raw_der</span><span class="p">)</span>
</pre></div>
</div>
<p>Then, we can use <code class="docutils literal notranslate"><span class="pre">openssl</span></code> to process its content:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>$ openssl pkcs7 -inform der -print -in /tmp/extracted.p7b -noout -text
...
     sig_alg:
       algorithm: sha256WithRSAEncryption (1.2.840.113549.1.1.11)
       parameter: NULL
     signature:  (0 unused bits)
       0000 - 31 c3 a7 f3 70 e3 2c 49-15 bd f4 09 6c 27 4e   1...p.,I....l'N
       000f - 00 a9 23 df cb ea 7f 99-55 cb 24 88 75 e8 c4   ..#.....U.$.u..
       001e - de 48 4f 70 dd 2a 27 5c-df be 36 f6 84 0d ad   .HOp.*'\..6....
       002d - 35 5e 65 f7 af 55 01 7a-2d 01 18 a0 d6 98 a4   5^e..U.z-......
       003c - d1 bd 19 e9 a4 03 f4 a3-4d 12 6e 72 5f 6b 3a   ........M.nr_k:
       004b - b8 de 45 f1 63 80 b0 47-42 f6 38 b8 e7 5b dd   ..E.c..GB.8..[.
       005a - cf f2 f8 c2 61 4b 2c 19-b7 7d 78 8f 2e 0c b0   ....aK,..}x....
       0069 - 7c f2 d9 8e 9f 65 4e 21-63 19 6a 5b 0c 91 12   |....eN!c.j[...
       0078 - 44 29 fe 91 d5 6f 5d 9c-4d 7b a1 74 c6 69 d9   D)...o].M{.t.i.
       0087 - e7 23 26 54 35 5c 38 33-c5 a7 92 0d 70 a5 2a   .#&amp;T5\83....p.*
       0096 - 33 77 4a fc 86 b0 fa 59-2f 24 f6 a1 45 b2 09   3wJ....Y/$..E..
       00a5 - 75 2d a1 81 68 e4 67 11-46 e3 fb bf 0c c5 d5   u-..h.g.F......
       00b4 - d7 7b 7b 35 fb d6 e8 4a-c9 13 82 82 a7 0c 3e   .{{5...J......&gt;
       00c3 - 6f 61 e0 37 15 e0 37 5d-b8 22 14 ad 54 58 0e   oa.7..7]."..TX.
       00d2 - 95 6c 2b b1 d2 c7 6c 86-a1 9f fa d8 37 ca f7   .l+...l.....7..
       00e1 - 56 75 b0 9d df 7c 46 43-20 87 8a a3 81 47 82   Vu...|FC ....G.
       00f0 - 99 57 87 12 46 96 02 7c-a7 77 b9 42 4d c8 05   .W..F..|.w.BM..
       00ff - 0a                                             .
 crl:
   &lt;ABSENT&gt;
 signer_info:
     version: 1
     issuer_and_serial:
       issuer: C=US, O=DigiCert Inc, OU=www.digicert.com, CN=DigiCert SHA2 Assured ID Code Signing CA
       serial: 12549442701880659695003200114191853388
     digest_alg:
       algorithm: sha256 (2.16.840.1.101.3.4.2.1)
       parameter: NULL
     auth_attr:
         object: contentType (1.2.840.113549.1.9.3)
         set:
           OBJECT:undefined (1.3.6.1.4.1.311.2.1.4)

         object: undefined (1.3.6.1.4.1.311.2.1.11)
</pre></div>
</div>
<p>The <a class="reference external" href="https://github.com/lief-project/LIEF/blob/main/api/python/examples/authenticode/authenticode_reader.py">authenticode_reader.py</a>
script located in the <a class="reference external" href="https://github.com/lief-project/LIEF/tree/main/examples/python/authenticode">examples/</a> directory
can also be used to inspect the signature:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>python<span class="w"> </span>authenticode_reader.py<span class="w"> </span>--all<span class="w"> </span>avast_free_antivirus_setup_online.exe
</pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Signature version : 1
Digest Algorithm  : ALGORITHMS.SHA_256
Content Info:
  Content Type    : 1.3.6.1.4.1.311.2.1.4 (SPC_INDIRECT_DATA_CONTENT)
  Digest Algorithm: ALGORITHMS.SHA_256
  Digest          : a738da4446a4e78ab647db7e53427eb07961c994317f4c59d7edbea5cc786d80
Certificates
  Version            : 3
  Issuer             : C=US, O=DigiCert Inc, OU=www.digicert.com, CN=DigiCert Assured ID Root CA
  Subject            : C=US, O=DigiCert Inc, OU=www.digicert.com, CN=DigiCert SHA2 Assured ID Code Signing CA
  Serial Number      : 0409181b5fd5bb66755343b56f955008
  Signature Algorithm: SHA256_WITH_RSA_ENCRYPTION
  Valid from         : 2013/10/22 - 12:00:00
  Valid to           : 2028/10/22 - 12:00:00
  Key usage          : CRL_SIGN - KEY_CERT_SIGN - DIGITAL_SIGNATURE
  Ext key usage      : CODE_SIGNING
  RSA key size       : 2048
  ===========================================
  Version            : 3
  Issuer             : C=US, O=DigiCert Inc, OU=www.digicert.com, CN=DigiCert SHA2 Assured ID Code Signing CA
  Subject            : C=CZ, L=Praha, O=Avast Software s.r.o., OU=RE stapler cistodc, CN=Avast Software s.r.o.
  Serial Number      : 0970ef4bad5cc44a1c2bc3d96401674c
  Signature Algorithm: SHA256_WITH_RSA_ENCRYPTION
  Valid from         : 2020/04/02 - 00:00:00
  Valid to           : 2023/03/09 - 12:00:00
  Key usage          : DIGITAL_SIGNATURE
  Ext key usage      : CODE_SIGNING
  RSA key size       : 2048
  ===========================================
Signer(s)
  Version             : 1
  Serial Number       : 0970ef4bad5cc44a1c2bc3d96401674c
  Issuer              : C=US, O=DigiCert Inc, OU=www.digicert.com, CN=DigiCert SHA2 Assured ID Code Signing CA
  Digest Algorithm    : ALGORITHMS.SHA_256
  Encryption Algorithm: ALGORITHMS.RSA
  Encrypted Digest    : 758db1f480eb25bada6c ...
  Authenticated attributes:
     Content Type OID: 1.3.6.1.4.1.311.2.1.4 (SPC_INDIRECT_DATA_CONTENT)
     MS Statement type OID: 1.3.6.1.4.1.311.2.1.21 (INDIVIDUAL_CODE_SIGNING)
     Info: http://www.avast.com
     PKCS9 Message Digest: 3983816a7d1c62962540ec66fa8790fa45d1063cb23e933677de459f0b73c577
  Un-authenticated attributes:
     Generic Type 1.3.6.1.4.1.311.3.3.1 (MS_COUNTER_SIGN)
</pre></div>
</div>
</section>
<section id="verifying-the-signature">
<h2 id="verifying-the-signature">Verifying the Signature<a class="headerlink" href="#verifying-the-signature" title="Link to this heading">¶</a></h2>
<p>Besides the fact that LIEF can parse PE’s authenticode signature, LIEF can also verify the integrity of the authentihash
thanks to the method: <a class="reference internal" href="../formats/pe/python.html#lief.PE.Binary.verify_signature" title="lief.PE.Binary.verify_signature"><code class="xref py py-meth docutils literal notranslate"><span class="pre">lief.PE.Binary.verify_signature()</span></code></a> which outputs <a class="reference internal" href="../formats/pe/python.html#lief.PE.Signature.VERIFICATION_FLAGS.OK" title="lief.PE.Signature.VERIFICATION_FLAGS.OK"><code class="xref py py-attr docutils literal notranslate"><span class="pre">lief.PE.Signature.VERIFICATION_FLAGS.OK</span></code></a>
if the signature is valid or another enum (see: <a class="reference internal" href="../formats/pe/python.html#lief.PE.Signature.VERIFICATION_FLAGS" title="lief.PE.Signature.VERIFICATION_FLAGS"><code class="xref py py-attr docutils literal notranslate"><span class="pre">lief.PE.Signature.VERIFICATION_FLAGS</span></code></a>) when it is invalid:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pe</span> <span class="o">=</span> <span class="n">lief</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s2">"avast_free_antivirus_setup_online.exe"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pe</span><span class="o">.</span><span class="n">verify_signature</span><span class="p">())</span> <span class="c1"># lief.PE.Signature.VERIFICATION_FLAGS.OK</span>
</pre></div>
</div>
<p>We can also verify a PE binary with a <strong>detached signature</strong> by providing a <a class="reference internal" href="../formats/pe/python.html#lief.PE.Signature" title="lief.PE.Signature"><code class="xref py py-class docutils literal notranslate"><span class="pre">signature</span></code></a>
object to <a class="reference internal" href="../formats/pe/python.html#lief.PE.Binary.verify_signature" title="lief.PE.Binary.verify_signature"><code class="xref py py-meth docutils literal notranslate"><span class="pre">verify_signature()</span></code></a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pe</span> <span class="o">=</span> <span class="n">lief</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s2">"avast_free_antivirus_setup_online.exe"</span><span class="p">)</span>

<span class="hll"><span class="n">detached_sig</span> <span class="o">=</span> <span class="n">lief</span><span class="o">.</span><span class="n">PE</span><span class="o">.</span><span class="n">Signature</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s2">"/tmp/detached.p7b"</span><span class="p">)</span>
</span><span class="hll"><span class="nb">print</span><span class="p">(</span><span class="n">pe</span><span class="o">.</span><span class="n">verify_signature</span><span class="p">(</span><span class="n">detached_sig</span><span class="p">))</span>
</span></pre></div>
</div>
<p>The verification process does not rely on an external component (i.e. neither openssl nor WinTrust API) but we try
to reproduce the same checks as described in the RFC(s) and the official documentation of the Authenticode
<a class="footnote-reference brackets" href="#id13" id="id5" role="doc-noteref"><span class="fn-bracket">[</span>4<span class="fn-bracket">]</span></a>.</p>
<p>These checks include:</p>
<ol class="upperalpha simple">
<li><p>Check the integrity of the signature (<a class="reference internal" href="../formats/pe/python.html#lief.PE.Signature.check" title="lief.PE.Signature.check"><code class="xref py py-meth docutils literal notranslate"><span class="pre">lief.PE.Signature.check()</span></code></a>):</p>
<ol class="arabic simple">
<li><p>There is ONE and only ONE <a class="reference internal" href="../formats/pe/python.html#lief.PE.SignerInfo" title="lief.PE.SignerInfo"><code class="xref py py-class docutils literal notranslate"><span class="pre">SignerInfo</span></code></a></p></li>
<li><p>Digest algorithms are consistent
(<a class="reference internal" href="../formats/pe/python.html#lief.PE.Signature.digest_algorithm" title="lief.PE.Signature.digest_algorithm"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Signature.digest_algorithm</span></code></a> <code class="docutils literal notranslate"><span class="pre">==</span></code> <a class="reference internal" href="../formats/pe/python.html#lief.PE.ContentInfo.digest_algorithm" title="lief.PE.ContentInfo.digest_algorithm"><code class="xref py py-attr docutils literal notranslate"><span class="pre">ContentInfo.digest_algorithm</span></code></a> <code class="docutils literal notranslate"><span class="pre">==</span></code> <a class="reference internal" href="../formats/pe/python.html#lief.PE.SignerInfo.digest_algorithm" title="lief.PE.SignerInfo.digest_algorithm"><code class="xref py py-attr docutils literal notranslate"><span class="pre">SignerInfo.digest_algorithm</span></code></a>)</p></li>
<li><p>If the <a class="reference internal" href="../formats/pe/python.html#lief.PE.SignerInfo" title="lief.PE.SignerInfo"><code class="xref py py-class docutils literal notranslate"><span class="pre">SignerInfo</span></code></a> has authenticated attributes, check their integrity. Otherwise, check
the integrity of the <a class="reference internal" href="../formats/pe/python.html#lief.PE.ContentInfo" title="lief.PE.ContentInfo"><code class="xref py py-class docutils literal notranslate"><span class="pre">ContentInfo</span></code></a> against the Signer’s certificate.</p></li>
<li><p>If there are authenticated attributes, check that there is a
<a class="reference internal" href="../formats/pe/python.html#lief.PE.PKCS9MessageDigest" title="lief.PE.PKCS9MessageDigest"><code class="xref py py-class docutils literal notranslate"><span class="pre">lief.PE.PKCS9MessageDigest</span></code></a> attribute for which the <a class="reference internal" href="../formats/pe/python.html#lief.PE.PKCS9MessageDigest.digest" title="lief.PE.PKCS9MessageDigest.digest"><code class="xref py py-attr docutils literal notranslate"><span class="pre">digest</span></code></a>
matches the hash of the <a class="reference internal" href="../formats/pe/python.html#lief.PE.ContentInfo" title="lief.PE.ContentInfo"><code class="xref py py-class docutils literal notranslate"><span class="pre">ContentInfo</span></code></a></p></li>
<li><p>If there is a counter signature in the <strong>un-authenticated attributes</strong>, verify its integrity and check
that it wraps a valid <em>timestamping</em>.</p></li>
<li><p>Check the expiration of the certificates according to the potential <em>timestamping</em></p></li>
</ol>
</li>
<li><p>If the signature is valid, check that <a class="reference internal" href="../formats/pe/python.html#lief.PE.ContentInfo.digest" title="lief.PE.ContentInfo.digest"><code class="xref py py-attr docutils literal notranslate"><span class="pre">lief.PE.ContentInfo.digest</span></code></a> matches the computed
<a class="reference internal" href="../formats/pe/python.html#lief.PE.Binary.authentihash" title="lief.PE.Binary.authentihash"><code class="xref py py-meth docutils literal notranslate"><span class="pre">authentihash()</span></code></a></p></li>
</ol>
<p>These checks are the default behavior of the <a class="reference internal" href="../formats/pe/python.html#lief.PE.Binary.verify_signature" title="lief.PE.Binary.verify_signature"><code class="xref py py-meth docutils literal notranslate"><span class="pre">verify_signature()</span></code></a>. Nevertheless, you could
pass <a class="reference internal" href="../formats/pe/python.html#lief.PE.Signature.VERIFICATION_CHECKS" title="lief.PE.Signature.VERIFICATION_CHECKS"><code class="xref py py-class docutils literal notranslate"><span class="pre">lief.PE.Signature.VERIFICATION_CHECKS</span></code></a> flags to customize its behavior:</p>
<dl class="field-list">
<dt class="field-odd">Hash Only<span class="colon">:</span></dt>
<dd class="field-odd"><p>By using <a class="reference internal" href="../formats/pe/python.html#lief.PE.Signature.VERIFICATION_CHECKS.HASH_ONLY" title="lief.PE.Signature.VERIFICATION_CHECKS.HASH_ONLY"><code class="xref py py-attr docutils literal notranslate"><span class="pre">VERIFICATION_CHECKS.HASH_ONLY</span></code></a>, it only performs
step <code class="docutils literal notranslate"><span class="pre">B)</span></code> (i.e. check the authentihash values regardless of the signature integrity)</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pe</span><span class="o">.</span><span class="n">verify_signature</span><span class="p">(</span><span class="n">lief</span><span class="o">.</span><span class="n">PE</span><span class="o">.</span><span class="n">Signature</span><span class="o">.</span><span class="n">VERIFICATION_CHECKS</span><span class="o">.</span><span class="n">HASH_ONLY</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt class="field-even">Lifetime Signing<span class="colon">:</span></dt>
<dd class="field-even"><p>By using <a class="reference internal" href="../formats/pe/python.html#lief.PE.Signature.VERIFICATION_CHECKS.LIFETIME_SIGNING" title="lief.PE.Signature.VERIFICATION_CHECKS.LIFETIME_SIGNING"><code class="xref py py-attr docutils literal notranslate"><span class="pre">VERIFICATION_CHECKS.LIFETIME_SIGNING</span></code></a>, timestamped
signatures can expire if their certificate expired. It has the same meaning as <a class="reference external" href="https://docs.microsoft.com/en-us/windows/win32/api/wintrust/ns-wintrust-wintrust_data#WTD_LIFETIME_SIGNING_FLAG">WTD_LIFETIME_SIGNING_FLAG</a></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pe</span><span class="o">.</span><span class="n">verify_signature</span><span class="p">(</span><span class="n">lief</span><span class="o">.</span><span class="n">PE</span><span class="o">.</span><span class="n">Signature</span><span class="o">.</span><span class="n">VERIFICATION_CHECKS</span><span class="o">.</span><span class="n">LIFETIME_SIGNING</span><span class="p">)</span>
<span class="n">signature</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="n">lief</span><span class="o">.</span><span class="n">PE</span><span class="o">.</span><span class="n">Signature</span><span class="o">.</span><span class="n">VERIFICATION_CHECKS</span><span class="o">.</span><span class="n">LIFETIME_SIGNING</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt class="field-odd">Skip Certificate Check Time<span class="colon">:</span></dt>
<dd class="field-odd"><p>By using <a class="reference internal" href="../formats/pe/python.html#lief.PE.Signature.VERIFICATION_CHECKS.SKIP_CERT_TIME" title="lief.PE.Signature.VERIFICATION_CHECKS.SKIP_CERT_TIME"><code class="xref py py-attr docutils literal notranslate"><span class="pre">VERIFICATION_CHECKS.SKIP_CERT_TIME</span></code></a>,
LIEF doesn’t raise an error if the certificate(s) expired.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Returns lief.PE.Signature.VERIFICATION_FLAGS.OK even though</span>
<span class="c1"># the certificates expired</span>
<span class="n">pe</span><span class="o">.</span><span class="n">verify_signature</span><span class="p">(</span><span class="n">lief</span><span class="o">.</span><span class="n">PE</span><span class="o">.</span><span class="n">Signature</span><span class="o">.</span><span class="n">VERIFICATION_CHECKS</span><span class="o">.</span><span class="n">SKIP_CERT_TIME</span><span class="p">)</span>
<span class="n">signature</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="n">lief</span><span class="o">.</span><span class="n">PE</span><span class="o">.</span><span class="n">Signature</span><span class="o">.</span><span class="n">VERIFICATION_CHECKS</span><span class="o">.</span><span class="n">SKIP_CERT_TIME</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To verify the integrity of a <a class="reference internal" href="../formats/pe/python.html#lief.PE.Signature" title="lief.PE.Signature"><code class="xref py py-class docutils literal notranslate"><span class="pre">Signature</span></code></a> object, you can use
<a class="reference internal" href="../formats/pe/python.html#lief.PE.Signature.check" title="lief.PE.Signature.check"><code class="xref py py-meth docutils literal notranslate"><span class="pre">lief.PE.Signature.check()</span></code></a></p>
</div>
</section>
<section id="certificate-chain-of-trust">
<h2 id="certificate-chain-of-trust">Certificate Chain of Trust<a class="headerlink" href="#certificate-chain-of-trust" title="Link to this heading">¶</a></h2>
<p>Last but not least, we can also verify the certificates chain thanks to:</p>
<ol class="arabic simple">
<li><p><a class="reference internal" href="../formats/pe/python.html#lief.PE.x509.verify" title="lief.PE.x509.verify"><code class="xref py py-meth docutils literal notranslate"><span class="pre">lief.PE.x509.verify()</span></code></a></p></li>
<li><p><a class="reference internal" href="../formats/pe/python.html#lief.PE.x509.is_trusted_by" title="lief.PE.x509.is_trusted_by"><code class="xref py py-meth docutils literal notranslate"><span class="pre">lief.PE.x509.is_trusted_by()</span></code></a></p></li>
</ol>
<p><a class="reference internal" href="../formats/pe/python.html#lief.PE.x509.verify" title="lief.PE.x509.verify"><code class="xref py py-meth docutils literal notranslate"><span class="pre">verify()</span></code></a> aims to verify a signed certificate from its CA. Given a CA <a class="reference internal" href="../formats/pe/python.html#lief.PE.x509" title="lief.PE.x509"><code class="xref py py-class docutils literal notranslate"><span class="pre">x509</span></code></a>
certificate, <code class="docutils literal notranslate"><span class="pre">CA.verify(signed)</span></code> verifies that the <code class="docutils literal notranslate"><span class="pre">signed</span></code> parameter has been signed by <code class="docutils literal notranslate"><span class="pre">CA</span></code>.</p>
<p>On the other hand, <a class="reference internal" href="../formats/pe/python.html#lief.PE.x509.is_trusted_by" title="lief.PE.x509.is_trusted_by"><code class="xref py py-meth docutils literal notranslate"><span class="pre">is_trusted_by()</span></code></a> can be used to check that a given <a class="reference internal" href="../formats/pe/python.html#lief.PE.x509" title="lief.PE.x509"><code class="xref py py-class docutils literal notranslate"><span class="pre">x509</span></code></a>
certificate is verified against a <strong>list of certificates</strong>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">CA_BUNDLE</span> <span class="o">=</span> <span class="n">lief</span><span class="o">.</span><span class="n">PE</span><span class="o">.</span><span class="n">x509</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s2">"ms_bundle.pem"</span><span class="p">)</span>
<span class="n">signer</span> <span class="o">=</span> <span class="n">signature</span><span class="o">.</span><span class="n">signers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">signer</span><span class="o">.</span><span class="n">cert</span><span class="o">.</span><span class="n">is_trusted_by</span><span class="p">(</span><span class="n">CA_BUNDLE</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">cert1</span> <span class="o">=</span> <span class="n">lief</span><span class="o">.</span><span class="n">PE</span><span class="o">.</span><span class="n">x509</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s2">"ca1.crt"</span><span class="p">)</span>
<span class="n">cert2</span> <span class="o">=</span> <span class="n">lief</span><span class="o">.</span><span class="n">PE</span><span class="o">.</span><span class="n">x509</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s2">"ca2.crt"</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">signer</span><span class="o">.</span><span class="n">cert</span><span class="o">.</span><span class="n">is_trusted_by</span><span class="p">([</span><span class="n">cert1</span><span class="p">,</span> <span class="n">cert2</span><span class="p">]))</span>
</pre></div>
</div>
</section>
<section id="limitations">
<h2 id="limitations">Limitations<a class="headerlink" href="#limitations" title="Link to this heading">¶</a></h2>
<p>Regarding the PKCS #7 structure itself, LIEF is able to parse and process most of its elements. Nevertheless,
the <a class="reference internal" href="../formats/pe/python.html#lief.PE.SignerInfo" title="lief.PE.SignerInfo"><code class="xref py py-class docutils literal notranslate"><span class="pre">lief.PE.SignerInfo</span></code></a> structure can embed attributes (authenticated or not) for which the ASN.1 structure
can be public or not. As of LIEF v0.11.0 we do not support yet the following OIDs:</p>
<table>
<thead>
<tr class="row-odd"><th class="head"><p>OID</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1.3.6.1.4.1.311.3.3.1</p></td>
<td><p>Ms-CounterSign (undocumented, supported in LIEF 0.15.0)</p></td>
</tr>
<tr class="row-odd"><td><p>1.2.840.113549.1.9.16.2.12</p></td>
<td><p>S/MIME Signing certificate (id-aa-signingCertificate)</p></td>
</tr>
<tr class="row-even"><td><p>1.3.6.1.4.1.311.2.6.1</p></td>
<td><p>SPC_COMMERCIAL_SP_KEY_PURPOSE_OBJID</p></td>
</tr>
<tr class="row-odd"><td><p>1.3.6.1.4.1.311.10.3.28</p></td>
<td><p>szOID_PLATFORM_MANIFEST_BINARY_ID (supported in LIEF 0.15.0)</p></td>
</tr>
</tbody>
</table>
<p>These not-supported attributes are wrapped within the <a class="reference internal" href="../formats/pe/python.html#lief.PE.GenericType" title="lief.PE.GenericType"><code class="xref py py-class docutils literal notranslate"><span class="pre">lief.PE.GenericType</span></code></a> that exposes the raw
ASN.1 blob with the property <a class="reference internal" href="../formats/pe/python.html#lief.PE.GenericType.raw_content" title="lief.PE.GenericType.raw_content"><code class="xref py py-attr docutils literal notranslate"><span class="pre">raw_content</span></code></a>.</p>
</section>
<section id="conclusion">
<h2 id="conclusion">Conclusion<a class="headerlink" href="#conclusion" title="Link to this heading">¶</a></h2>
<p>Under the hood, most of the work is done by <a class="reference external" href="https://github.com/Mbed-TLS/mbedtls">mbedtls</a> which provides the following primitive used
by LIEF:</p>
<ul class="simple">
<li><p>ASN.1 decoder</p></li>
<li><p>x509 certificate processing (parsing AND verification)</p></li>
<li><p>Hash algorithms</p></li>
<li><p>Public key algorithms</p></li>
</ul>
<p>We can also cross-compile a small C++ snippet for iOS:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;LIEF/PE.hpp&gt;</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">argc</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="o">**</span><span class="w"> </span><span class="n">argv</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">unique_ptr</span><span class="o">&lt;</span><span class="n">LIEF</span><span class="o">::</span><span class="n">PE</span><span class="o">::</span><span class="n">Binary</span><span class="o">&gt;</span><span class="w"> </span><span class="n">pe</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LIEF</span><span class="o">::</span><span class="n">PE</span><span class="o">::</span><span class="n">Parser</span><span class="o">::</span><span class="n">parse</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">pe</span><span class="o">-&gt;</span><span class="n">verify_signature</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">LIEF</span><span class="o">::</span><span class="n">PE</span><span class="o">::</span><span class="n">Signature</span><span class="o">::</span><span class="n">VERIFICATION_FLAGS</span><span class="p">.</span><span class="n">OK</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">"Signature ok!"</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">"Error!"</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>So that we can verify the integrity of a PE executable on an iPhone:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">iPhone:~ root# </span>file<span class="w"> </span>PE32_x86-64_binary_avast-free-antivirus-setup-online.exe
<span class="go">PE32_x86-64_binary_avast-free-antivirus-setup-online.exe: PE32 executable (GUI) Intel 80386, for MS Windows</span>
<span class="gp">iPhone:~ root# </span>file<span class="w"> </span>./pe_authenticode_check
<span class="go">./pe_authenticode_check: Mach-O 64-bit arm64 executable, flags:&lt;NOUNDEFS|DYLDLINK|TWOLEVEL|WEAK_DEFINES|BINDS_TO_WEAK|PIE|HAS_TLV_DESCRIPTORS&gt;</span>
<span class="gp">iPhone:~ root# </span>./pe_authenticode_check<span class="w"> </span>PE32_x86-64_binary_avast-free-antivirus-setup-online.exe
<span class="go">Signature ok!</span>
<span class="gp">iPhone:~ root#</span>
</pre></div>
</div>
<p>Whilst this example is quite useless, it emphasizes the purpose of this project:</p>
<ul class="simple">
<li><p>Provide a cross-platform and cross-format library</p></li>
<li><p>Expose a high-level API (Python) as well as a (more or less) low-level API (C++)</p></li>
<li><p>Few dependencies so that the static version of LIEF does not need external libraries <a class="footnote-reference brackets" href="#id14" id="id6" role="doc-noteref"><span class="fn-bracket">[</span>5<span class="fn-bracket">]</span></a>.</p></li>
</ul>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>otool<span class="w"> </span>-L<span class="w"> </span>pe_authenticode_check

<span class="go">/System/Library/Frameworks/Foundation.framework/Foundation (compatibility version 300.0.0, current version 1770.255.0)</span>
<span class="go">/usr/lib/libobjc.A.dylib (compatibility version 1.0.0, current version 228.0.0)</span>
<span class="go">/usr/lib/libc++.1.dylib (compatibility version 1.0.0, current version 904.4.0)</span>
<span class="go">/usr/lib/libSystem.B.dylib (compatibility version 1.0.0, current version 1292.60.1)</span>
</pre></div>
</div>
<p>To complete these functionalities of LIEF, you might also be interested in the following projects
that deal with Authenticode:</p>
<table>
<thead>
<tr class="row-odd"><th class="head"><p>Project</p></th>
<th class="head"><p>URL</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>signify</p></td>
<td><p><a class="reference external" href="https://github.com/ralphje/signify">https://github.com/ralphje/signify</a></p></td>
</tr>
<tr class="row-odd"><td><p>winsign</p></td>
<td><p><a class="reference external" href="https://github.com/mozilla-releng/winsign">https://github.com/mozilla-releng/winsign</a></p></td>
</tr>
<tr class="row-even"><td><p>uthenticode</p></td>
<td><p><a class="reference external" href="https://github.com/trailofbits/uthenticode">https://github.com/trailofbits/uthenticode</a></p></td>
</tr>
<tr class="row-odd"><td><p>AuthenticodeLint</p></td>
<td><p><a class="reference external" href="https://github.com/vcsjones/AuthenticodeLint">https://github.com/vcsjones/AuthenticodeLint</a></p></td>
</tr>
<tr class="row-even"><td><p>osslsigncode</p></td>
<td><p><a class="reference external" href="https://github.com/mtrojnar/osslsigncode">https://github.com/mtrojnar/osslsigncode</a></p></td>
</tr>
<tr class="row-odd"><td><p>yara-x</p></td>
<td><p><a class="reference external" href="https://github.com/VirusTotal/yara-x">https://github.com/VirusTotal/yara-x</a> (which has support for PE Authenticode)</p></td>
</tr>
</tbody>
</table>
<p>Finally, you can find additional information about the Authenticode in Trail of Bits blog post <a class="footnote-reference brackets" href="#id15" id="id7" role="doc-noteref"><span class="fn-bracket">[</span>6<span class="fn-bracket">]</span></a>.
If you are interested in Authenticode tricks used by Dropbox, you can take a look at Microsoft website <a class="footnote-reference brackets" href="#id16" id="id8" role="doc-noteref"><span class="fn-bracket">[</span>7<span class="fn-bracket">]</span></a> and
if you are interested in understanding how the integrity of the PKCS #7 works, you can look at <em>Manual verify PKCS#7 signed data with OpenSSL</em> <a class="footnote-reference brackets" href="#id17" id="id9" role="doc-noteref"><span class="fn-bracket">[</span>8<span class="fn-bracket">]</span></a></p>
<p class="rubric">References</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id10" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a href="#id2" role="doc-backlink">1</a><span class="fn-bracket">]</span></span>
<p><a class="reference external" href="http://download.microsoft.com/download/9/c/5/9c5b2167-8017-4bae-9fde-d599bac8184a/Authenticode_PE.docx">http://download.microsoft.com/download/9/c/5/9c5b2167-8017-4bae-9fde-d599bac8184a/Authenticode_PE.docx</a></p>
</aside>
<aside class="footnote brackets" id="id11" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a href="#id3" role="doc-backlink">2</a><span class="fn-bracket">]</span></span>
<p>Which now exceptions-free</p>
</aside>
<aside class="footnote brackets" id="id12" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a href="#id4" role="doc-backlink">3</a><span class="fn-bracket">]</span></span>
<p>This tutorial uses the Python API but the C++ API is very similar</p>
</aside>
<aside class="footnote brackets" id="id13" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a href="#id5" role="doc-backlink">4</a><span class="fn-bracket">]</span></span>
<p>See: <a class="reference external" href="https://github.com/lief-project/LIEF/tree/master/src/PE/signature/Signature.cpp">src/PE/signature/Signature.cpp - check()</a> for the implementation</p>
</aside>
<aside class="footnote brackets" id="id14" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a href="#id6" role="doc-backlink">5</a><span class="fn-bracket">]</span></span>
<p>Except the C/C++ STL</p>
</aside>
<aside class="footnote brackets" id="id15" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a href="#id7" role="doc-backlink">6</a><span class="fn-bracket">]</span></span>
<p><a class="reference external" href="https://blog.trailofbits.com/2020/05/27/verifying-windows-binaries-without-windows/">https://blog.trailofbits.com/2020/05/27/verifying-windows-binaries-without-windows/</a></p>
</aside>
<aside class="footnote brackets" id="id16" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a href="#id8" role="doc-backlink">7</a><span class="fn-bracket">]</span></span>
<p><a class="reference external" href="https://docs.microsoft.com/en-us/archive/blogs/ieinternals/caveats-for-authenticode-code-signing">https://docs.microsoft.com/en-us/archive/blogs/ieinternals/caveats-for-authenticode-code-signing</a></p>
</aside>
<aside class="footnote brackets" id="id17" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a href="#id9" role="doc-backlink">8</a><span class="fn-bracket">]</span></span>
<p><a class="reference external" href="http://qistoph.blogspot.com/2012/01/manual-verify-pkcs7-signed-data-with.html">http://qistoph.blogspot.com/2012/01/manual-verify-pkcs7-signed-data-with.html</a></p>
</aside>
</aside>
<p class="rubric">API</p>
<ul class="simple">
<li><p><a class="reference internal" href="../formats/pe/python.html#lief.PE.Binary.verify_signature" title="lief.PE.Binary.verify_signature"><code class="xref py py-meth docutils literal notranslate"><span class="pre">lief.PE.Binary.verify_signature()</span></code></a></p></li>
<li><p><a class="reference internal" href="../formats/pe/python.html#lief.PE.Binary.authentihash" title="lief.PE.Binary.authentihash"><code class="xref py py-meth docutils literal notranslate"><span class="pre">lief.PE.Binary.authentihash()</span></code></a></p></li>
<li><p><a class="reference internal" href="../formats/pe/python.html#lief.PE.Binary.authentihash_md5" title="lief.PE.Binary.authentihash_md5"><code class="xref py py-attr docutils literal notranslate"><span class="pre">lief.PE.Binary.authentihash_md5</span></code></a></p></li>
<li><p><a class="reference internal" href="../formats/pe/python.html#lief.PE.Binary.authentihash_sha1" title="lief.PE.Binary.authentihash_sha1"><code class="xref py py-attr docutils literal notranslate"><span class="pre">lief.PE.Binary.authentihash_sha1</span></code></a></p></li>
<li><p><a class="reference internal" href="../formats/pe/python.html#lief.PE.Binary.authentihash_sha256" title="lief.PE.Binary.authentihash_sha256"><code class="xref py py-attr docutils literal notranslate"><span class="pre">lief.PE.Binary.authentihash_sha256</span></code></a></p></li>
<li><p><a class="reference internal" href="../formats/pe/python.html#lief.PE.Binary.authentihash_sha512" title="lief.PE.Binary.authentihash_sha512"><code class="xref py py-attr docutils literal notranslate"><span class="pre">lief.PE.Binary.authentihash_sha512</span></code></a></p></li>
<li><p><a class="reference internal" href="../formats/pe/python.html#lief.PE.Binary.signatures" title="lief.PE.Binary.signatures"><code class="xref py py-attr docutils literal notranslate"><span class="pre">lief.PE.Binary.signatures</span></code></a></p></li>
<li><p><a class="reference internal" href="../formats/pe/python.html#lief.PE.Signature" title="lief.PE.Signature"><code class="xref py py-class docutils literal notranslate"><span class="pre">lief.PE.Signature</span></code></a></p></li>
<li><p><a class="reference internal" href="../formats/pe/python.html#lief.PE.x509" title="lief.PE.x509"><code class="xref py py-class docutils literal notranslate"><span class="pre">lief.PE.x509</span></code></a></p></li>
<li><p><a class="reference internal" href="../formats/pe/python.html#lief.PE.ContentInfo" title="lief.PE.ContentInfo"><code class="xref py py-class docutils literal notranslate"><span class="pre">lief.PE.ContentInfo</span></code></a></p></li>
<li><p><a class="reference internal" href="../formats/pe/python.html#lief.PE.SignerInfo" title="lief.PE.SignerInfo"><code class="xref py py-class docutils literal notranslate"><span class="pre">lief.PE.SignerInfo</span></code></a></p></li>
<li><p><a class="reference internal" href="../formats/pe/python.html#lief.PE.Attribute" title="lief.PE.Attribute"><code class="xref py py-class docutils literal notranslate"><span class="pre">lief.PE.Attribute</span></code></a></p></li>
<li><p><a class="reference internal" href="../formats/pe/python.html#lief.PE.ContentType" title="lief.PE.ContentType"><code class="xref py py-class docutils literal notranslate"><span class="pre">lief.PE.ContentType</span></code></a></p></li>
<li><p><a class="reference internal" href="../formats/pe/python.html#lief.PE.GenericType" title="lief.PE.GenericType"><code class="xref py py-class docutils literal notranslate"><span class="pre">lief.PE.GenericType</span></code></a></p></li>
<li><p><a class="reference internal" href="../formats/pe/python.html#lief.PE.MsSpcNestedSignature" title="lief.PE.MsSpcNestedSignature"><code class="xref py py-class docutils literal notranslate"><span class="pre">lief.PE.MsSpcNestedSignature</span></code></a></p></li>
<li><p><a class="reference internal" href="../formats/pe/python.html#lief.PE.MsSpcStatementType" title="lief.PE.MsSpcStatementType"><code class="xref py py-class docutils literal notranslate"><span class="pre">lief.PE.MsSpcStatementType</span></code></a></p></li>
<li><p><a class="reference internal" href="../formats/pe/python.html#lief.PE.PKCS9AtSequenceNumber" title="lief.PE.PKCS9AtSequenceNumber"><code class="xref py py-class docutils literal notranslate"><span class="pre">lief.PE.PKCS9AtSequenceNumber</span></code></a></p></li>
<li><p><a class="reference internal" href="../formats/pe/python.html#lief.PE.PKCS9CounterSignature" title="lief.PE.PKCS9CounterSignature"><code class="xref py py-class docutils literal notranslate"><span class="pre">lief.PE.PKCS9CounterSignature</span></code></a></p></li>
<li><p><a class="reference internal" href="../formats/pe/python.html#lief.PE.PKCS9MessageDigest" title="lief.PE.PKCS9MessageDigest"><code class="xref py py-class docutils literal notranslate"><span class="pre">lief.PE.PKCS9MessageDigest</span></code></a></p></li>
<li><p><a class="reference internal" href="../formats/pe/python.html#lief.PE.PKCS9SigningTime" title="lief.PE.PKCS9SigningTime"><code class="xref py py-class docutils literal notranslate"><span class="pre">lief.PE.PKCS9SigningTime</span></code></a></p></li>
<li><p><a class="reference internal" href="../formats/pe/python.html#lief.PE.SpcSpOpusInfo" title="lief.PE.SpcSpOpusInfo"><code class="xref py py-class docutils literal notranslate"><span class="pre">lief.PE.SpcSpOpusInfo</span></code></a></p></li>
</ul>
</section>
</section>


      </div>
      

<div class="col-xl-2 d-none d-xl-block px-0 py-5 docs-sidebar docs-sidebar-right">
  <aside class="border-left pl-5 py-3">
    <span class="text-uppercase text-muted font-size-sm d-block mb-3">
      On this page:
    </span>
        <a href="#introduction" class="d-block my-2" data-toggle="scroll">Introduction</a>
        <a href="#exploring-pkcs-7-signature" class="d-block my-2" data-toggle="scroll">Exploring PKCS #7 Signature</a>
        <a href="#verifying-the-signature" class="d-block my-2" data-toggle="scroll">Verifying the Signature</a>
        <a href="#certificate-chain-of-trust" class="d-block my-2" data-toggle="scroll">Certificate Chain of Trust</a>
        <a href="#limitations" class="d-block my-2" data-toggle="scroll">Limitations</a>
        <a href="#conclusion" class="d-block my-2" data-toggle="scroll">Conclusion</a>

  </aside>
</div>
    </div>
  </div>
  </body>
</html>