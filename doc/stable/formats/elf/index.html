<!doctype html><html data-content_root=../../ lang=en><meta charset=utf-8><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content="width=device-width,initial-scale=1" name=viewport><meta content="width=device-width,initial-scale=1" name=viewport><meta content="ie=edge" http-equiv=x-ua-compatible><meta content="Copy to clipboard" name=lang:clipboard.copy><meta content="Copied to clipboard" name=lang:clipboard.copied><meta content=en name=lang:search.language><meta content=True name=lang:search.pipeline.stopwords><meta content=True name=lang:search.pipeline.trimmer><meta content="No matching documents" name=lang:search.result.none><meta content="1 matching document" name=lang:search.result.one><meta content="# matching documents" name=lang:search.result.other><meta content=[\s\-]+ name=lang:search.tokenizer><meta content="LIEF Documentation" name=Description><link crossorigin href=https://fonts.gstatic.com/ rel=preconnect><script src=../../_static/javascripts/vendor.min.js></script><link href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.0/css/all.min.css rel=stylesheet><link href=../../_static/favicon.ico rel=apple-touch-icon><title>ELF — LIEF Documentation</title><link href=../../_static/fonts/material-icons.css rel=stylesheet><link href=../../_static/stylesheets/vendor.min.css rel=stylesheet><script defer src=https://cdn.jsdelivr.net/npm/img-comparison-slider@8/dist/index.js></script><link href=https://cdn.jsdelivr.net/npm/img-comparison-slider@8/dist/styles.css rel=stylesheet><link href="../../_static/pygments.css?v=d8a2add5" rel=stylesheet><link href="../../_static/basic.css?v=29da98fa" rel=stylesheet><link href="../../_static/graphviz.css?v=4ae1632d" rel=stylesheet><link href="../../_static/css/custom.css?v=968db012" rel=stylesheet><link href="../../_static/tabs.css?v=a5c4661c" rel=stylesheet><script src="../../_static/documentation_options.js?v=f04cce2a"></script><script src="../../_static/doctools.js?v=fd6eb6e6"></script><script src="../../_static/sphinx_highlight.js?v=6ffebe34"></script><script src="../../_static/tabs.js?v=3030b3cb"></script><link href=../../_static/favicon.ico rel=icon><link href=../../genindex.html rel=index title=Index><link href=../../search.html rel=search title=Search><link href=cpp.html rel=next title=C++><link href=../../compilation.html rel=prev title=Compilation><link href=../../_static/stylesheets/theme.css rel=stylesheet><body data-md-color-accent=cyan data-md-color-primary=blue dir=ltr><nav class="navbar navbar-expand-lg navbar-light bg-white border-bottom fixed-top" role=navigation><a class=navbar-brand href=../../index.html>LIEF Documentation</a><button class=navbar-toggler data-target=#navbar-collapse data-toggle=collapse><span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse justify-content-center mt-2 mt-lg-0" id=navbar-collapse><ul class="navbar-nav position-relative px-lg-6 px-xl-8"><li class=nav-item><a class=nav-link href=https://lief.re> <i class="fa-solid fa-house mr-3"></i>Home </a><li class=nav-item><a class=nav-link href=https://lief.re/blog> <i class="fa-solid fa-rss mr-3"></i>Blog </a><li class=nav-item><a class=nav-link href=https://lief.re/download> <i class="fa-solid fa-download mr-3"></i>Download </a><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" aria-expanded=false data-toggle=dropdown href=# role=button> <i class="fa-solid fa-book mr-3"></i>Documentation </a> <div class=dropdown-menu role=menu><a class=dropdown-item href=https://lief.re/doc/stable/doxygen>Doxygen</a></div><li class=nav-item><a class=nav-link href=https://lief.re/about> <i class="fa-solid fa-bars-staggered mr-3"></i>About </a><li class="nav-item ml-lg-3 mt-3 mt-lg-0"><a class="hover-lift-light mt-1" href=https://discord.gg/jGQtyAYChJ target=_blank> <i class="fab fa-2x fa-discord text-darkblue mr-3"></i> </a><li class=nav-item><a class="btn btn-outline-pink" href=https://github.com/sponsors/lief-project target=_blank> <i class="fa-solid fa-heart mr-3"></i> Sponsor </a></ul></div></nav><div class="container-fluid container-docs"><div class=row><div class="col-12 col-lg-3 col-xl-2 border-lg-right py-lg-5 pl-lg-4 docs-sidebar docs-sidebar-left"><div class="collapse d-lg-block mb-6 mb-lg-0" id=sidebar-collapse><form action=../../search.html method=GET name=search><input autocapitalize=off autocomplete=off class=form-control data-md-component=query data-md-state=active name=q placeholder=Search spellcheck=false></form><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2" href=../../intro.html><em class="fa fa-solid fa-door-open"></em> Introduction</a></ul><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2" href=../../installation.html><em class="fa fa-solid fa-gears"></em> Installation and Integration</a></ul><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2" href=../../compilation.html><em class="fa fa-solid fa-laptop-code"></em> Compilation</a></ul><div class="text-darkblue text-uppercase font-size-normal font-weight-bolder mt-4 pt-2 mb-2"><span class=caption-text><i class="fa-solid fa-sitemap"> </i>Formats</span></div><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2" href=#><em class="fa fa-brands fa-linux"></em> ELF</a></ul><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2" href=../macho/index.html><em class="fa fa-brands fa-apple"></em> Mach-O</a></ul><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2" href=../pe/index.html><em class="fa fa-brands fa-windows"></em> PE</a></ul><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2" href=../coff/index.html><em class="fa fa-brands fa-windows"></em> COFF</a></ul><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2" href=../android/index.html><em class="fa fa-brands fa-android"></em> Android</a></ul><div class="text-darkblue text-uppercase font-size-normal font-weight-bolder mt-4 pt-2 mb-2"><span class=caption-text><i class="fa-solid fa-code"> </i>API</span></div><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2" href=../../api/binary_abstraction/index.html><em class="fa fa-brands fa-uncharted"></em> Binary Abstraction</a></ul><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2" href=../../api/utilities/index.html><em class="fa fa-solid fa-hand-holding-hand"></em> Utilities</a></ul><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2" href=../../api/error_handling/index.html><em class="fa fa-solid fa-triangle-exclamation"></em> Error Handling</a></ul><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2" href=../../api/logging/index.html><em class="fa fa-regular fa-rectangle-list"></em> Logging</a></ul><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2" href=../../api/cpp/index.html><em class="fa fa-regular fa-file-code"></em> C++</a></ul><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2" href=../../api/rust/index.html><em class="fa fa-brands fa-rust"></em> Rust</a></ul><div class="text-darkblue text-uppercase font-size-normal font-weight-bolder mt-4 pt-2 mb-2"><span class=caption-text><i class="fa-solid fa-hat-wizard"> </i>LIEF Extended</span></div><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2" href=../../extended/intro.html><em class="fa fa-cubes"></em> What is LIEF Extended?</a></ul><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2" href=../../extended/debug_info/index.html><em class="fa fa-solid fa-magnifying-glass"></em> Debug Info</a></ul><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2" href=../../extended/dwarf/index.html><em class="fa fa-solid fa-bars-staggered"></em> DWARF</a></ul><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2" href=../../extended/pdb/index.html><em class="fa fa-brands fa-windows"></em> PDB</a></ul><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2" href=../../extended/objc/index.html><em class="fa fa-brands fa-apple"></em> Objective-C</a></ul><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2" href=../../extended/dsc/index.html><em class="fa fa-solid fa-diagram-predecessor"></em> Dyld Shared Cache</a></ul><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2" href=../../extended/disassembler/index.html><em class="fa fa-solid fa-dna"></em> Disassembler</a></ul><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2" href=../../extended/assembler/index.html><em class="fa fa-solid fa-user-secret"></em> Assembler</a></ul><div class="text-darkblue text-uppercase font-size-normal font-weight-bolder mt-4 pt-2 mb-2"><span class=caption-text><i class="fa-solid fa-puzzle-piece"> </i>Plugins</span></div><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2" href=../../plugins/ghidra/index.html><em class="fa fa-solid fa-dragon"></em> Ghidra</a></ul><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2" href=../../plugins/binaryninja/index.html><em class="fa fa-solid fa-user-ninja"></em> BinaryNinja</a></ul><div class="text-darkblue text-uppercase font-size-normal font-weight-bolder mt-4 pt-2 mb-2"><span class=caption-text><i class="fa-solid fa-toolbox"> </i>Tools</span></div><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2" href=../../tools/lief-patchelf/index.html><em class="fa fa-solid fa-screwdriver-wrench"></em> lief-patchelf</a></ul><div class="text-darkblue text-uppercase font-size-normal font-weight-bolder mt-4 pt-2 mb-2"><span class=caption-text><i class="fa-solid fa-layer-group"> </i>Tutorials</span></div><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2" href=../../tutorials/01_play_with_formats.html>01 - Parse and manipulate formats</a></ul><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2" href=../../tutorials/02_pe_from_scratch.html>02 - Create a PE from scratch (Deprecated)</a></ul><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2" href=../../tutorials/03_elf_change_symbols.html>03 - Play with ELF symbols</a></ul><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2" href=../../tutorials/04_elf_hooking.html>04 - ELF Hooking</a></ul><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2" href=../../tutorials/05_elf_infect_plt_got.html>05 - Infecting the plt/got</a></ul><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2" href=../../tutorials/06_pe_hooking.html>06 - PE Hooking (Deprecated)</a></ul><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2" href=../../tutorials/07_pe_resource.html>07 - PE Resources</a></ul><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2" href=../../tutorials/08_elf_bin2lib.html>08 - Transforming an ELF executable into a library</a></ul><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2" href=../../tutorials/09_frida_lief.html>09 - How to use frida on a non-rooted device</a></ul><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2" href=../../tutorials/10_android_formats.html>10 - Android formats</a></ul><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2" href=../../tutorials/11_macho_modification.html>11 - Mach-O Modification</a></ul><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2" href=../../tutorials/12_elf_coredump.html>12 - ELF Coredump</a></ul><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2" href=../../tutorials/13_pe_authenticode.html>13 - PE Authenticode</a></ul><div class="text-darkblue text-uppercase font-size-normal font-weight-bolder mt-4 pt-2 mb-2"><span class=caption-text><i class="fa-brands fa-space-awesome"> </i>Extra Information</span></div><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2" href=../../references.html><em class="fa fa-fa-solid fa-book-bookmark"></em> References</a></ul><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2" href=../../changelog.html><em class="fa fa-solid fa-code-compare"></em> Changelog</a></ul></div><hr><span class="svg-icon text-purple mr-1 relative-top--1"> <svg viewbox="0 0 512 512" height=512 width=512 xmlns=http://www.w3.org/2000/svg><title>ionicons-v5-d</title><circle cx=160 cy=96 r=48 style=fill:none;stroke:#000;stroke-linecap:round;stroke-linejoin:round;stroke-width:32px></circle><circle cx=160 cy=416 r=48 style=fill:none;stroke:#000;stroke-linecap:round;stroke-linejoin:round;stroke-width:32px></circle><line style=fill:none;stroke:#000;stroke-linecap:round;stroke-linejoin:round;stroke-width:32px x1=160 x2=160 y1=368 y2=144></line><circle cx=352 cy=160 r=48 style=fill:none;stroke:#000;stroke-linecap:round;stroke-linejoin:round;stroke-width:32px></circle><path d=M352,208c0,128-192,48-192,160 style=fill:none;stroke:#000;stroke-linecap:round;stroke-linejoin:round;stroke-width:32px></path></svg> </span><a class=text-darkblue href=https://github.com/lief-project/LIEF/commits/45d0e6cd>0.17.4 (45d0e6cd)</a><br> Updated on 21/02/2026, 09:14:24.</div><div class="col-12 col-lg-9 col-xl-8 offset-lg-3 offset-xl-2 py-lg-5 px-lg-6 mb-8"><nav aria-label=breadcrumb><ol class=breadcrumb><li class=breadcrumb-item><a aria-label=Home href=../../index.html><i class="fa-solid fa-home"></i></a><li class="breadcrumb-item active" aria-current=page><a href=#><em class="fa fa-brands fa-linux"></em> ELF</a></ol></nav><section id=elf><span id=format-elf></span><h1 id=formats-elf-index--page-root><em class="fa fa-brands fa-linux"></em> ELF<a title="Link to this heading" class=headerlink href=#formats-elf-index--page-root>¶</a></h1><div class="toctree-wrapper compound"><p class=caption role=heading><span class=caption-text><i class="fa-solid fa-code"> </i>API</span><ul><li class=toctree-l1><a class="reference internal" href=cpp.html><em class="fa fa-regular fa-file-code"></em> C++</a><li class=toctree-l1><a class="reference internal" href=python.html><em class="fa fa-brands fa-python"></em> Python</a><li class=toctree-l1><a class="reference internal" href=rust.html><em class="fa fa-brands fa-rust"></em> Rust</a></ul></div><hr class=docutils><section id=introduction><h2 id=introduction>Introduction<a title="Link to this heading" class=headerlink href=#introduction>¶</a></h2><div class=fixed-paragraph>ELF binaries can be parsed with LIEF using the <div class=dropdown style=display:inline;><a aria-expanded=false aria-haspopup=true data-toggle=dropdown href=# id=lief-api-lief-ELF-parse role=button> <code><span class=pre>lief.ELF.parse()</span></code></a><div aria-labelledby=lief-api-lief-ELF-parse class=dropdown-menu><a class=dropdown-item href=https://lief.re/doc/stable/rust/lief/elf/struct.Binary.html#method.parse> <code class="xref rust rust-method"><span class=pre><i class="fa fa-brands fa-rust"></i> lief::elf::Binary::parse</span></code> </a><a class=dropdown-item href=python.html#lief.ELF.parse> <code class="xref py py-func"><span class=pre><i class="fa fa-brands fa-python"></i> lief.ELF.parse()</span></code> </a><a class=dropdown-item href=cpp.html#_CPPv4N4LIEF3ELF6Parser5parseERKNSt6stringERK12ParserConfig> <code class="xref cpp cpp-func"><span class=pre><i class="fa fa-regular fa-file-code"></i> LIEF::ELF::Parser::parse()</span></code> </a></div></div> function:</div><div class="sphinx-tabs docutils container"><div aria-label="Tabbed content" class=closeable role=tablist><button aria-controls=panel-0-0-0 aria-selected=true class=sphinx-tabs-tab id=tab-0-0-0 name=0-0 role=tab tabindex=0><em class="fa fa-brands fa-python"></em> Python</button><button aria-controls=panel-0-0-1 aria-selected=false class=sphinx-tabs-tab id=tab-0-0-1 name=0-1 role=tab tabindex=-1><em class="fa fa-regular fa-file-code"></em> C++</button><button aria-controls=panel-0-0-2 aria-selected=false class=sphinx-tabs-tab id=tab-0-0-2 name=0-2 role=tab tabindex=-1><em class="fa fa-brands fa-rust"></em> Rust</button></div><div aria-labelledby=tab-0-0-0 class=sphinx-tabs-panel id=panel-0-0-0 name=0-0 role=tabpanel tabindex=0><div class="highlight-python notranslate"><div class=highlight><pre><span></span><span class=kn>import</span><span class=w> </span><span class=nn>lief</span>

<span class=c1># Using filepath</span>
<span class=n>elf</span><span class=p>:</span> <span class=n>lief</span><span class=o>.</span><span class=n>ELF</span><span class=o>.</span><span class=n>Binary</span> <span class=o>=</span> <span class=n>lief</span><span class=o>.</span><span class=n>ELF</span><span class=o>.</span><span class=n>parse</span><span class=p>(</span><span class=s2>"/bin/ls"</span><span class=p>)</span>

<span class=c1># Using a Path from pathlib</span>
<span class=n>elf</span><span class=p>:</span> <span class=n>lief</span><span class=o>.</span><span class=n>ELF</span><span class=o>.</span><span class=n>Binary</span> <span class=o>=</span> <span class=n>lief</span><span class=o>.</span><span class=n>ELF</span><span class=o>.</span><span class=n>parse</span><span class=p>(</span><span class=n>pathlib</span><span class=o>.</span><span class=n>Path</span><span class=p>(</span><span class=sa>r</span><span class=s2>"C:\Users\test.elf"</span><span class=p>))</span>

<span class=c1># Using a io object</span>
<span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s2>"/bin/ssh"</span><span class=p>,</span> <span class=s1>'rb'</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
  <span class=n>elf</span><span class=p>:</span> <span class=n>lief</span><span class=o>.</span><span class=n>ELF</span><span class=o>.</span><span class=n>Binary</span> <span class=o>=</span> <span class=n>lief</span><span class=o>.</span><span class=n>ELF</span><span class=o>.</span><span class=n>parse</span><span class=p>(</span><span class=n>f</span><span class=p>)</span>
</pre></div></div></div><div aria-labelledby=tab-0-0-1 class=sphinx-tabs-panel hidden id=panel-0-0-1 name=0-1 role=tabpanel tabindex=0><div class="highlight-cpp notranslate"><div class=highlight><pre><span></span><span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;LIEF/ELF.hpp></span>

<span class=c1>// Using a file path as a std::string</span>
<span class=n>std</span><span class=o>::</span><span class=n>unique_ptr</span><span class=o>&lt;</span><span class=n>LIEF</span><span class=o>::</span><span class=n>ELF</span><span class=o>::</span><span class=n>Binary</span><span class=o>></span><span class=w> </span><span class=n>elf</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>LIEF</span><span class=o>::</span><span class=n>ELF</span><span class=o>::</span><span class=n>Parser</span><span class=o>::</span><span class=n>parse</span><span class=p>(</span><span class=s>"/bin/ls"</span><span class=p>);</span>

<span class=c1>// Using a vector</span>
<span class=n>std</span><span class=o>::</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>uint8_t</span><span class=o>></span><span class=w> </span><span class=n>my_raw_elf</span><span class=p>;</span>
<span class=n>std</span><span class=o>::</span><span class=n>unique_ptr</span><span class=o>&lt;</span><span class=n>LIEF</span><span class=o>::</span><span class=n>ELF</span><span class=o>::</span><span class=n>Binary</span><span class=o>></span><span class=w> </span><span class=n>elf</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>LIEF</span><span class=o>::</span><span class=n>ELF</span><span class=o>::</span><span class=n>Parser</span><span class=o>::</span><span class=n>parse</span><span class=p>(</span><span class=n>my_raw_elf</span><span class=p>);</span>
</pre></div></div></div><div aria-labelledby=tab-0-0-2 class=sphinx-tabs-panel hidden id=panel-0-0-2 name=0-2 role=tabpanel tabindex=0><div class="highlight-rust notranslate"><div class=highlight><pre><span></span><span class=kd>let</span><span class=w> </span><span class=n>elf</span><span class=p>:</span><span class=w> </span><span class=nc>lief</span><span class=p>::</span><span class=n>elf</span><span class=p>::</span><span class=n>Binary</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>lief</span><span class=p>::</span><span class=n>elf</span><span class=p>::</span><span class=n>Binary</span><span class=p>::</span><span class=n>parse</span><span class=p>(</span><span class=s>"/bin/ls"</span><span class=p>);</span>
</pre></div></div></div></div><div class="admonition note"><p class=admonition-title>Note<p>In Python, you can also use <a class="reference internal" href=../../api/binary_abstraction/python.html#lief.parse title=lief.parse><code class="xref py py-func docutils literal notranslate"><span class=pre>lief.parse()</span></code></a> which returns a <a class="reference internal" href=python.html#lief.ELF.Binary title=lief.ELF.Binary><code class="xref py py-class docutils literal notranslate"><span class=pre>lief.ELF.Binary</span></code></a> object.</div><div class=fixed-paragraph>From this parsed ELF binary you can use all the API exposed by the <div class=dropdown style=display:inline;><a aria-expanded=false aria-haspopup=true data-toggle=dropdown href=# id=lief-api-lief-ELF-Binary role=button> <code><span class=pre>lief.ELF.Binary</span></code></a><div aria-labelledby=lief-api-lief-ELF-Binary class=dropdown-menu><a class=dropdown-item href=https://lief.re/doc/stable/rust/lief/elf/struct.Binary.html> <code class="xref rust rust-struct"><span class=pre><i class="fa fa-brands fa-rust"></i> lief::elf::Binary</span></code> </a><a class=dropdown-item href=python.html#lief.ELF.Binary> <code class="xref py py-class"><span class=pre><i class="fa fa-brands fa-python"></i> lief.ELF.Binary</span></code> </a><a class=dropdown-item href=cpp.html#_CPPv4N4LIEF3ELF6BinaryE> <code class="xref cpp cpp-class"><span class=pre><i class="fa fa-regular fa-file-code"></i> LIEF::ELF::Binary</span></code> </a></div></div> object to inspect or modify the binary itself.</div><div class="sphinx-tabs docutils container"><div aria-label="Tabbed content" class=closeable role=tablist><button aria-controls=panel-1-1-0 aria-selected=true class=sphinx-tabs-tab id=tab-1-1-0 name=1-0 role=tab tabindex=0><em class="fa fa-brands fa-python"></em> Python</button><button aria-controls=panel-1-1-1 aria-selected=false class=sphinx-tabs-tab id=tab-1-1-1 name=1-1 role=tab tabindex=-1><em class="fa fa-regular fa-file-code"></em> C++</button><button aria-controls=panel-1-1-2 aria-selected=false class=sphinx-tabs-tab id=tab-1-1-2 name=1-2 role=tab tabindex=-1><em class="fa fa-brands fa-rust"></em> Rust</button></div><div aria-labelledby=tab-1-1-0 class=sphinx-tabs-panel id=panel-1-1-0 name=1-0 role=tabpanel tabindex=0><div class="highlight-python notranslate"><div class=highlight><pre><span></span><span class=n>elf</span><span class=p>:</span> <span class=n>lief</span><span class=o>.</span><span class=n>ELF</span><span class=o>.</span><span class=n>Binary</span> <span class=o>=</span> <span class=o>...</span>

<span class=nb>print</span><span class=p>(</span><span class=n>elf</span><span class=o>.</span><span class=n>header</span><span class=o>.</span><span class=n>entrypoint</span><span class=p>)</span>

<span class=k>for</span> <span class=n>section</span> <span class=ow>in</span> <span class=n>elf</span><span class=o>.</span><span class=n>sections</span><span class=p>:</span>
    <span class=nb>print</span><span class=p>(</span><span class=n>section</span><span class=o>.</span><span class=n>name</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>section</span><span class=o>.</span><span class=n>content</span><span class=p>))</span>
</pre></div></div></div><div aria-labelledby=tab-1-1-1 class=sphinx-tabs-panel hidden id=panel-1-1-1 name=1-1 role=tabpanel tabindex=0><div class="highlight-cpp notranslate"><div class=highlight><pre><span></span><span class=n>std</span><span class=o>::</span><span class=n>unique_ptr</span><span class=o>&lt;</span><span class=n>LIEF</span><span class=o>::</span><span class=n>ELF</span><span class=o>::</span><span class=n>Binary</span><span class=o>></span><span class=w> </span><span class=n>elf</span><span class=p>;</span>

<span class=n>std</span><span class=o>::</span><span class=n>cout</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>elf</span><span class=o>-></span><span class=n>header</span><span class=p>().</span><span class=n>entrypoint</span><span class=p>();</span>

<span class=k>for</span><span class=w> </span><span class=p>(</span><span class=k>const</span><span class=w> </span><span class=n>LIEF</span><span class=o>::</span><span class=n>ELF</span><span class=o>::</span><span class=n>Section</span><span class=o>&</span><span class=w> </span><span class=n>section</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>elf</span><span class=o>-></span><span class=n>sections</span><span class=p>())</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=n>std</span><span class=o>::</span><span class=n>cout</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>section</span><span class=p>.</span><span class=n>name</span><span class=p>()</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>section</span><span class=p>.</span><span class=n>content</span><span class=p>().</span><span class=n>size</span><span class=p>()</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=sc>'\n'</span>
<span class=p>}</span>
</pre></div></div></div><div aria-labelledby=tab-1-1-2 class=sphinx-tabs-panel hidden id=panel-1-1-2 name=1-2 role=tabpanel tabindex=0><div class="highlight-rust notranslate"><div class=highlight><pre><span></span><span class=kd>let</span><span class=w> </span><span class=n>elf</span><span class=p>:</span><span class=w> </span><span class=nc>lief</span><span class=p>::</span><span class=n>elf</span><span class=p>::</span><span class=n>Binary</span><span class=p>;</span>

<span class=fm>println!</span><span class=p>(</span><span class=s>"{}"</span><span class=p>,</span><span class=w> </span><span class=n>elf</span><span class=p>.</span><span class=n>header</span><span class=p>().</span><span class=n>entrypoint</span><span class=p>());</span>

<span class=k>for</span><span class=w> </span><span class=n>section</span><span class=w> </span><span class=k>in</span><span class=w> </span><span class=n>elf</span><span class=p>.</span><span class=n>sections</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>"{} {}"</span><span class=p>,</span><span class=w> </span><span class=n>section</span><span class=p>.</span><span class=n>name</span><span class=p>(),</span><span class=w> </span><span class=n>section</span><span class=p>.</span><span class=n>content</span><span class=p>().</span><span class=n>len</span><span class=p>());</span>
<span class=p>}</span>
</pre></div></div></div></div><div class=fixed-paragraph>Upon a <div class=dropdown style=display:inline;><a aria-expanded=false aria-haspopup=true data-toggle=dropdown href=# id=lief-api-lief-ELF-Binary role=button> <code><span class=pre>lief.ELF.Binary</span></code></a><div aria-labelledby=lief-api-lief-ELF-Binary class=dropdown-menu><a class=dropdown-item href=https://lief.re/doc/stable/rust/lief/elf/struct.Binary.html> <code class="xref rust rust-struct"><span class=pre><i class="fa fa-brands fa-rust"></i> lief::elf::Binary</span></code> </a><a class=dropdown-item href=python.html#lief.ELF.Binary> <code class="xref py py-class"><span class=pre><i class="fa fa-brands fa-python"></i> lief.ELF.Binary</span></code> </a><a class=dropdown-item href=cpp.html#_CPPv4N4LIEF3ELF6BinaryE> <code class="xref cpp cpp-class"><span class=pre><i class="fa fa-regular fa-file-code"></i> LIEF::ELF::Binary</span></code> </a></div></div> modification, one can use the method <div class=dropdown style=display:inline;><a aria-expanded=false aria-haspopup=true data-toggle=dropdown href=# id=lief-api-lief-ELF-Binary-write role=button> <code><span class=pre>lief.ELF.Binary.write()</span></code></a><div aria-labelledby=lief-api-lief-ELF-Binary-write class=dropdown-menu><a class=dropdown-item href=https://lief.re/doc/stable/rust/lief/elf/struct.Binary.html#method.write> <code class="xref rust rust-method"><span class=pre><i class="fa fa-brands fa-rust"></i> lief::elf::Binary::write</span></code> </a><a class=dropdown-item href=https://lief.re/doc/stable/rust/lief/elf/struct.Binary.html#method.write_with_config> <code class="xref rust rust-method"><span class=pre><i class="fa fa-brands fa-rust"></i> lief::elf::Binary::write_with_config</span></code> </a><a class=dropdown-item href=python.html#lief.ELF.Binary.write> <code class="xref py py-meth"><span class=pre><i class="fa fa-brands fa-python"></i> lief.ELF.Binary.write()</span></code> </a><a class=dropdown-item href=cpp.html#_CPPv4N4LIEF3ELF6Binary5writeERKNSt6stringE> <code class="xref cpp cpp-func"><span class=pre><i class="fa fa-regular fa-file-code"></i> LIEF::ELF::Binary::write()</span></code> </a></div></div> to write back the ELF binary object into a raw ELF file.</div><div class="sphinx-tabs docutils container"><div aria-label="Tabbed content" class=closeable role=tablist><button aria-controls=panel-2-2-0 aria-selected=true class=sphinx-tabs-tab id=tab-2-2-0 name=2-0 role=tab tabindex=0><em class="fa fa-brands fa-python"></em> Python</button><button aria-controls=panel-2-2-1 aria-selected=false class=sphinx-tabs-tab id=tab-2-2-1 name=2-1 role=tab tabindex=-1><em class="fa fa-regular fa-file-code"></em> C++</button></div><div aria-labelledby=tab-2-2-0 class=sphinx-tabs-panel id=panel-2-2-0 name=2-0 role=tabpanel tabindex=0><div class="highlight-python notranslate"><div class=highlight><pre><span></span><span class=n>elf</span><span class=p>:</span> <span class=n>lief</span><span class=o>.</span><span class=n>ELF</span><span class=o>.</span><span class=n>Binary</span> <span class=o>=</span> <span class=o>...</span>

<span class=n>elf</span><span class=o>.</span><span class=n>add_library</span><span class=p>(</span><span class=s2>"libdemo.so"</span><span class=p>)</span>
<span class=n>elf</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=s2>"new.elf"</span><span class=p>)</span>
</pre></div></div></div><div aria-labelledby=tab-2-2-1 class=sphinx-tabs-panel hidden id=panel-2-2-1 name=2-1 role=tabpanel tabindex=0><div class="highlight-cpp notranslate"><div class=highlight><pre><span></span><span class=n>std</span><span class=o>::</span><span class=n>unique_ptr</span><span class=o>&lt;</span><span class=n>LIEF</span><span class=o>::</span><span class=n>ELF</span><span class=o>::</span><span class=n>Binary</span><span class=o>></span><span class=w> </span><span class=n>elf</span><span class=p>;</span>
<span class=n>elf</span><span class=o>-></span><span class=n>add_library</span><span class=p>(</span><span class=s>"libdemo.so"</span><span class=p>);</span>
<span class=n>elf</span><span class=o>-></span><span class=n>write</span><span class=p>(</span><span class=s>"new.elf"</span><span class=p>);</span>
</pre></div></div></div></div><div class="admonition seealso"><p class=admonition-title>See also<p><a class="reference internal" href=../../api/binary_abstraction/index.html#binary-abstraction><span class="std std-ref"> Binary Abstraction</span></a></div><div class=fixed-paragraph>You can also use <div class=dropdown style=display:inline;><a aria-expanded=false aria-haspopup=true data-toggle=dropdown href=# id=lief-api-lief-ELF-Binary-write_to_bytes role=button> <code><span class=pre>lief.ELF.Binary.write_to_bytes()</span></code></a><div aria-labelledby=lief-api-lief-ELF-Binary-write_to_bytes class=dropdown-menu><a class=dropdown-item href=python.html#lief.ELF.Binary.write_to_bytes> <code class="xref py py-meth"><span class=pre><i class="fa fa-brands fa-python"></i> lief.ELF.Binary.write_to_bytes()</span></code> </a><a class=dropdown-item href=cpp.html#_CPPv4N4LIEF3ELF6Binary5writeERNSt7ostreamE> <code class="xref cpp cpp-func"><span class=pre><i class="fa fa-regular fa-file-code"></i> std::unique_ptr<builder> LIEF::ELF::Binary::write(std::ostream &)</builder></span></code> </a><a class=dropdown-item href=cpp.html#_CPPv4N4LIEF3ELF6Binary5writeERNSt7ostreamERKN7Builder8config_tE> <code class="xref cpp cpp-func"><span class=pre><i class="fa fa-regular fa-file-code"></i> std::unique_ptr<builder> LIEF::ELF::Binary::write(std::ostream &, const Builder::config_t &)</builder></span></code> </a></div></div> to get the new ELF binary as a buffer of bytes:</div><div class="admonition note"><p class=admonition-title>Note<div class=fixed-paragraph>This API can also take an extra <div class=dropdown style=display:inline;><a aria-expanded=false aria-haspopup=true data-toggle=dropdown href=# id=lief-api-lief-ELF-Builder-config_t role=button> <code><span class=pre>lief.ELF.Builder.config_t</span></code></a><div aria-labelledby=lief-api-lief-ELF-Builder-config_t class=dropdown-menu><a class=dropdown-item href=python.html#lief.ELF.Builder.config_t> <code class="xref py py-class"><span class=pre><i class="fa fa-brands fa-python"></i> lief.ELF.Builder.config_t</span></code> </a><a class=dropdown-item href=cpp.html#_CPPv4N4LIEF3ELF7Builder8config_tE> <code class="xref cpp cpp-struct"><span class=pre><i class="fa fa-regular fa-file-code"></i> LIEF::ELF::Builder::config_t</span></code> </a></div></div> parameter</div></div><div class="sphinx-tabs docutils container"><div aria-label="Tabbed content" class=closeable role=tablist><button aria-controls=panel-3-3-0 aria-selected=true class=sphinx-tabs-tab id=tab-3-3-0 name=3-0 role=tab tabindex=0><em class="fa fa-brands fa-python"></em> Python</button><button aria-controls=panel-3-3-1 aria-selected=false class=sphinx-tabs-tab id=tab-3-3-1 name=3-1 role=tab tabindex=-1><em class="fa fa-regular fa-file-code"></em> C++</button></div><div aria-labelledby=tab-3-3-0 class=sphinx-tabs-panel id=panel-3-3-0 name=3-0 role=tabpanel tabindex=0><div class="highlight-python notranslate"><div class=highlight><pre><span></span><span class=n>elf</span><span class=p>:</span> <span class=n>lief</span><span class=o>.</span><span class=n>ELF</span><span class=o>.</span><span class=n>Binary</span> <span class=o>=</span> <span class=o>...</span>
<span class=n>new_elf</span><span class=p>:</span> <span class=nb>bytes</span> <span class=o>=</span> <span class=n>elf</span><span class=o>.</span><span class=n>write_to_bytes</span><span class=p>()</span>
</pre></div></div></div><div aria-labelledby=tab-3-3-1 class=sphinx-tabs-panel hidden id=panel-3-3-1 name=3-1 role=tabpanel tabindex=0><div class="highlight-cpp notranslate"><div class=highlight><pre><span></span><span class=n>std</span><span class=o>::</span><span class=n>unique_ptr</span><span class=o>&lt;</span><span class=n>LIEF</span><span class=o>::</span><span class=n>ELF</span><span class=o>::</span><span class=n>Binary</span><span class=o>></span><span class=w> </span><span class=n>elf</span><span class=p>;</span>

<span class=n>std</span><span class=o>::</span><span class=n>ostringstream</span><span class=w> </span><span class=n>os</span><span class=p>;</span>
<span class=n>elf</span><span class=o>-></span><span class=n>write</span><span class=p>(</span><span class=n>os</span><span class=p>);</span>
<span class=n>std</span><span class=o>::</span><span class=n>string</span><span class=w> </span><span class=n>buffer</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>os</span><span class=p>.</span><span class=n>str</span><span class=p>();</span>

<span class=k>const</span><span class=w> </span><span class=k>auto</span><span class=o>*</span><span class=w> </span><span class=n>start</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>reinterpret_cast</span><span class=o>&lt;</span><span class=k>const</span><span class=w> </span><span class=kt>uint8_t</span><span class=o>></span><span class=p>(</span><span class=n>buffer</span><span class=p>.</span><span class=n>data</span><span class=p>());</span>
<span class=kt>size_t</span><span class=w> </span><span class=n>size</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>buffer</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
</pre></div></div></div></div></section><section id=adding-a-section-segment><span id=format-elf-section-segment></span><h2 id=adding-a-section-segment>Adding a Section/Segment<a title="Link to this heading" class=headerlink href=#adding-a-section-segment>¶</a></h2><p>The ELF format uses two tables to represent the different slices of the binary:<ol class="arabic simple"><li><p>The sections table<li><p>The segments table</ol><p>While the sections table offers a detailed view of the binary, it is primarily needed by the <strong>compiler</strong> and the <strong>linker</strong>. In particular, this table is not required for <strong>loading</strong> and <strong>executing</strong> an ELF file. The Android loader enforces the existence of a sections table and requires certain specific sections but from a loading perspective, this table is not used.<div class=fixed-paragraph>If you intend to modify an ELF file to load additional content into memory (such as code or data), it is recommended to add a <div class=dropdown style=display:inline;><a aria-expanded=false aria-haspopup=true data-toggle=dropdown href=# id=lief-api-lief-ELF-Segment role=button> <code><span class=pre>lief.ELF.Segment</span></code></a><div aria-labelledby=lief-api-lief-ELF-Segment class=dropdown-menu><a class=dropdown-item href=https://lief.re/doc/stable/rust/lief/elf/struct.Segment.html> <code class="xref rust rust-struct"><span class=pre><i class="fa fa-brands fa-rust"></i> lief::elf::Segment</span></code> </a><a class=dropdown-item href=python.html#lief.ELF.Segment> <code class="xref py py-class"><span class=pre><i class="fa fa-brands fa-python"></i> lief.ELF.Segment</span></code> </a><a class=dropdown-item href=cpp.html#_CPPv4N4LIEF3ELF7SegmentE> <code class="xref cpp cpp-class"><span class=pre><i class="fa fa-regular fa-file-code"></i> LIEF::ELF::Segment</span></code> </a></div></div> instead of a section:</div><div class="sphinx-tabs docutils container"><div aria-label="Tabbed content" class=closeable role=tablist><button aria-controls=panel-4-4-0 aria-selected=true class=sphinx-tabs-tab id=tab-4-4-0 name=4-0 role=tab tabindex=0><em class="fa fa-brands fa-python"></em> Python</button><button aria-controls=panel-4-4-1 aria-selected=false class=sphinx-tabs-tab id=tab-4-4-1 name=4-1 role=tab tabindex=-1><em class="fa fa-regular fa-file-code"></em> C++</button></div><div aria-labelledby=tab-4-4-0 class=sphinx-tabs-panel id=panel-4-4-0 name=4-0 role=tabpanel tabindex=0><div class="highlight-python notranslate"><div class=highlight><pre><span></span><span class=n>elf</span><span class=p>:</span> <span class=n>lief</span><span class=o>.</span><span class=n>ELF</span><span class=o>.</span><span class=n>Binary</span> <span class=o>=</span> <span class=o>...</span>

<span class=n>segment</span> <span class=o>=</span> <span class=n>lief</span><span class=o>.</span><span class=n>ELF</span><span class=o>.</span><span class=n>Segment</span><span class=p>()</span>
<span class=n>segment</span><span class=o>.</span><span class=n>type</span> <span class=o>=</span> <span class=n>lief</span><span class=o>.</span><span class=n>ELF</span><span class=o>.</span><span class=n>Segment</span><span class=o>.</span><span class=n>TYPES</span><span class=o>.</span><span class=n>LOAD</span>
<span class=n>segment</span><span class=o>.</span><span class=n>content</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=sa>b</span><span class=s1>'Hello World'</span><span class=p>)</span>

<span class=n>new_segment</span><span class=p>:</span> <span class=n>lief</span><span class=o>.</span><span class=n>ELF</span><span class=o>.</span><span class=n>Segment</span> <span class=o>=</span> <span class=n>elf</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>segment</span><span class=p>)</span>

<span class=n>elf</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=s2>"new.elf"</span><span class=p>)</span>
</pre></div></div></div><div aria-labelledby=tab-4-4-1 class=sphinx-tabs-panel hidden id=panel-4-4-1 name=4-1 role=tabpanel tabindex=0><div class="highlight-cpp notranslate"><div class=highlight><pre><span></span><span class=n>std</span><span class=o>::</span><span class=n>unique_ptr</span><span class=o>&lt;</span><span class=n>LIEF</span><span class=o>::</span><span class=n>ELF</span><span class=o>::</span><span class=n>Binary</span><span class=o>></span><span class=w> </span><span class=n>elf</span><span class=p>;</span>

<span class=n>LIEF</span><span class=o>::</span><span class=n>ELF</span><span class=o>::</span><span class=n>Segment</span><span class=w> </span><span class=n>segment</span><span class=p>;</span>
<span class=n>segment</span><span class=p>.</span><span class=n>type</span><span class=p>(</span><span class=n>LIEF</span><span class=o>::</span><span class=n>ELF</span><span class=o>::</span><span class=n>Segment</span><span class=o>::</span><span class=n>TYPES</span><span class=o>::</span><span class=n>LOAD</span><span class=p>);</span>
<span class=n>segment</span><span class=p>.</span><span class=n>content</span><span class=p>({</span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>,</span><span class=w> </span><span class=mi>3</span><span class=p>});</span>

<span class=n>LIEF</span><span class=o>::</span><span class=n>ELF</span><span class=o>::</span><span class=n>Segment</span><span class=o>*</span><span class=w> </span><span class=n>new_segment</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>elf</span><span class=p>.</span><span class=n>add</span><span class=p>(</span><span class=n>segment</span><span class=p>);</span>
<span class=n>elf</span><span class=p>.</span><span class=n>write</span><span class=p>(</span><span class=s>"new.elf"</span><span class=p>);</span>
</pre></div></div></div></div><div class=fixed-paragraph>You can also achieve this modification by creating a <div class=dropdown style=display:inline;><a aria-expanded=false aria-haspopup=true data-toggle=dropdown href=# id=lief-api-lief-ELF-Section role=button> <code><span class=pre>lief.ELF.Section</span></code></a><div aria-labelledby=lief-api-lief-ELF-Section class=dropdown-menu><a class=dropdown-item href=https://lief.re/doc/stable/rust/lief/elf/struct.Section.html> <code class="xref rust rust-struct"><span class=pre><i class="fa fa-brands fa-rust"></i> lief::elf::Section</span></code> </a><a class=dropdown-item href=python.html#lief.ELF.Section> <code class="xref py py-class"><span class=pre><i class="fa fa-brands fa-python"></i> lief.ELF.Section</span></code> </a><a class=dropdown-item href=cpp.html#_CPPv4N4LIEF3ELF7SectionE> <code class="xref cpp cpp-class"><span class=pre><i class="fa fa-regular fa-file-code"></i> LIEF::ELF::Section</span></code> </a></div></div> that will <strong>implicitly</strong> create an associated <code class="docutils literal notranslate"><span class=pre>PT_LOAD</span></code> segment:</div><div class="sphinx-tabs docutils container"><div aria-label="Tabbed content" class=closeable role=tablist><button aria-controls=panel-5-5-0 aria-selected=true class=sphinx-tabs-tab id=tab-5-5-0 name=5-0 role=tab tabindex=0><em class="fa fa-brands fa-python"></em> Python</button><button aria-controls=panel-5-5-1 aria-selected=false class=sphinx-tabs-tab id=tab-5-5-1 name=5-1 role=tab tabindex=-1><em class="fa fa-regular fa-file-code"></em> C++</button></div><div aria-labelledby=tab-5-5-0 class=sphinx-tabs-panel id=panel-5-5-0 name=5-0 role=tabpanel tabindex=0><div class="highlight-python notranslate"><div class=highlight><pre><span></span><span class=n>elf</span><span class=p>:</span> <span class=n>lief</span><span class=o>.</span><span class=n>ELF</span><span class=o>.</span><span class=n>Binary</span> <span class=o>=</span> <span class=o>...</span>

<span class=n>section</span> <span class=o>=</span> <span class=n>lief</span><span class=o>.</span><span class=n>ELF</span><span class=o>.</span><span class=n>Section</span><span class=p>(</span><span class=s2>".lief_demo"</span><span class=p>)</span>
<span class=n>section</span><span class=o>.</span><span class=n>content</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=sa>b</span><span class=s1>'Hello World'</span><span class=p>)</span>

<span class=n>new_section</span><span class=p>:</span> <span class=n>lief</span><span class=o>.</span><span class=n>ELF</span><span class=o>.</span><span class=n>Section</span> <span class=o>=</span> <span class=n>elf</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>section</span><span class=p>,</span> <span class=n>loaded</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>

<span class=n>elf</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=s2>"new.elf"</span><span class=p>)</span>
</pre></div></div></div><div aria-labelledby=tab-5-5-1 class=sphinx-tabs-panel hidden id=panel-5-5-1 name=5-1 role=tabpanel tabindex=0><div class="highlight-cpp notranslate"><div class=highlight><pre><span></span><span class=n>std</span><span class=o>::</span><span class=n>unique_ptr</span><span class=o>&lt;</span><span class=n>LIEF</span><span class=o>::</span><span class=n>ELF</span><span class=o>::</span><span class=n>Binary</span><span class=o>></span><span class=w> </span><span class=n>elf</span><span class=p>;</span>

<span class=n>LIEF</span><span class=o>::</span><span class=n>ELF</span><span class=o>::</span><span class=n>Section</span><span class=w> </span><span class=n>section</span><span class=p>(</span><span class=s>".lief_demo"</span><span class=p>);</span>
<span class=n>section</span><span class=p>.</span><span class=n>content</span><span class=p>({</span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>,</span><span class=w> </span><span class=mi>3</span><span class=p>});</span>

<span class=n>LIEF</span><span class=o>::</span><span class=n>ELF</span><span class=o>::</span><span class=n>Section</span><span class=o>*</span><span class=w> </span><span class=n>new_section</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>elf</span><span class=p>.</span><span class=n>add</span><span class=p>(</span><span class=n>section</span><span class=p>,</span><span class=w> </span><span class=cm>/*loaded=*/</span><span class=nb>true</span><span class=p>);</span>
<span class=n>elf</span><span class=p>.</span><span class=n>write</span><span class=p>(</span><span class=s>"new.elf"</span><span class=p>);</span>
</pre></div></div></div></div><p>As mentioned above, the segments table matters from a loading perspective over the sections table. Therefore, it makes more sense to explicitly add a new segment rather than adding a section that implicitly adds a segment.<p>On the other hand, for debugging purposes or specific tools, one might want to add a <strong>non-loaded</strong> section. In this case, the data of the section is inserted at the end of the binary right after all the data wrapped by the segments:<div class="sphinx-tabs docutils container"><div aria-label="Tabbed content" class=closeable role=tablist><button aria-controls=panel-6-6-0 aria-selected=true class=sphinx-tabs-tab id=tab-6-6-0 name=6-0 role=tab tabindex=0><em class="fa fa-brands fa-python"></em> Python</button><button aria-controls=panel-6-6-1 aria-selected=false class=sphinx-tabs-tab id=tab-6-6-1 name=6-1 role=tab tabindex=-1><em class="fa fa-regular fa-file-code"></em> C++</button></div><div aria-labelledby=tab-6-6-0 class=sphinx-tabs-panel id=panel-6-6-0 name=6-0 role=tabpanel tabindex=0><div class="highlight-python notranslate"><div class=highlight><pre><span></span><span class=n>elf</span><span class=p>:</span> <span class=n>lief</span><span class=o>.</span><span class=n>ELF</span><span class=o>.</span><span class=n>Binary</span> <span class=o>=</span> <span class=o>...</span>

<span class=n>section</span> <span class=o>=</span> <span class=n>lief</span><span class=o>.</span><span class=n>ELF</span><span class=o>.</span><span class=n>Section</span><span class=p>(</span><span class=s2>".metadata"</span><span class=p>)</span>
<span class=n>section</span><span class=o>.</span><span class=n>content</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=sa>b</span><span class=s1>'version: 1.2.3'</span><span class=p>)</span>

<span class=c1># /!\ Note that loaded is set to False here</span>
<span class=c1># ------------------------------------------</span>
<span class=n>new_section</span><span class=p>:</span> <span class=n>lief</span><span class=o>.</span><span class=n>ELF</span><span class=o>.</span><span class=n>Section</span> <span class=o>=</span> <span class=n>elf</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>section</span><span class=p>,</span> <span class=n>loaded</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>

<span class=n>elf</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=s2>"new.elf"</span><span class=p>)</span>
</pre></div></div></div><div aria-labelledby=tab-6-6-1 class=sphinx-tabs-panel hidden id=panel-6-6-1 name=6-1 role=tabpanel tabindex=0><div class="highlight-cpp notranslate"><div class=highlight><pre><span></span><span class=n>std</span><span class=o>::</span><span class=n>unique_ptr</span><span class=o>&lt;</span><span class=n>LIEF</span><span class=o>::</span><span class=n>ELF</span><span class=o>::</span><span class=n>Binary</span><span class=o>></span><span class=w> </span><span class=n>elf</span><span class=p>;</span>

<span class=n>LIEF</span><span class=o>::</span><span class=n>ELF</span><span class=o>::</span><span class=n>Section</span><span class=w> </span><span class=n>section</span><span class=p>(</span><span class=s>".metadata"</span><span class=p>);</span>
<span class=n>section</span><span class=p>.</span><span class=n>content</span><span class=p>({</span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>,</span><span class=w> </span><span class=mi>3</span><span class=p>});</span>

<span class=n>LIEF</span><span class=o>::</span><span class=n>ELF</span><span class=o>::</span><span class=n>Section</span><span class=o>*</span><span class=w> </span><span class=n>new_section</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>elf</span><span class=p>.</span><span class=n>add</span><span class=p>(</span><span class=n>section</span><span class=p>,</span><span class=w> </span><span class=cm>/*loaded=*/</span><span class=nb>false</span><span class=p>);</span>
<span class=n>elf</span><span class=p>.</span><span class=n>write</span><span class=p>(</span><span class=s>"new.elf"</span><span class=p>);</span>
</pre></div></div></div></div><div class=fixed-paragraph>See: <div class=dropdown style=display:inline;><a aria-expanded=false aria-haspopup=true data-toggle=dropdown href=# id=lief-api-lief-ELF-Binary-add role=button> <code><span class=pre>lief.ELF.Binary.add()</span></code></a><div aria-labelledby=lief-api-lief-ELF-Binary-add class=dropdown-menu><a class=dropdown-item href=python.html#lief.ELF.Binary.add> <code class="xref py py-func"><span class=pre><i class="fa fa-brands fa-python"></i> lief.ELF.Binary.add()</span></code> </a><a class=dropdown-item href=cpp.html#_CPPv4N4LIEF3ELF6Binary3addERK12DynamicEntry> <code class="xref cpp cpp-func"><span class=pre><i class="fa fa-regular fa-file-code"></i> LIEF::ELF::Binary::add()</span></code> </a></div></div> for the details about the API</div></section><section id=advance-parsing-writing><h2 id=advance-parsing-writing>Advance Parsing/Writing<a title="Link to this heading" class=headerlink href=#advance-parsing-writing>¶</a></h2><div class=fixed-paragraph><div class=dropdown style=display:inline;><a aria-expanded=false aria-haspopup=true data-toggle=dropdown href=# id=lief-api-lief-ELF-parse role=button> <code><span class=pre>lief.ELF.parse()</span></code></a><div aria-labelledby=lief-api-lief-ELF-parse class=dropdown-menu><a class=dropdown-item href=https://lief.re/doc/stable/rust/lief/elf/struct.Binary.html#method.parse> <code class="xref rust rust-method"><span class=pre><i class="fa fa-brands fa-rust"></i> lief::elf::Binary::parse</span></code> </a><a class=dropdown-item href=python.html#lief.ELF.parse> <code class="xref py py-func"><span class=pre><i class="fa fa-brands fa-python"></i> lief.ELF.parse()</span></code> </a><a class=dropdown-item href=cpp.html#_CPPv4N4LIEF3ELF6Parser5parseERKNSt6stringERK12ParserConfig> <code class="xref cpp cpp-func"><span class=pre><i class="fa fa-regular fa-file-code"></i> LIEF::ELF::Parser::parse()</span></code> </a></div></div> can take an extra <div class=dropdown style=display:inline;><a aria-expanded=false aria-haspopup=true data-toggle=dropdown href=# id=lief-api-lief-ELF-ParserConfig role=button> <code><span class=pre>lief.ELF.ParserConfig</span></code></a><div aria-labelledby=lief-api-lief-ELF-ParserConfig class=dropdown-menu><a class=dropdown-item href=python.html#lief.ELF.ParserConfig> <code class="xref py py-class"><span class=pre><i class="fa fa-brands fa-python"></i> lief.ELF.ParserConfig</span></code> </a><a class=dropdown-item href=cpp.html#_CPPv4N4LIEF3ELF12ParserConfigE> <code class="xref cpp cpp-class"><span class=pre><i class="fa fa-regular fa-file-code"></i> LIEF::ELF::ParserConfig</span></code> </a></div></div> parameter to specify some parts of the ELF format to skip during parsing.</div><div class="admonition warning"><p class=admonition-title>Warning<div class=fixed-paragraph>Generally speaking, <div class=dropdown style=display:inline;><a aria-expanded=false aria-haspopup=true data-toggle=dropdown href=# id=lief-api-lief-ELF-Binary-write role=button> <code><span class=pre>lief.ELF.Binary.write()</span></code></a><div aria-labelledby=lief-api-lief-ELF-Binary-write class=dropdown-menu><a class=dropdown-item href=https://lief.re/doc/stable/rust/lief/elf/struct.Binary.html#method.write> <code class="xref rust rust-method"><span class=pre><i class="fa fa-brands fa-rust"></i> lief::elf::Binary::write</span></code> </a><a class=dropdown-item href=https://lief.re/doc/stable/rust/lief/elf/struct.Binary.html#method.write_with_config> <code class="xref rust rust-method"><span class=pre><i class="fa fa-brands fa-rust"></i> lief::elf::Binary::write_with_config</span></code> </a><a class=dropdown-item href=python.html#lief.ELF.Binary.write> <code class="xref py py-meth"><span class=pre><i class="fa fa-brands fa-python"></i> lief.ELF.Binary.write()</span></code> </a><a class=dropdown-item href=cpp.html#_CPPv4N4LIEF3ELF6Binary5writeERKNSt6stringE> <code class="xref cpp cpp-func"><span class=pre><i class="fa fa-regular fa-file-code"></i> LIEF::ELF::Binary::write()</span></code> </a></div></div> requires a <strong>complete</strong> initial parsing of the ELF file.</div></div><div class=fixed-paragraph>Similarly, <div class=dropdown style=display:inline;><a aria-expanded=false aria-haspopup=true data-toggle=dropdown href=# id=lief-api-lief-ELF-Binary-write role=button> <code><span class=pre>lief.ELF.Binary.write()</span></code></a><div aria-labelledby=lief-api-lief-ELF-Binary-write class=dropdown-menu><a class=dropdown-item href=https://lief.re/doc/stable/rust/lief/elf/struct.Binary.html#method.write> <code class="xref rust rust-method"><span class=pre><i class="fa fa-brands fa-rust"></i> lief::elf::Binary::write</span></code> </a><a class=dropdown-item href=https://lief.re/doc/stable/rust/lief/elf/struct.Binary.html#method.write_with_config> <code class="xref rust rust-method"><span class=pre><i class="fa fa-brands fa-rust"></i> lief::elf::Binary::write_with_config</span></code> </a><a class=dropdown-item href=python.html#lief.ELF.Binary.write> <code class="xref py py-meth"><span class=pre><i class="fa fa-brands fa-python"></i> lief.ELF.Binary.write()</span></code> </a><a class=dropdown-item href=cpp.html#_CPPv4N4LIEF3ELF6Binary5writeERKNSt6stringE> <code class="xref cpp cpp-func"><span class=pre><i class="fa fa-regular fa-file-code"></i> LIEF::ELF::Binary::write()</span></code> </a></div></div> can also take an extra <div class=dropdown style=display:inline;><a aria-expanded=false aria-haspopup=true data-toggle=dropdown href=# id=lief-api-lief-ELF-Builder-config_t role=button> <code><span class=pre>lief.ELF.Builder.config_t</span></code></a><div aria-labelledby=lief-api-lief-ELF-Builder-config_t class=dropdown-menu><a class=dropdown-item href=python.html#lief.ELF.Builder.config_t> <code class="xref py py-class"><span class=pre><i class="fa fa-brands fa-python"></i> lief.ELF.Builder.config_t</span></code> </a><a class=dropdown-item href=cpp.html#_CPPv4N4LIEF3ELF7Builder8config_tE> <code class="xref cpp cpp-struct"><span class=pre><i class="fa fa-regular fa-file-code"></i> LIEF::ELF::Builder::config_t</span></code> </a></div></div> to specify which parts of the ELF should be re-built or not.</div><div class="sphinx-tabs docutils container"><div aria-label="Tabbed content" class=closeable role=tablist><button aria-controls=panel-7-7-0 aria-selected=true class=sphinx-tabs-tab id=tab-7-7-0 name=7-0 role=tab tabindex=0><em class="fa fa-brands fa-python"></em> Python</button><button aria-controls=panel-7-7-1 aria-selected=false class=sphinx-tabs-tab id=tab-7-7-1 name=7-1 role=tab tabindex=-1><em class="fa fa-regular fa-file-code"></em> C++</button></div><div aria-labelledby=tab-7-7-0 class=sphinx-tabs-panel id=panel-7-7-0 name=7-0 role=tabpanel tabindex=0><div class="highlight-python notranslate"><div class=highlight><pre><span></span><span class=n>parser_config</span> <span class=o>=</span> <span class=n>lief</span><span class=o>.</span><span class=n>ELF</span><span class=o>.</span><span class=n>ParserConfig</span><span class=p>()</span>
<span class=n>parser_config</span><span class=o>.</span><span class=n>parse_overlay</span> <span class=o>=</span> <span class=kc>False</span>

<span class=n>elf</span><span class=p>:</span> <span class=n>lief</span><span class=o>.</span><span class=n>ELF</span><span class=o>.</span><span class=n>Binary</span> <span class=o>=</span> <span class=n>lief</span><span class=o>.</span><span class=n>ELF</span><span class=o>.</span><span class=n>parse</span><span class=p>(</span><span class=s2>"my.elf"</span><span class=p>,</span> <span class=n>parser_config</span><span class=p>)</span>

<span class=n>builder_config</span> <span class=o>=</span> <span class=n>lief</span><span class=o>.</span><span class=n>ELF</span><span class=o>.</span><span class=n>Builder</span><span class=o>.</span><span class=n>config_t</span><span class=p>()</span>
<span class=n>builder_config</span><span class=o>.</span><span class=n>gnu_hash</span> <span class=o>=</span> <span class=kc>False</span>

<span class=n>elf</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=s2>"new.elf"</span><span class=p>,</span> <span class=n>builder_config</span><span class=p>)</span>
</pre></div></div></div><div aria-labelledby=tab-7-7-1 class=sphinx-tabs-panel hidden id=panel-7-7-1 name=7-1 role=tabpanel tabindex=0><div class="highlight-cpp notranslate"><div class=highlight><pre><span></span><span class=n>LIEF</span><span class=o>::</span><span class=n>ELF</span><span class=o>::</span><span class=n>ParserConfig</span><span class=w> </span><span class=n>parser_config</span><span class=p>;</span>
<span class=n>parser_config</span><span class=p>.</span><span class=n>parse_overlay</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nb>false</span><span class=p>;</span>

<span class=k>auto</span><span class=w> </span><span class=n>elf</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>LIEF</span><span class=o>::</span><span class=n>ELF</span><span class=o>::</span><span class=n>Parser</span><span class=o>::</span><span class=n>parse</span><span class=p>(</span><span class=s>"my.elf"</span><span class=p>,</span><span class=w> </span><span class=n>parser_config</span><span class=p>);</span>
<span class=n>LIEF</span><span class=o>::</span><span class=n>ELF</span><span class=o>::</span><span class=n>Builder</span><span class=o>::</span><span class=n>config_t</span><span class=w> </span><span class=n>builder_config</span><span class=p>;</span>

<span class=n>builder_config</span><span class=p>.</span><span class=n>gnu_hash</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nb>false</span><span class=p>;</span>
<span class=n>elf</span><span class=o>-></span><span class=n>write</span><span class=p>(</span><span class=s>"new.elf"</span><span class=p>,</span><span class=w> </span><span class=n>builder_config</span><span class=p>);</span>
</pre></div></div></div></div></section><section id=dwarf-support><h2 id=dwarf-support>DWARF Support<a title="Link to this heading" class=headerlink href=#dwarf-support>¶</a></h2><div class=fixed-paragraph>If the binary embeds DWARF debug info, one can use <div class=dropdown style=display:inline;><a aria-expanded=false aria-haspopup=true data-toggle=dropdown href=# id=lief-api-lief-Binary-debug_info role=button> <code><span class=pre>lief.Binary.debug_info()</span></code></a><div aria-labelledby=lief-api-lief-Binary-debug_info class=dropdown-menu><a class=dropdown-item href=https://lief.re/doc/stable/rust/lief/elf/struct.Binary.html#method.debug_info> <code class="xref rust rust-method"><span class=pre><i class="fa fa-brands fa-rust"></i> lief::elf::Binary::debug_info</span></code> </a><a class=dropdown-item href=../../api/binary_abstraction/python.html#lief.Binary.debug_info> <code class="xref py py-attr"><span class=pre><i class="fa fa-brands fa-python"></i> lief.Binary.debug_info</span></code> </a><a class=dropdown-item href=../../api/binary_abstraction/cpp.html#_CPPv4NK4LIEF6Binary10debug_infoEv> <code class="xref cpp cpp-func"><span class=pre><i class="fa fa-regular fa-file-code"></i> LIEF::Binary::debug_info()</span></code> </a></div></div> to access the underlying <div class=dropdown style=display:inline;><a aria-expanded=false aria-haspopup=true data-toggle=dropdown href=# id=lief-api-lief-dwarf-DebugInfo role=button> <code><span class=pre>lief.dwarf.DebugInfo</span></code></a><div aria-labelledby=lief-api-lief-dwarf-DebugInfo class=dropdown-menu><a class=dropdown-item href=https://lief.re/doc/stable/rust/lief/dwarf/struct.DebugInfo.html> <code class="xref rust rust-struct"><span class=pre><i class="fa fa-brands fa-rust"></i> lief::dwarf::DebugInfo</span></code> </a><a class=dropdown-item href=../../extended/dwarf/python.html#lief.dwarf.DebugInfo> <code class="xref py py-class"><span class=pre><i class="fa fa-brands fa-python"></i> lief.dwarf.DebugInfo</span></code> </a><a class=dropdown-item href=../../extended/dwarf/cpp.html#_CPPv4N4LIEF5dwarf9DebugInfoE> <code class="xref cpp cpp-class"><span class=pre><i class="fa fa-regular fa-file-code"></i> LIEF::dwarf::DebugInfo</span></code> </a></div></div> object.</div><p>Note that this support is only available in the <a class="reference internal" href=../../extended/intro.html#extended-intro><span class="std std-ref">extended</span></a> version of LIEF.</section><section id=r-un-path-modification><span id=format-elf-rpath-modification></span><h2 id=r-un-path-modification>R[UN]PATH Modification<a title="Link to this heading" class=headerlink href=#r-un-path-modification>¶</a></h2><p>LIEF provides all the facilities to manipulate binary’s RPATH/RUNPATH.<div class="tip admonition"><p class=admonition-title>DT_RPATH vs DT_RUNPATH<p><code class="docutils literal notranslate"><span class=pre>DT_RPATH</span></code> and <code class="docutils literal notranslate"><span class=pre>DT_RUNPATH</span></code> are both dynamic tags that are used to specify runtime library search paths.<p>The <code class="docutils literal notranslate"><span class=pre>DT_RPATH</span></code> is now considered as legacy since it does not respect the precedence of the <code class="docutils literal notranslate"><span class=pre>LD_LIBRARY_PATH</span></code> environment variable. This means that if the <code class="docutils literal notranslate"><span class=pre>LD_LIBRARY_PATH</span></code> is set to a valid directory where the library can be found, it will be ignored in favor of the <code class="docutils literal notranslate"><span class=pre>DT_RPATH</span></code> value. Therefore, the <code class="docutils literal notranslate"><span class=pre>DT_RUNPATH</span></code> tag should be prefered <code class="docutils literal notranslate"><span class=pre>DT_RPATH</span></code>.<p>Please note that if both tags are present, the loader will use the <code class="docutils literal notranslate"><span class=pre>DT_RUNPATH</span></code> entry over the legacy <code class="docutils literal notranslate"><span class=pre>DT_RPATH</span></code>.</div><div class=fixed-paragraph>The <code class="docutils literal notranslate"><span class=pre>DT_RPATH</span></code> tag is represented by the <div class=dropdown style=display:inline;><a aria-expanded=false aria-haspopup=true data-toggle=dropdown href=# id=lief-api-lief-ELF-DynamicEntryRpath role=button> <code><span class=pre>lief.ELF.DynamicEntryRpath</span></code></a><div aria-labelledby=lief-api-lief-ELF-DynamicEntryRpath class=dropdown-menu><a class=dropdown-item href=https://lief.re/doc/stable/rust/lief/elf/dynamic/struct.Rpath.html> <code class="xref rust rust-struct"><span class=pre><i class="fa fa-brands fa-rust"></i> lief::elf::dynamic::Rpath</span></code> </a><a class=dropdown-item href=python.html#lief.ELF.DynamicEntryRpath> <code class="xref py py-class"><span class=pre><i class="fa fa-brands fa-python"></i> lief.ELF.DynamicEntryRpath</span></code> </a><a class=dropdown-item href=cpp.html#_CPPv4N4LIEF3ELF17DynamicEntryRpathE> <code class="xref cpp cpp-class"><span class=pre><i class="fa fa-regular fa-file-code"></i> LIEF::ELF::DynamicEntryRpath</span></code> </a></div></div> interface and the <code class="docutils literal notranslate"><span class=pre>DT_RUNPATH</span></code> tag by <div class=dropdown style=display:inline;><a aria-expanded=false aria-haspopup=true data-toggle=dropdown href=# id=lief-api-lief-ELF-DynamicEntryRunPath role=button> <code><span class=pre>lief.ELF.DynamicEntryRunPath</span></code></a><div aria-labelledby=lief-api-lief-ELF-DynamicEntryRunPath class=dropdown-menu><a class=dropdown-item href=https://lief.re/doc/stable/rust/lief/elf/dynamic/struct.RunPath.html> <code class="xref rust rust-struct"><span class=pre><i class="fa fa-brands fa-rust"></i> lief::elf::dynamic::RunPath</span></code> </a><a class=dropdown-item href=python.html#lief.ELF.DynamicEntryRunPath> <code class="xref py py-class"><span class=pre><i class="fa fa-brands fa-python"></i> lief.ELF.DynamicEntryRunPath</span></code> </a><a class=dropdown-item href=cpp.html#_CPPv4N4LIEF3ELF19DynamicEntryRunPathE> <code class="xref cpp cpp-class"><span class=pre><i class="fa fa-regular fa-file-code"></i> LIEF::ELF::DynamicEntryRunPath</span></code> </a></div></div></div><p>The RPATH/RUNPATH modifications supported by LIEF include:<p><strong>Adding a new entry</strong><div class="sphinx-tabs docutils container"><div aria-label="Tabbed content" class=closeable role=tablist><button aria-controls=panel-8-8-0 aria-selected=true class=sphinx-tabs-tab id=tab-8-8-0 name=8-0 role=tab tabindex=0><em class="fa fa-brands fa-python"></em> Python</button><button aria-controls=panel-8-8-1 aria-selected=false class=sphinx-tabs-tab id=tab-8-8-1 name=8-1 role=tab tabindex=-1><em class="fa fa-regular fa-file-code"></em> C++</button><button aria-controls=panel-8-8-2 aria-selected=false class=sphinx-tabs-tab id=tab-8-8-2 name=8-2 role=tab tabindex=-1><em class="fa fa-brands fa-rust"></em> Rust</button></div><div aria-labelledby=tab-8-8-0 class=sphinx-tabs-panel id=panel-8-8-0 name=8-0 role=tabpanel tabindex=0><div class="highlight-python notranslate"><div class=highlight><pre><span></span><span class=n>elf</span><span class=p>:</span> <span class=n>lief</span><span class=o>.</span><span class=n>ELF</span><span class=o>.</span><span class=n>Binary</span> <span class=o>=</span> <span class=o>...</span>

<span class=n>runpath</span> <span class=o>=</span> <span class=n>lief</span><span class=o>.</span><span class=n>ELF</span><span class=o>.</span><span class=n>DynamicEntryRunPath</span><span class=p>(</span><span class=s2>"$ORIGIN:/opt/lib64"</span><span class=p>)</span>

<span class=n>elf</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>runpath</span><span class=p>)</span>

<span class=n>other_runpath</span> <span class=o>=</span> <span class=n>lief</span><span class=o>.</span><span class=n>ELF</span><span class=o>.</span><span class=n>DynamicEntryRunPath</span><span class=p>([</span>
  <span class=s1>'$ORIGIN'</span><span class=p>,</span> <span class=s1>'/opt/lib64'</span>
<span class=p>])</span>

<span class=n>elf</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>other_runpath</span><span class=p>)</span>

<span class=n>elf</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=s2>"updated.elf"</span><span class=p>)</span>
</pre></div></div></div><div aria-labelledby=tab-8-8-1 class=sphinx-tabs-panel hidden id=panel-8-8-1 name=8-1 role=tabpanel tabindex=0><div class="highlight-cpp notranslate"><div class=highlight><pre><span></span><span class=n>std</span><span class=o>::</span><span class=n>unique_ptr</span><span class=o>&lt;</span><span class=n>LIEF</span><span class=o>::</span><span class=n>ELF</span><span class=o>::</span><span class=n>Binary</span><span class=o>></span><span class=w> </span><span class=n>elf</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>...;</span>

<span class=n>LIEF</span><span class=o>::</span><span class=n>ELF</span><span class=o>::</span><span class=n>DynamicEntryRunPath</span><span class=w> </span><span class=n>runpath</span><span class=p>(</span><span class=s>"$ORIGIN:/opt/lib64"</span><span class=p>);</span>

<span class=n>elf</span><span class=o>-></span><span class=n>add</span><span class=p>(</span><span class=n>runpath</span><span class=p>);</span>

<span class=n>LIEF</span><span class=o>::</span><span class=n>ELF</span><span class=o>::</span><span class=n>DynamicEntryRunPath</span><span class=w> </span><span class=n>other_runpath</span><span class=p>(</span>
<span class=w>  </span><span class=n>std</span><span class=o>::</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>std</span><span class=o>::</span><span class=n>string</span><span class=o>></span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=s>"$ORIGIN"</span><span class=p>,</span><span class=w> </span><span class=s>"/opt/lib64"</span>
<span class=w>  </span><span class=p>}</span>
<span class=p>);</span>

<span class=n>elf</span><span class=o>-></span><span class=n>add</span><span class=p>(</span><span class=n>other_runpath</span><span class=p>);</span>

<span class=n>elf</span><span class=o>-></span><span class=n>write</span><span class=p>(</span><span class=s>"updated.elf"</span><span class=p>);</span>
</pre></div></div></div><div aria-labelledby=tab-8-8-2 class=sphinx-tabs-panel hidden id=panel-8-8-2 name=8-2 role=tabpanel tabindex=0><div class="highlight-rust notranslate"><div class=highlight><pre><span></span><span class=kd>let</span><span class=w> </span><span class=k>mut</span><span class=w> </span><span class=n>elf</span><span class=p>:</span><span class=w> </span><span class=nc>lief</span><span class=p>::</span><span class=n>elf</span><span class=p>::</span><span class=n>Binary</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=o>..</span><span class=p>.</span>

<span class=kd>let</span><span class=w> </span><span class=n>runpath</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>lief</span><span class=p>::</span><span class=n>elf</span><span class=p>::</span><span class=n>dynamic</span><span class=p>::</span><span class=n>RunPath</span><span class=p>::</span><span class=n>new</span><span class=p>(</span><span class=s>"$ORIGIN:/opt/lib64"</span><span class=p>);</span>

<span class=n>elf</span><span class=p>.</span><span class=n>add_dynamic_entry</span><span class=p>(</span><span class=o>&</span><span class=n>runpath</span><span class=p>);</span>

<span class=kd>let</span><span class=w> </span><span class=n>other_runpath</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>lief</span><span class=p>::</span><span class=n>elf</span><span class=p>::</span><span class=n>dynamic</span><span class=p>::</span><span class=n>RunPath</span><span class=p>::</span><span class=n>with_paths</span><span class=p>(</span>
<span class=w>  </span><span class=o>&</span><span class=fm>vec!</span><span class=p>[</span><span class=s>"$ORIGIN"</span><span class=p>,</span><span class=w> </span><span class=s>"/opt/lib64"</span><span class=p>]</span>
<span class=p>);</span>

<span class=n>elf</span><span class=p>.</span><span class=n>add_dynamic_entry</span><span class=p>(</span><span class=o>&</span><span class=n>other_runpath</span><span class=p>);</span>

<span class=kd>let</span><span class=w> </span><span class=n>output</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>PathBuf</span><span class=p>::</span><span class=n>from</span><span class=p>(</span><span class=s>"updated.elf"</span><span class=p>);</span>

<span class=n>elf</span><span class=p>.</span><span class=n>write</span><span class=p>(</span><span class=n>output</span><span class=p>.</span><span class=n>as_path</span><span class=p>());</span>
</pre></div></div></div></div><p><strong>Changing an entry</strong><div class="sphinx-tabs docutils container"><div aria-label="Tabbed content" class=closeable role=tablist><button aria-controls=panel-9-9-0 aria-selected=true class=sphinx-tabs-tab id=tab-9-9-0 name=9-0 role=tab tabindex=0><em class="fa fa-brands fa-python"></em> Python</button><button aria-controls=panel-9-9-1 aria-selected=false class=sphinx-tabs-tab id=tab-9-9-1 name=9-1 role=tab tabindex=-1><em class="fa fa-regular fa-file-code"></em> C++</button><button aria-controls=panel-9-9-2 aria-selected=false class=sphinx-tabs-tab id=tab-9-9-2 name=9-2 role=tab tabindex=-1><em class="fa fa-brands fa-rust"></em> Rust</button></div><div aria-labelledby=tab-9-9-0 class=sphinx-tabs-panel id=panel-9-9-0 name=9-0 role=tabpanel tabindex=0><div class="highlight-python notranslate"><div class=highlight><pre><span></span><span class=n>elf</span><span class=p>:</span> <span class=n>lief</span><span class=o>.</span><span class=n>ELF</span><span class=o>.</span><span class=n>Binary</span> <span class=o>=</span> <span class=o>...</span>

<span class=n>runpath</span> <span class=o>=</span> <span class=n>elf</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>lief</span><span class=o>.</span><span class=n>ELF</span><span class=o>.</span><span class=n>DynamicEntry</span><span class=o>.</span><span class=n>TAG</span><span class=o>.</span><span class=n>RUNPATH</span><span class=p>)</span>
<span class=k>assert</span> <span class=n>runpath</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span>

<span class=n>runpath</span><span class=o>.</span><span class=n>runpath</span> <span class=o>=</span> <span class=s2>"$ORIGIN:/opt/lib64"</span>
<span class=n>runpath</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=s2>"lib-x86_64-gnu"</span><span class=p>)</span>

<span class=n>elf</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>output</span><span class=o>.</span><span class=n>as_path</span><span class=p>());</span>
</pre></div></div></div><div aria-labelledby=tab-9-9-1 class=sphinx-tabs-panel hidden id=panel-9-9-1 name=9-1 role=tabpanel tabindex=0><div class="highlight-cpp notranslate"><div class=highlight><pre><span></span><span class=n>std</span><span class=o>::</span><span class=n>unique_ptr</span><span class=o>&lt;</span><span class=n>LIEF</span><span class=o>::</span><span class=n>ELF</span><span class=o>::</span><span class=n>Binary</span><span class=o>></span><span class=w> </span><span class=n>elf</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>...;</span>

<span class=n>LIEF</span><span class=o>::</span><span class=n>ELF</span><span class=o>::</span><span class=n>DynamicEntryRunPath</span><span class=o>*</span><span class=w> </span><span class=n>runpath</span><span class=w> </span><span class=o>=</span>
<span class=w>  </span><span class=n>elf</span><span class=o>-></span><span class=n>get</span><span class=p>(</span><span class=n>LIEF</span><span class=o>::</span><span class=n>ELF</span><span class=o>::</span><span class=n>DynamicEntry</span><span class=o>::</span><span class=n>TAG</span><span class=o>::</span><span class=n>RUNPATH</span><span class=p>);</span>

<span class=n>assert</span><span class=p>(</span><span class=n>runpath</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=k>nullptr</span><span class=p>);</span>

<span class=n>runpath</span><span class=o>-></span><span class=n>runpath</span><span class=p>(</span><span class=s>"$ORIGIN:/opt/lib64"</span><span class=p>);</span>
<span class=n>runpath</span><span class=o>-></span><span class=n>append</span><span class=p>(</span><span class=s>"lib-x86_64-gnu"</span><span class=p>);</span>

<span class=n>elf</span><span class=o>-></span><span class=n>write</span><span class=p>(</span><span class=s>"updated.elf"</span><span class=p>);</span>
</pre></div></div></div><div aria-labelledby=tab-9-9-2 class=sphinx-tabs-panel hidden id=panel-9-9-2 name=9-2 role=tabpanel tabindex=0><div class="highlight-rust notranslate"><div class=highlight><pre><span></span><span class=kd>let</span><span class=w> </span><span class=k>mut</span><span class=w> </span><span class=n>elf</span><span class=p>:</span><span class=w> </span><span class=nc>lief</span><span class=p>::</span><span class=n>elf</span><span class=p>::</span><span class=n>Binary</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=o>..</span><span class=p>.</span>

<span class=k>if</span><span class=w> </span><span class=kd>let</span><span class=w> </span><span class=nb>Some</span><span class=p>(</span><span class=n>dynamic</span><span class=p>::</span><span class=n>Entries</span><span class=p>::</span><span class=n>RunPath</span><span class=p>(</span><span class=k>mut</span><span class=w> </span><span class=n>runpath</span><span class=p>))</span><span class=w> </span><span class=o>=</span>
<span class=w>    </span><span class=n>elf</span><span class=p>.</span><span class=n>dynamic_entry_by_tag</span><span class=p>(</span><span class=n>dynamic</span><span class=p>::</span><span class=n>Tag</span><span class=p>::</span><span class=n>RUNPATH</span><span class=p>)</span>
<span class=p>{</span>
<span class=w>  </span><span class=n>runpath</span><span class=p>.</span><span class=n>set_runpath</span><span class=p>(</span><span class=s>"$ORIGIN:/opt/lib64"</span><span class=p>);</span>
<span class=w>  </span><span class=n>runpath</span><span class=p>.</span><span class=n>append</span><span class=p>(</span><span class=s>"lib-x86_64-gnu"</span><span class=p>);</span>
<span class=p>}</span>

<span class=kd>let</span><span class=w> </span><span class=n>output</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>PathBuf</span><span class=p>::</span><span class=n>from</span><span class=p>(</span><span class=s>"updated.elf"</span><span class=p>);</span>

<span class=n>elf</span><span class=p>.</span><span class=n>write</span><span class=p>(</span><span class=n>output</span><span class=p>.</span><span class=n>as_path</span><span class=p>());</span>
</pre></div></div></div></div><p><strong>Removing entries</strong><div class="sphinx-tabs docutils container"><div aria-label="Tabbed content" class=closeable role=tablist><button aria-controls=panel-10-10-0 aria-selected=true class=sphinx-tabs-tab id=tab-10-10-0 name=10-0 role=tab tabindex=0><em class="fa fa-brands fa-python"></em> Python</button><button aria-controls=panel-10-10-1 aria-selected=false class=sphinx-tabs-tab id=tab-10-10-1 name=10-1 role=tab tabindex=-1><em class="fa fa-regular fa-file-code"></em> C++</button><button aria-controls=panel-10-10-2 aria-selected=false class=sphinx-tabs-tab id=tab-10-10-2 name=10-2 role=tab tabindex=-1><em class="fa fa-brands fa-rust"></em> Rust</button></div><div aria-labelledby=tab-10-10-0 class=sphinx-tabs-panel id=panel-10-10-0 name=10-0 role=tabpanel tabindex=0><div class="highlight-python notranslate"><div class=highlight><pre><span></span><span class=n>elf</span><span class=p>:</span> <span class=n>lief</span><span class=o>.</span><span class=n>ELF</span><span class=o>.</span><span class=n>Binary</span> <span class=o>=</span> <span class=o>...</span>

<span class=c1># Remove **all** DT_RUNPATH entries</span>
<span class=n>elf</span><span class=o>.</span><span class=n>remove</span><span class=p>(</span><span class=n>lief</span><span class=o>.</span><span class=n>ELF</span><span class=o>.</span><span class=n>DynamicEntry</span><span class=o>.</span><span class=n>TAG</span><span class=o>.</span><span class=n>RUNPATH</span><span class=p>)</span>

<span class=c1># Remove all entries that contain '$ORIGIN'</span>
<span class=n>to_remove</span><span class=p>:</span> <span class=nb>list</span><span class=p>[</span><span class=n>lief</span><span class=o>.</span><span class=n>ELF</span><span class=o>.</span><span class=n>DynamicEntryRunPath</span><span class=p>]</span> <span class=o>=</span> <span class=p>[]</span>
<span class=k>for</span> <span class=n>dt_entry</span> <span class=ow>in</span> <span class=n>elf</span><span class=o>.</span><span class=n>dynamic_entries</span><span class=p>:</span>
    <span class=k>if</span> <span class=ow>not</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>dt_entry</span><span class=p>,</span> <span class=n>lief</span><span class=o>.</span><span class=n>ELF</span><span class=o>.</span><span class=n>DynamicEntryRunPath</span><span class=p>):</span>
        <span class=k>continue</span>

    <span class=k>if</span> <span class=s2>"$ORIGIN"</span> <span class=ow>in</span> <span class=n>dt_entry</span><span class=o>.</span><span class=n>runpath</span><span class=p>:</span>
        <span class=n>to_remove</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>dt_entry</span><span class=p>)</span>

<span class=k>for</span> <span class=n>entry</span> <span class=ow>in</span> <span class=n>to_remove</span><span class=p>:</span>
    <span class=n>elf</span><span class=o>.</span><span class=n>remove</span><span class=p>(</span><span class=n>dt_entry</span><span class=p>)</span>

<span class=n>elf</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=s2>"updated.elf"</span><span class=p>)</span>
</pre></div></div></div><div aria-labelledby=tab-10-10-1 class=sphinx-tabs-panel hidden id=panel-10-10-1 name=10-1 role=tabpanel tabindex=0><div class="highlight-cpp notranslate"><div class=highlight><pre><span></span><span class=n>std</span><span class=o>::</span><span class=n>unique_ptr</span><span class=o>&lt;</span><span class=n>LIEF</span><span class=o>::</span><span class=n>ELF</span><span class=o>::</span><span class=n>Binary</span><span class=o>></span><span class=w> </span><span class=n>elf</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>...;</span>

<span class=c1>// Remove **all** DT_RUNPATH entries</span>
<span class=n>elf</span><span class=o>-></span><span class=n>remove</span><span class=p>(</span><span class=n>LIEF</span><span class=o>::</span><span class=n>ELF</span><span class=o>::</span><span class=n>DynamicEntry</span><span class=o>::</span><span class=n>TAG</span><span class=o>::</span><span class=n>RUNPATH</span><span class=p>);</span>

<span class=c1>// Remove all entries that contain '$ORIGIN'</span>
<span class=n>std</span><span class=o>::</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>LIEF</span><span class=o>::</span><span class=n>ELF</span><span class=o>::</span><span class=n>DynamicEntryRunPath</span><span class=o>*></span><span class=w> </span><span class=n>to_remove</span><span class=p>;</span>
<span class=k>for</span><span class=w> </span><span class=p>(</span><span class=n>DynamicEntry</span><span class=o>&</span><span class=w> </span><span class=n>entry</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>elf</span><span class=o>-></span><span class=n>dynamic_entries</span><span class=p>())</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=k>auto</span><span class=o>*</span><span class=w> </span><span class=n>dt_entry</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>entry</span><span class=p>.</span><span class=n>cast</span><span class=o>&lt;</span><span class=n>LIEF</span><span class=o>::</span><span class=n>ELF</span><span class=o>::</span><span class=n>DynamicEntryRunPath</span><span class=o>></span><span class=p>())</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>dt_entry</span><span class=o>-></span><span class=n>runpath</span><span class=p>().</span><span class=n>find</span><span class=p>(</span><span class=s>"$ORIGIN"</span><span class=p>)</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=n>std</span><span class=o>::</span><span class=n>string</span><span class=o>::</span><span class=n>npos</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=n>to_remove</span><span class=p>.</span><span class=n>push_back</span><span class=p>(</span><span class=n>dt_entry</span><span class=p>);</span>
<span class=w>    </span><span class=p>}</span>
<span class=w>  </span><span class=p>}</span>
<span class=p>}</span>

<span class=k>for</span><span class=w> </span><span class=p>(</span><span class=n>LIEF</span><span class=o>::</span><span class=n>ELF</span><span class=o>::</span><span class=n>DynamicEntryRunPath</span><span class=o>*</span><span class=w> </span><span class=n>entry</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>to_remove</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=n>elf</span><span class=o>-></span><span class=n>remove</span><span class=p>(</span><span class=o>*</span><span class=n>entry</span><span class=p>);</span>
<span class=p>}</span>

<span class=n>elf</span><span class=o>-></span><span class=n>write</span><span class=p>(</span><span class=s>"updated.elf"</span><span class=p>);</span>
</pre></div></div></div><div aria-labelledby=tab-10-10-2 class=sphinx-tabs-panel hidden id=panel-10-10-2 name=10-2 role=tabpanel tabindex=0><div class="highlight-rust notranslate"><div class=highlight><pre><span></span><span class=kd>let</span><span class=w> </span><span class=k>mut</span><span class=w> </span><span class=n>elf</span><span class=p>:</span><span class=w> </span><span class=nc>lief</span><span class=p>::</span><span class=n>elf</span><span class=p>::</span><span class=n>Binary</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=o>..</span><span class=p>.</span>

<span class=c1>// Remove **all** DT_RUNPATH entries</span>
<span class=n>elf</span><span class=p>.</span><span class=n>remove_dynamic_entries_by_tag</span><span class=p>(</span><span class=n>elf</span><span class=p>::</span><span class=n>dynamic</span><span class=p>::</span><span class=n>Tag</span><span class=p>::</span><span class=n>RUNPATH</span><span class=p>);</span>

<span class=c1>// Remove all entries that contain '$ORIGIN'</span>
<span class=n>elf</span><span class=p>.</span><span class=n>remove_dynamic_entry_if</span><span class=p>(</span><span class=o>|</span><span class=n>e</span><span class=o>|</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>if</span><span class=w> </span><span class=kd>let</span><span class=w> </span><span class=n>elf</span><span class=p>::</span><span class=n>dynamic</span><span class=p>::</span><span class=n>Entries</span><span class=p>::</span><span class=n>RunPath</span><span class=p>(</span><span class=n>runpath</span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>e</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>runpath</span><span class=p>.</span><span class=n>runpath</span><span class=p>().</span><span class=n>contains</span><span class=p>(</span><span class=s>"$ORIGIN"</span><span class=p>);</span>
<span class=w>    </span><span class=p>}</span>
<span class=w>    </span><span class=kc>false</span>
<span class=p>});</span>

<span class=kd>let</span><span class=w> </span><span class=n>output</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>PathBuf</span><span class=p>::</span><span class=n>from</span><span class=p>(</span><span class=s>"updated.elf"</span><span class=p>);</span>
<span class=n>elf</span><span class=p>.</span><span class=n>write</span><span class=p>(</span><span class=n>output</span><span class=p>.</span><span class=n>as_path</span><span class=p>());</span>
</pre></div></div></div></div><p>You can also check the <a class="reference internal" href=../../tools/lief-patchelf/index.html#tools-lief-patchelf><span class="std std-ref">lief-patchelf</span></a> section for a command-line interface.</section><section id=symbol-versions><span id=format-elf-symbols-version></span><h2 id=symbol-versions>Symbol Versions<a title="Link to this heading" class=headerlink href=#symbol-versions>¶</a></h2><p>The ELF format supports symbol versioning, allowing multiple versions of the same function or variable to coexist within a single shared object.<p>During compilation, the linker selects the appropriate symbols and versions based on the libraries provided as input. For example, if the program uses the function <code class="docutils literal notranslate"><span class=pre>printf</span></code> and is linked with a version of <code class="docutils literal notranslate"><span class=pre>libc.so</span></code> that exposes <code class="docutils literal notranslate"><span class=pre>printf@@GLIBC_2.40</span></code>, the compiled executable will require at least that version of the <code class="docutils literal notranslate"><span class=pre>libc</span></code> to run.<p>This requirement regarding versioning can be problematic if we want to create an executable or library compatible with a wide range of Linux distributions.<p>The <strong>best way</strong> to ensure maximum compatibility is to provide the minimum supported version of the Glibc. For instance, if we aim to support Linux distributions with at least Glibc version <code class="docutils literal notranslate"><span class=pre>2.28</span></code> (released in 2018), we should specifically provide that version of <code class="docutils literal notranslate"><span class=pre>libc.so</span></code>:<div class="highlight-console notranslate"><div class=highlight><pre><span></span><span class=gp>$ </span>ld<span class=w> </span>--sysroot<span class=o>=</span>/sysroot/glibc-2.28/<span class=w> </span>my_program.o<span class=w> </span>-o<span class=w> </span>my_program.elf
<span class=gp>$ </span>ld<span class=w> </span>-L<span class=w> </span>/sysroot/glibc-2.28/lib64/<span class=w> </span>my_program.o<span class=w> </span>-o<span class=w> </span>my_program.elf<span class=w> </span>-lc
</pre></div></div><p>There are situations where we don’t have that control over the link step, and for which we want to change the versioning <strong>post-compilation</strong>. LIEF can be used in these situations to perform the following modifications on the symbol versions.<p><strong>Remove the version for a specific symbol</strong><p>In this example, we remove the version attached to the <code class="docutils literal notranslate"><span class=pre>printf</span></code> symbol by setting the versioning as global (the default setting for imported functions).<div class="sphinx-tabs docutils container"><div aria-label="Tabbed content" class=closeable role=tablist><button aria-controls=panel-11-11-0 aria-selected=true class=sphinx-tabs-tab id=tab-11-11-0 name=11-0 role=tab tabindex=0><em class="fa fa-brands fa-python"></em> Python</button><button aria-controls=panel-11-11-1 aria-selected=false class=sphinx-tabs-tab id=tab-11-11-1 name=11-1 role=tab tabindex=-1><em class="fa fa-regular fa-file-code"></em> C++</button><button aria-controls=panel-11-11-2 aria-selected=false class=sphinx-tabs-tab id=tab-11-11-2 name=11-2 role=tab tabindex=-1><em class="fa fa-brands fa-rust"></em> Rust</button></div><div aria-labelledby=tab-11-11-0 class=sphinx-tabs-panel id=panel-11-11-0 name=11-0 role=tabpanel tabindex=0><div class="highlight-python notranslate"><div class=highlight><pre><span></span><span class=n>elf</span><span class=p>:</span> <span class=n>lief</span><span class=o>.</span><span class=n>ELF</span><span class=o>.</span><span class=n>Binary</span> <span class=o>=</span> <span class=o>...</span>

<span class=n>sym</span> <span class=o>=</span> <span class=n>elf</span><span class=o>.</span><span class=n>get_dynamic_symbol</span><span class=p>(</span><span class=s2>"printf"</span><span class=p>)</span>

<span class=n>sym</span><span class=o>.</span><span class=n>symbol_version</span><span class=o>.</span><span class=n>as_global</span><span class=p>()</span>

<span class=n>elf</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=s2>"updated.elf"</span><span class=p>)</span>
</pre></div></div></div><div aria-labelledby=tab-11-11-1 class=sphinx-tabs-panel hidden id=panel-11-11-1 name=11-1 role=tabpanel tabindex=0><div class="highlight-cpp notranslate"><div class=highlight><pre><span></span><span class=n>std</span><span class=o>::</span><span class=n>unique_ptr</span><span class=o>&lt;</span><span class=n>LIEF</span><span class=o>::</span><span class=n>ELF</span><span class=o>::</span><span class=n>Binary</span><span class=o>></span><span class=w> </span><span class=n>elf</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>...;</span>

<span class=n>LIEF</span><span class=o>::</span><span class=n>ELF</span><span class=o>::</span><span class=n>Symbol</span><span class=o>*</span><span class=w> </span><span class=n>sym</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>elf</span><span class=o>-></span><span class=n>get_dynamic_symbol</span><span class=p>(</span><span class=s>"printf"</span><span class=p>);</span>

<span class=n>assert</span><span class=p>(</span><span class=n>sym</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=k>nullptr</span><span class=p>);</span>

<span class=n>sym</span><span class=o>-></span><span class=n>symbol_version</span><span class=p>()</span><span class=o>-></span><span class=n>as_global</span><span class=p>();</span>

<span class=n>elf</span><span class=o>-></span><span class=n>write</span><span class=p>(</span><span class=s>"updated.elf"</span><span class=p>)</span>
</pre></div></div></div><div aria-labelledby=tab-11-11-2 class=sphinx-tabs-panel hidden id=panel-11-11-2 name=11-2 role=tabpanel tabindex=0><div class="highlight-rust notranslate"><div class=highlight><pre><span></span><span class=kd>let</span><span class=w> </span><span class=k>mut</span><span class=w> </span><span class=n>elf</span><span class=p>:</span><span class=w> </span><span class=nc>lief</span><span class=p>::</span><span class=n>elf</span><span class=p>::</span><span class=n>Binary</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=o>..</span><span class=p>.</span>

<span class=k>if</span><span class=w> </span><span class=kd>let</span><span class=w> </span><span class=nb>Some</span><span class=p>(</span><span class=n>sym</span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>elf</span><span class=p>.</span><span class=n>dynamic_symbol_by_name</span><span class=p>(</span><span class=s>"printf"</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>if</span><span class=w> </span><span class=kd>let</span><span class=w> </span><span class=nb>Some</span><span class=p>(</span><span class=k>mut</span><span class=w> </span><span class=n>symver</span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>dynsym</span><span class=p>.</span><span class=n>symbol_version</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=n>symver</span><span class=p>.</span><span class=n>as_global</span><span class=p>();</span>
<span class=w>    </span><span class=p>}</span>
<span class=p>}</span>

<span class=kd>let</span><span class=w> </span><span class=n>output</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>PathBuf</span><span class=p>::</span><span class=n>from</span><span class=p>(</span><span class=s>"updated.elf"</span><span class=p>);</span>
<span class=n>elf</span><span class=p>.</span><span class=n>write</span><span class=p>(</span><span class=n>output</span><span class=p>.</span><span class=n>as_path</span><span class=p>());</span>
</pre></div></div></div></div><p><strong>Remove all the versions for a specific library</strong><p>In this example, we remove all the symbol versions associated with an imported library (<code class="docutils literal notranslate"><span class=pre>libm.so.6</span></code>):<div class="sphinx-tabs docutils container"><div aria-label="Tabbed content" class=closeable role=tablist><button aria-controls=panel-12-12-0 aria-selected=true class=sphinx-tabs-tab id=tab-12-12-0 name=12-0 role=tab tabindex=0><em class="fa fa-brands fa-python"></em> Python</button><button aria-controls=panel-12-12-1 aria-selected=false class=sphinx-tabs-tab id=tab-12-12-1 name=12-1 role=tab tabindex=-1><em class="fa fa-regular fa-file-code"></em> C++</button><button aria-controls=panel-12-12-2 aria-selected=false class=sphinx-tabs-tab id=tab-12-12-2 name=12-2 role=tab tabindex=-1><em class="fa fa-brands fa-rust"></em> Rust</button></div><div aria-labelledby=tab-12-12-0 class=sphinx-tabs-panel id=panel-12-12-0 name=12-0 role=tabpanel tabindex=0><div class="highlight-python notranslate"><div class=highlight><pre><span></span><span class=n>elf</span><span class=p>:</span> <span class=n>lief</span><span class=o>.</span><span class=n>ELF</span><span class=o>.</span><span class=n>Binary</span> <span class=o>=</span> <span class=o>...</span>

<span class=n>elf</span><span class=o>.</span><span class=n>remove_version_requirement</span><span class=p>(</span><span class=s2>"libm.so.6"</span><span class=p>)</span>

<span class=n>elf</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=s2>"updated.elf"</span><span class=p>)</span>
</pre></div></div></div><div aria-labelledby=tab-12-12-1 class=sphinx-tabs-panel hidden id=panel-12-12-1 name=12-1 role=tabpanel tabindex=0><div class="highlight-cpp notranslate"><div class=highlight><pre><span></span><span class=n>std</span><span class=o>::</span><span class=n>unique_ptr</span><span class=o>&lt;</span><span class=n>LIEF</span><span class=o>::</span><span class=n>ELF</span><span class=o>::</span><span class=n>Binary</span><span class=o>></span><span class=w> </span><span class=n>elf</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>...;</span>

<span class=n>elf</span><span class=o>-></span><span class=n>remove_version_requirement</span><span class=p>(</span><span class=s>"libm.so.6"</span><span class=p>);</span>

<span class=n>elf</span><span class=o>-></span><span class=n>write</span><span class=p>(</span><span class=s>"updated.elf"</span><span class=p>)</span>
</pre></div></div></div><div aria-labelledby=tab-12-12-2 class=sphinx-tabs-panel hidden id=panel-12-12-2 name=12-2 role=tabpanel tabindex=0><div class="highlight-rust notranslate"><div class=highlight><pre><span></span><span class=kd>let</span><span class=w> </span><span class=k>mut</span><span class=w> </span><span class=n>elf</span><span class=p>:</span><span class=w> </span><span class=nc>lief</span><span class=p>::</span><span class=n>elf</span><span class=p>::</span><span class=n>Binary</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=o>..</span><span class=p>.</span>

<span class=n>elf</span><span class=p>.</span><span class=n>remove_version_requirement</span><span class=p>(</span><span class=s>"libm.so.6"</span><span class=p>);</span>

<span class=kd>let</span><span class=w> </span><span class=n>output</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>PathBuf</span><span class=p>::</span><span class=n>from</span><span class=p>(</span><span class=s>"updated.elf"</span><span class=p>);</span>
<span class=n>elf</span><span class=p>.</span><span class=n>write</span><span class=p>(</span><span class=n>output</span><span class=p>.</span><span class=n>as_path</span><span class=p>());</span>
</pre></div></div></div></div><div class="sphinx-tabs docutils container"><div aria-label="Tabbed content" class=closeable role=tablist><button aria-controls=panel-13-13-0 aria-selected=true class=sphinx-tabs-tab id=tab-13-13-0 name=13-0 role=tab tabindex=0><em class="fa fa-solid fa-terminal"></em> Before</button><button aria-controls=panel-13-13-1 aria-selected=false class=sphinx-tabs-tab id=tab-13-13-1 name=13-1 role=tab tabindex=-1><em class="fa fa-solid fa-terminal"></em> After</button></div><div aria-labelledby=tab-13-13-0 class=sphinx-tabs-panel id=panel-13-13-0 name=13-0 role=tabpanel tabindex=0><div class="highlight-console notranslate"><div class=highlight><pre><span></span><span class=gp>$ </span>readelf<span class=w> </span>-V<span class=w> </span>input.elf

<span class=go>Version symbols section '.gnu.version' contains 48 entries:</span>
<span class=go> Addr: 00000000000009bc  Offset: 0x0009bc  Link: 6 (.dynsym)</span>
<span class=go>  000:   0 (*local*)       2 (GLIBC_2.2.5)   3 (GLIBC_2.2.5)   2 (GLIBC_2.2.5)</span>
<span class=go>  004:   2 (GLIBC_2.2.5)   0 (*local*)       4 (GLIBC_2.17)    3 (GLIBC_2.2.5)</span>
<span class=go>  008:   2 (GLIBC_2.2.5)   5 (GLIBC_2.27)    2 (GLIBC_2.2.5)   3 (GLIBC_2.2.5)</span>
<span class=go>  00c:   3 (GLIBC_2.2.5)   2 (GLIBC_2.2.5)   6 (GLIBC_2.4)     2 (GLIBC_2.2.5)</span>
<span class=go>  010:   3 (GLIBC_2.2.5)   2 (GLIBC_2.2.5)   3 (GLIBC_2.2.5)   3 (GLIBC_2.2.5)</span>
<span class=go>  014:   2 (GLIBC_2.2.5)   3 (GLIBC_2.2.5)   3 (GLIBC_2.2.5)   0 (*local*)</span>
<span class=go>  018:   3 (GLIBC_2.2.5)   3 (GLIBC_2.2.5)   2 (GLIBC_2.2.5)   3 (GLIBC_2.2.5)</span>
<span class=go>  01c:   3 (GLIBC_2.2.5)   3 (GLIBC_2.2.5)   2 (GLIBC_2.2.5)   2 (GLIBC_2.2.5)</span>
<span class=go>  020:   2 (GLIBC_2.2.5)   3 (GLIBC_2.2.5)   2 (GLIBC_2.2.5)   2 (GLIBC_2.2.5)</span>
<span class=go>  024:   3 (GLIBC_2.2.5)   3 (GLIBC_2.2.5)   2 (GLIBC_2.2.5)   3 (GLIBC_2.2.5)</span>
<span class=go>  028:   3 (GLIBC_2.2.5)   0 (*local*)       3 (GLIBC_2.2.5)   3 (GLIBC_2.2.5)</span>
<span class=go>  02c:   3 (GLIBC_2.2.5)   7 (GLIBC_2.29)    2 (GLIBC_2.2.5)   2 (GLIBC_2.2.5)</span>

<span class=go>Version needs section '.gnu.version_r' contains 2 entries:</span>
<span class=go> Addr: 0000000000000a20  Offset: 0x000a20  Link: 7 (.dynstr)</span>
<span class=go>  0x0000: Version: 1  File: libm.so.6  Cnt: 3</span>
<span class=go>  0x0010:   Name: GLIBC_2.29  Flags: none  Version: 7</span>
<span class=go>  0x0020:   Name: GLIBC_2.27  Flags: none  Version: 5</span>
<span class=go>  0x0030:   Name: GLIBC_2.2.5  Flags: none  Version: 3</span>
<span class=go>  0x0040: Version: 1  File: libc.so.6  Cnt: 3</span>
<span class=go>  0x0050:   Name: GLIBC_2.4  Flags: none  Version: 6</span>
<span class=go>  0x0060:   Name: GLIBC_2.17  Flags: none  Version: 4</span>
<span class=go>  0x0070:   Name: GLIBC_2.2.5  Flags: none  Version: 2</span>
</pre></div></div></div><div aria-labelledby=tab-13-13-1 class=sphinx-tabs-panel hidden id=panel-13-13-1 name=13-1 role=tabpanel tabindex=0><div class="highlight-console notranslate"><div class=highlight><pre><span></span><span class=gp>$ </span>readelf<span class=w> </span>-V<span class=w> </span>updated.elf

<span class=go>Version symbols section '.gnu.version' contains 48 entries:</span>
<span class=go> Addr: 00000000000009bc  Offset: 0x0009bc  Link: 6 (.dynsym)</span>
<span class=go>  000:   0 (*local*)       1 (*global*)      1 (*global*)      1 (*global*)</span>
<span class=go>  004:   1 (*global*)      0 (*local*)       4 (GLIBC_2.17)    1 (*global*)</span>
<span class=go>  008:   1 (*global*)      1 (*global*)      1 (*global*)      1 (*global*)</span>
<span class=go>  00c:   1 (*global*)      1 (*global*)      6 (GLIBC_2.4)     1 (*global*)</span>
<span class=go>  010:   1 (*global*)      1 (*global*)      1 (*global*)      1 (*global*)</span>
<span class=go>  014:   1 (*global*)      1 (*global*)      1 (*global*)      0 (*local*)</span>
<span class=go>  018:   1 (*global*)      1 (*global*)      1 (*global*)      1 (*global*)</span>
<span class=go>  01c:   1 (*global*)      1 (*global*)      1 (*global*)      1 (*global*)</span>
<span class=go>  020:   1 (*global*)      1 (*global*)      1 (*global*)      1 (*global*)</span>
<span class=go>  024:   1 (*global*)      1 (*global*)      1 (*global*)      1 (*global*)</span>
<span class=go>  028:   1 (*global*)      0 (*local*)       1 (*global*)      1 (*global*)</span>
<span class=go>  02c:   1 (*global*)      1 (*global*)      1 (*global*)      1 (*global*)</span>

<span class=go>Version needs section '.gnu.version_r' contains 1 entries:</span>
<span class=go> Addr: 0000000000000a20  Offset: 0x000a20  Link: 7 (.dynstr)</span>
<span class=go>  0x0000: Version: 1  File: libc.so.6  Cnt: 3</span>
<span class=go>  0x0010:   Name: GLIBC_2.4  Flags: none  Version: 6</span>
<span class=go>  0x0020:   Name: GLIBC_2.17  Flags: none  Version: 4</span>
<span class=go>  0x0030:   Name: GLIBC_2.2.5  Flags: none  Version: 2</span>
</pre></div></div></div></div></section></section></div><div class="col-xl-2 d-none d-xl-block px-0 py-5 docs-sidebar docs-sidebar-right"><aside class="border-left pl-5 py-3"><span class="text-uppercase text-muted font-size-sm d-block mb-3"> On this page: </span><a class="d-block my-2" data-toggle=scroll href=#introduction>Introduction</a><a class="d-block my-2" data-toggle=scroll href=#adding-a-section-segment>Adding a Section/Segment</a><a class="d-block my-2" data-toggle=scroll href=#advance-parsing-writing>Advance Parsing/Writing</a><a class="d-block my-2" data-toggle=scroll href=#dwarf-support>DWARF Support</a><a class="d-block my-2" data-toggle=scroll href=#r-un-path-modification>R[UN]PATH Modification</a><a class="d-block my-2" data-toggle=scroll href=#symbol-versions>Symbol Versions</a></aside></div></div></div>