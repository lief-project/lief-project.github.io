<!doctype html><html data-content_root=../../../ lang=en><meta charset=utf-8><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content="width=device-width,initial-scale=1" name=viewport><meta content="width=device-width,initial-scale=1" name=viewport><meta content="ie=edge" http-equiv=x-ua-compatible><meta content="Copy to clipboard" name=lang:clipboard.copy><meta content="Copied to clipboard" name=lang:clipboard.copied><meta content=en name=lang:search.language><meta content=True name=lang:search.pipeline.stopwords><meta content=True name=lang:search.pipeline.trimmer><meta content="No matching documents" name=lang:search.result.none><meta content="1 matching document" name=lang:search.result.one><meta content="# matching documents" name=lang:search.result.other><meta content=[\s\-]+ name=lang:search.tokenizer><meta content="LIEF Documentation" name=Description><link crossorigin href=https://fonts.gstatic.com/ rel=preconnect><script src=../../../_static/javascripts/vendor.min.js></script><link href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.0/css/all.min.css rel=stylesheet><link href=../../../_static/favicon.ico rel=apple-touch-icon><title>TLS Modification — LIEF Documentation</title><link href=../../../_static/fonts/material-icons.css rel=stylesheet><link href=../../../_static/stylesheets/vendor.min.css rel=stylesheet><script defer src=https://cdn.jsdelivr.net/npm/img-comparison-slider@8/dist/index.js></script><link href=https://cdn.jsdelivr.net/npm/img-comparison-slider@8/dist/styles.css rel=stylesheet><link href="../../../_static/pygments.css?v=d8a2add5" rel=stylesheet><link href="../../../_static/basic.css?v=29da98fa" rel=stylesheet><link href="../../../_static/graphviz.css?v=4ae1632d" rel=stylesheet><link href="../../../_static/css/custom.css?v=968db012" rel=stylesheet><link href="../../../_static/tabs.css?v=a5c4661c" rel=stylesheet><script src="../../../_static/documentation_options.js?v=f04cce2a"></script><script src="../../../_static/doctools.js?v=fd6eb6e6"></script><script src="../../../_static/sphinx_highlight.js?v=6ffebe34"></script><script src="../../../_static/tabs.js?v=3030b3cb"></script><link href=../../../_static/favicon.ico rel=icon><link href=../../../genindex.html rel=index title=Index><link href=../../../search.html rel=search title=Search><link title="Debug Modification" href=debug.html rel=next><link title="Resources Modification" href=resources.html rel=prev><link href=../../../_static/stylesheets/theme.css rel=stylesheet><body data-md-color-accent=cyan data-md-color-primary=blue dir=ltr><nav class="navbar navbar-expand-lg navbar-light bg-white border-bottom fixed-top" role=navigation><a class=navbar-brand href=../../../index.html>LIEF Documentation</a><button class=navbar-toggler data-target=#navbar-collapse data-toggle=collapse><span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse justify-content-center mt-2 mt-lg-0" id=navbar-collapse><ul class="navbar-nav position-relative px-lg-6 px-xl-8"><li class=nav-item><a class=nav-link href=https://lief.re> <i class="fa-solid fa-house mr-3"></i>Home </a><li class=nav-item><a class=nav-link href=https://lief.re/blog> <i class="fa-solid fa-rss mr-3"></i>Blog </a><li class=nav-item><a class=nav-link href=https://lief.re/download> <i class="fa-solid fa-download mr-3"></i>Download </a><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" aria-expanded=false data-toggle=dropdown href=# role=button> <i class="fa-solid fa-book mr-3"></i>Documentation </a> <div class=dropdown-menu role=menu><a class=dropdown-item href=https://lief.re/doc/stable/doxygen>Doxygen</a></div><li class=nav-item><a class=nav-link href=https://lief.re/about> <i class="fa-solid fa-bars-staggered mr-3"></i>About </a><li class="nav-item ml-lg-3 mt-3 mt-lg-0"><a class="hover-lift-light mt-1" href=https://discord.gg/jGQtyAYChJ target=_blank> <i class="fab fa-2x fa-discord text-darkblue mr-3"></i> </a><li class=nav-item><a class="btn btn-outline-pink" href=https://github.com/sponsors/lief-project target=_blank> <i class="fa-solid fa-heart mr-3"></i> Sponsor </a></ul></div></nav><div class="container-fluid container-docs"><div class=row><div class="col-12 col-lg-3 col-xl-2 border-lg-right py-lg-5 pl-lg-4 docs-sidebar docs-sidebar-left"><div class="collapse d-lg-block mb-6 mb-lg-0" id=sidebar-collapse><form action=../../../search.html method=GET name=search><input autocapitalize=off autocomplete=off class=form-control data-md-component=query data-md-state=active name=q placeholder=Search spellcheck=false></form><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2" href=../../../intro.html><em class="fa fa-solid fa-door-open"></em> Introduction</a></ul><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2" href=../../../installation.html><em class="fa fa-solid fa-gears"></em> Installation and Integration</a></ul><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2" href=../../../compilation.html><em class="fa fa-solid fa-laptop-code"></em> Compilation</a></ul><div class="text-darkblue text-uppercase font-size-normal font-weight-bolder mt-4 pt-2 mb-2"><span class=caption-text><i class="fa-solid fa-sitemap"> </i>Formats</span></div><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2" href=../../elf/index.html><em class="fa fa-brands fa-linux"></em> ELF</a></ul><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2" href=../../macho/index.html><em class="fa fa-brands fa-apple"></em> Mach-O</a></ul><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2" href=../index.html><em class="fa fa-brands fa-windows"></em> PE</a></ul><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2" href=../../coff/index.html><em class="fa fa-brands fa-windows"></em> COFF</a></ul><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2" href=../../android/index.html><em class="fa fa-brands fa-android"></em> Android</a></ul><div class="text-darkblue text-uppercase font-size-normal font-weight-bolder mt-4 pt-2 mb-2"><span class=caption-text><i class="fa-solid fa-code"> </i>API</span></div><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2" href=../../../api/binary_abstraction/index.html><em class="fa fa-brands fa-uncharted"></em> Binary Abstraction</a></ul><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2" href=../../../api/utilities/index.html><em class="fa fa-solid fa-hand-holding-hand"></em> Utilities</a></ul><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2" href=../../../api/error_handling/index.html><em class="fa fa-solid fa-triangle-exclamation"></em> Error Handling</a></ul><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2" href=../../../api/logging/index.html><em class="fa fa-regular fa-rectangle-list"></em> Logging</a></ul><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2" href=../../../api/cpp/index.html><em class="fa fa-regular fa-file-code"></em> C++</a></ul><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2" href=../../../api/rust/index.html><em class="fa fa-brands fa-rust"></em> Rust</a></ul><div class="text-darkblue text-uppercase font-size-normal font-weight-bolder mt-4 pt-2 mb-2"><span class=caption-text><i class="fa-solid fa-hat-wizard"> </i>LIEF Extended</span></div><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2" href=../../../extended/intro.html><em class="fa fa-cubes"></em> What is LIEF Extended?</a></ul><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2" href=../../../extended/debug_info/index.html><em class="fa fa-solid fa-magnifying-glass"></em> Debug Info</a></ul><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2" href=../../../extended/dwarf/index.html><em class="fa fa-solid fa-bars-staggered"></em> DWARF</a></ul><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2" href=../../../extended/pdb/index.html><em class="fa fa-brands fa-windows"></em> PDB</a></ul><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2" href=../../../extended/objc/index.html><em class="fa fa-brands fa-apple"></em> Objective-C</a></ul><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2" href=../../../extended/dsc/index.html><em class="fa fa-solid fa-diagram-predecessor"></em> Dyld Shared Cache</a></ul><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2" href=../../../extended/disassembler/index.html><em class="fa fa-solid fa-dna"></em> Disassembler</a></ul><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2" href=../../../extended/assembler/index.html><em class="fa fa-solid fa-user-secret"></em> Assembler</a></ul><div class="text-darkblue text-uppercase font-size-normal font-weight-bolder mt-4 pt-2 mb-2"><span class=caption-text><i class="fa-solid fa-puzzle-piece"> </i>Plugins</span></div><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2" href=../../../plugins/ghidra/index.html><em class="fa fa-solid fa-dragon"></em> Ghidra</a></ul><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2" href=../../../plugins/binaryninja/index.html><em class="fa fa-solid fa-user-ninja"></em> BinaryNinja</a></ul><div class="text-darkblue text-uppercase font-size-normal font-weight-bolder mt-4 pt-2 mb-2"><span class=caption-text><i class="fa-solid fa-toolbox"> </i>Tools</span></div><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2" href=../../../tools/lief-patchelf/index.html><em class="fa fa-solid fa-screwdriver-wrench"></em> lief-patchelf</a></ul><div class="text-darkblue text-uppercase font-size-normal font-weight-bolder mt-4 pt-2 mb-2"><span class=caption-text><i class="fa-solid fa-layer-group"> </i>Tutorials</span></div><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2" href=../../../tutorials/01_play_with_formats.html>01 - Parse and manipulate formats</a></ul><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2" href=../../../tutorials/02_pe_from_scratch.html>02 - Create a PE from scratch (Deprecated)</a></ul><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2" href=../../../tutorials/03_elf_change_symbols.html>03 - Play with ELF symbols</a></ul><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2" href=../../../tutorials/04_elf_hooking.html>04 - ELF Hooking</a></ul><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2" href=../../../tutorials/05_elf_infect_plt_got.html>05 - Infecting the plt/got</a></ul><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2" href=../../../tutorials/06_pe_hooking.html>06 - PE Hooking (Deprecated)</a></ul><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2" href=../../../tutorials/07_pe_resource.html>07 - PE Resources</a></ul><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2" href=../../../tutorials/08_elf_bin2lib.html>08 - Transforming an ELF executable into a library</a></ul><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2" href=../../../tutorials/09_frida_lief.html>09 - How to use frida on a non-rooted device</a></ul><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2" href=../../../tutorials/10_android_formats.html>10 - Android formats</a></ul><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2" href=../../../tutorials/11_macho_modification.html>11 - Mach-O Modification</a></ul><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2" href=../../../tutorials/12_elf_coredump.html>12 - ELF Coredump</a></ul><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2" href=../../../tutorials/13_pe_authenticode.html>13 - PE Authenticode</a></ul><div class="text-darkblue text-uppercase font-size-normal font-weight-bolder mt-4 pt-2 mb-2"><span class=caption-text><i class="fa-brands fa-space-awesome"> </i>Extra Information</span></div><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2" href=../../../references.html><em class="fa fa-fa-solid fa-book-bookmark"></em> References</a></ul><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2" href=../../../changelog.html><em class="fa fa-solid fa-code-compare"></em> Changelog</a></ul></div><hr><span class="svg-icon text-purple mr-1 relative-top--1"> <svg viewbox="0 0 512 512" height=512 width=512 xmlns=http://www.w3.org/2000/svg><title>ionicons-v5-d</title><circle cx=160 cy=96 r=48 style=fill:none;stroke:#000;stroke-linecap:round;stroke-linejoin:round;stroke-width:32px></circle><circle cx=160 cy=416 r=48 style=fill:none;stroke:#000;stroke-linecap:round;stroke-linejoin:round;stroke-width:32px></circle><line style=fill:none;stroke:#000;stroke-linecap:round;stroke-linejoin:round;stroke-width:32px x1=160 x2=160 y1=368 y2=144></line><circle cx=352 cy=160 r=48 style=fill:none;stroke:#000;stroke-linecap:round;stroke-linejoin:round;stroke-width:32px></circle><path d=M352,208c0,128-192,48-192,160 style=fill:none;stroke:#000;stroke-linecap:round;stroke-linejoin:round;stroke-width:32px></path></svg> </span><a class=text-darkblue href=https://github.com/lief-project/LIEF/commits/45d0e6cd>0.17.4 (45d0e6cd)</a><br> Updated on 21/02/2026, 09:14:24.</div><div class="col-12 col-lg-9 col-xl-8 offset-lg-3 offset-xl-2 py-lg-5 px-lg-6 mb-8"><nav aria-label=breadcrumb><ol class=breadcrumb><li class=breadcrumb-item><a aria-label=Home href=../../../index.html><i class="fa-solid fa-home"></i></a><li class=breadcrumb-item><a href=../index.html><em class="fa fa-brands fa-windows"></em> PE</a><li class="breadcrumb-item active" aria-current=page><a href=#><em class="fa fa-solid fa-gears"></em> TLS Modification</a></ol></nav><section id=tls-modification><h1 id=formats-pe-modifications-tls--page-root><em class="fa fa-solid fa-gears"></em> TLS Modification<a title="Link to this heading" class=headerlink href=#formats-pe-modifications-tls--page-root>¶</a></h1><figure class=align-default><a class="reference internal image-reference" href=../../../_images/tls.webp><img alt="PE TLS Overview" height=624 src=../../../_images/tls.webp width=913> </a></figure><p>LIEF can be used to <strong>modify</strong>, <strong>create</strong>, or <strong>remove</strong> Thread Local Storage (TLS) information.<section id=tls-modifications><h2 id=tls-modifications>TLS Modifications<a title="Link to this heading" class=headerlink href=#tls-modifications>¶</a></h2><div class=fixed-paragraph>All attributes of the <div class=dropdown style=display:inline;><a aria-expanded=false aria-haspopup=true data-toggle=dropdown href=# id=lief-api-lief-PE-TLS role=button> <code><span class=pre>lief.PE.TLS</span></code></a><div aria-labelledby=lief-api-lief-PE-TLS class=dropdown-menu><a class=dropdown-item href=https://lief.re/doc/stable/rust/lief/pe/struct.TLS.html> <code class="xref rust rust-struct"><span class=pre><i class="fa fa-brands fa-rust"></i> lief::pe::TLS</span></code> </a><a class=dropdown-item href=../python.html#lief.PE.TLS> <code class="xref py py-class"><span class=pre><i class="fa fa-brands fa-python"></i> lief.PE.TLS</span></code> </a><a class=dropdown-item href=../cpp.html#_CPPv4N4LIEF2PE3TLSE> <code class="xref cpp cpp-class"><span class=pre><i class="fa fa-regular fa-file-code"></i> LIEF::PE::TLS</span></code> </a></div></div> interface can be modified as long as the changes are consistent with the layout of the PE binary. For instance, you can adjust the TLS callbacks by removing, reordering, or adding addresses:</div><div class="sphinx-tabs docutils container"><div aria-label="Tabbed content" class=closeable role=tablist><button aria-controls=panel-0-0-0 aria-selected=true class=sphinx-tabs-tab id=tab-0-0-0 name=0-0 role=tab tabindex=0><em class="fa fa-brands fa-python"></em> Python</button><button aria-controls=panel-0-0-1 aria-selected=false class=sphinx-tabs-tab id=tab-0-0-1 name=0-1 role=tab tabindex=-1><em class="fa fa-regular fa-file-code"></em> C++</button><button aria-controls=panel-0-0-2 aria-selected=false class=sphinx-tabs-tab id=tab-0-0-2 name=0-2 role=tab tabindex=-1><em class="fa fa-brands fa-rust"></em> Rust</button></div><div aria-labelledby=tab-0-0-0 class=sphinx-tabs-panel id=panel-0-0-0 name=0-0 role=tabpanel tabindex=0><div class="highlight-python notranslate"><div class=highlight><pre><span></span><span class=kn>import</span><span class=w> </span><span class=nn>lief</span>

<span class=n>pe</span><span class=p>:</span> <span class=n>lief</span><span class=o>.</span><span class=n>PE</span><span class=o>.</span><span class=n>Binary</span> <span class=o>=</span> <span class=o>...</span>

<span class=n>callbacks</span><span class=p>:</span> <span class=nb>list</span><span class=p>[</span><span class=nb>int</span><span class=p>]</span> <span class=o>=</span> <span class=n>pe</span><span class=o>.</span><span class=n>tls</span><span class=o>.</span><span class=n>callbacks</span>

<span class=c1># Remove the last entry</span>
<span class=n>callbacks</span><span class=o>.</span><span class=n>pop</span><span class=p>()</span>

<span class=c1># Add an address</span>
<span class=n>callbacks</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=mh>0x140001010</span><span class=p>)</span>

<span class=n>tls</span><span class=o>.</span><span class=n>callbacks</span> <span class=o>=</span> <span class=n>callbacks</span>

<span class=n>pe</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=s2>"tls_modified.exe"</span><span class=p>)</span>
</pre></div></div></div><div aria-labelledby=tab-0-0-1 class=sphinx-tabs-panel hidden id=panel-0-0-1 name=0-1 role=tabpanel tabindex=0><div class="highlight-cpp notranslate"><div class=highlight><pre><span></span><span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;LIEF/PE.hpp></span>

<span class=n>std</span><span class=o>::</span><span class=n>unique_ptr</span><span class=o>&lt;</span><span class=n>LIEF</span><span class=o>::</span><span class=n>PE</span><span class=o>::</span><span class=n>Binary</span><span class=o>></span><span class=w> </span><span class=n>pe</span><span class=p>;</span>

<span class=n>std</span><span class=o>::</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>uint64_t</span><span class=o>></span><span class=w> </span><span class=n>callbacks</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>pe</span><span class=o>-></span><span class=n>callbacks</span><span class=p>();</span>

<span class=cp># Remove the last entry</span>
<span class=n>callbacks</span><span class=p>.</span><span class=n>pop_back</span><span class=p>();</span>

<span class=cp># Add an address</span>
<span class=n>callbacks</span><span class=p>.</span><span class=n>push_back</span><span class=p>(</span><span class=mh>0x140001010</span><span class=p>);</span>

<span class=n>tls</span><span class=o>-></span><span class=n>callbacks</span><span class=p>(</span><span class=n>std</span><span class=o>::</span><span class=n>move</span><span class=p>(</span><span class=n>callbacks</span><span class=p>));</span>

<span class=n>pe</span><span class=o>-></span><span class=n>write</span><span class=p>(</span><span class=s>"tls_modified.exe"</span><span class=p>);</span>
</pre></div></div></div><div aria-labelledby=tab-0-0-2 class=sphinx-tabs-panel hidden id=panel-0-0-2 name=0-2 role=tabpanel tabindex=0><div class="highlight-rust notranslate"><div class=highlight><pre><span></span><span class=kd>let</span><span class=w> </span><span class=k>mut</span><span class=w> </span><span class=n>pe</span><span class=p>:</span><span class=w> </span><span class=nc>lief</span><span class=p>::</span><span class=n>pe</span><span class=p>::</span><span class=n>Binary</span><span class=p>;</span>

<span class=kd>let</span><span class=w> </span><span class=k>mut</span><span class=w> </span><span class=n>tls</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>pe</span><span class=p>.</span><span class=n>tls</span><span class=p>().</span><span class=n>unwrap</span><span class=p>();</span>

<span class=kd>let</span><span class=w> </span><span class=k>mut</span><span class=w> </span><span class=n>callbacks</span><span class=p>:</span><span class=w> </span><span class=nb>Vec</span><span class=o>&lt;</span><span class=kt>u64</span><span class=o>></span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>tls</span><span class=p>.</span><span class=n>callbacks</span><span class=p>();</span>

<span class=p>#</span><span class=w> </span><span class=n>Remove</span><span class=w> </span><span class=n>the</span><span class=w> </span><span class=n>last</span><span class=w> </span><span class=n>entry</span>
<span class=n>callbacks</span><span class=p>.</span><span class=n>pop</span><span class=p>();</span>

<span class=p>#</span><span class=w> </span><span class=n>Add</span><span class=w> </span><span class=n>an</span><span class=w> </span><span class=n>address</span>
<span class=n>callbacks</span><span class=p>.</span><span class=n>push</span><span class=p>(</span><span class=mh>0x140001010</span><span class=p>);</span>

<span class=n>tls</span><span class=p>.</span><span class=n>set_callbacks</span><span class=p>(</span><span class=n>callbacks</span><span class=p>);</span>

<span class=n>pe</span><span class=p>.</span><span class=n>write</span><span class=p>(</span><span class=s>"tls_modified.exe"</span><span class=p>);</span>
</pre></div></div></div></div><div class="tip admonition"><p class=admonition-title>Relocations<p>Note that LIEF <strong>automatically</strong> manages the relocations that must be created or removed when modifying the TLS callbacks.</div></section><section id=tls-creation><h2 id=tls-creation>TLS Creation<a title="Link to this heading" class=headerlink href=#tls-creation>¶</a></h2><p>If a PE binary does not contain TLS metadata, LIEF can be used to create this structure.<p>First, we can create and initiate a TLS instance:<div class="sphinx-tabs docutils container"><div aria-label="Tabbed content" class=closeable role=tablist><button aria-controls=panel-1-1-0 aria-selected=true class=sphinx-tabs-tab id=tab-1-1-0 name=1-0 role=tab tabindex=0><em class="fa fa-brands fa-python"></em> Python</button><button aria-controls=panel-1-1-1 aria-selected=false class=sphinx-tabs-tab id=tab-1-1-1 name=1-1 role=tab tabindex=-1><em class="fa fa-regular fa-file-code"></em> C++</button><button aria-controls=panel-1-1-2 aria-selected=false class=sphinx-tabs-tab id=tab-1-1-2 name=1-2 role=tab tabindex=-1><em class="fa fa-brands fa-rust"></em> Rust</button></div><div aria-labelledby=tab-1-1-0 class=sphinx-tabs-panel id=panel-1-1-0 name=1-0 role=tabpanel tabindex=0><div class="highlight-python notranslate"><div class=highlight><pre><span></span><span class=kn>import</span><span class=w> </span><span class=nn>lief</span>

<span class=n>tls</span> <span class=o>=</span> <span class=n>lief</span><span class=o>.</span><span class=n>PE</span><span class=o>.</span><span class=n>TLS</span><span class=p>()</span>

<span class=n>tls</span><span class=o>.</span><span class=n>callbacks</span> <span class=o>=</span> <span class=p>[</span>
    <span class=mh>0x140001000</span><span class=p>,</span>
    <span class=mh>0x140001010</span><span class=p>,</span>
<span class=p>]</span>
</pre></div></div></div><div aria-labelledby=tab-1-1-1 class=sphinx-tabs-panel hidden id=panel-1-1-1 name=1-1 role=tabpanel tabindex=0><div class="highlight-cpp notranslate"><div class=highlight><pre><span></span><span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;LIEF/PE.hpp></span>

<span class=n>LIEF</span><span class=o>::</span><span class=n>PE</span><span class=o>::</span><span class=n>TLS</span><span class=w> </span><span class=n>tls</span><span class=p>;</span>

<span class=n>tls</span><span class=p>.</span><span class=n>callbacks</span><span class=p>(</span><span class=n>std</span><span class=o>::</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>uint64_t</span><span class=o>></span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=mh>0x140001000</span><span class=p>,</span>
<span class=w>    </span><span class=mh>0x140001010</span><span class=p>,</span>
<span class=p>});</span>
</pre></div></div></div><div aria-labelledby=tab-1-1-2 class=sphinx-tabs-panel hidden id=panel-1-1-2 name=1-2 role=tabpanel tabindex=0><div class="highlight-rust notranslate"><div class=highlight><pre><span></span><span class=k>use</span><span class=w> </span><span class=n>lief</span><span class=p>;</span>

<span class=kd>let</span><span class=w> </span><span class=k>mut</span><span class=w> </span><span class=n>tls</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>lief</span><span class=p>::</span><span class=n>pe</span><span class=p>::</span><span class=n>TLS</span><span class=p>::</span><span class=n>new</span><span class=p>();</span>

<span class=n>tls</span><span class=p>.</span><span class=n>set_callbacks</span><span class=p>(</span><span class=fm>vec!</span><span class=p>[</span>
<span class=w>  </span><span class=mh>0x140001000</span><span class=p>,</span>
<span class=w>  </span><span class=mh>0x140001010</span><span class=p>,</span>
<span class=p>]);</span>
</pre></div></div></div></div><div class=fixed-paragraph>And then, we can add this instance to a <div class=dropdown style=display:inline;><a aria-expanded=false aria-haspopup=true data-toggle=dropdown href=# id=lief-api-lief-PE-Binary role=button> <code><span class=pre>lief.PE.Binary</span></code></a><div aria-labelledby=lief-api-lief-PE-Binary class=dropdown-menu><a class=dropdown-item href=https://lief.re/doc/stable/rust/lief/pe/struct.Binary.html> <code class="xref rust rust-struct"><span class=pre><i class="fa fa-brands fa-rust"></i> lief::pe::Binary</span></code> </a><a class=dropdown-item href=../python.html#lief.PE.Binary> <code class="xref py py-class"><span class=pre><i class="fa fa-brands fa-python"></i> lief.PE.Binary</span></code> </a><a class=dropdown-item href=../cpp.html#_CPPv4N4LIEF2PE6BinaryE> <code class="xref cpp cpp-class"><span class=pre><i class="fa fa-regular fa-file-code"></i> LIEF::PE::Binary</span></code> </a></div></div>:</div><div class="sphinx-tabs docutils container"><div aria-label="Tabbed content" class=closeable role=tablist><button aria-controls=panel-2-2-0 aria-selected=true class=sphinx-tabs-tab id=tab-2-2-0 name=2-0 role=tab tabindex=0><em class="fa fa-brands fa-python"></em> Python</button><button aria-controls=panel-2-2-1 aria-selected=false class=sphinx-tabs-tab id=tab-2-2-1 name=2-1 role=tab tabindex=-1><em class="fa fa-regular fa-file-code"></em> C++</button><button aria-controls=panel-2-2-2 aria-selected=false class=sphinx-tabs-tab id=tab-2-2-2 name=2-2 role=tab tabindex=-1><em class="fa fa-brands fa-rust"></em> Rust</button></div><div aria-labelledby=tab-2-2-0 class=sphinx-tabs-panel id=panel-2-2-0 name=2-0 role=tabpanel tabindex=0><div class="highlight-python notranslate"><div class=highlight><pre><span></span><span class=n>pe</span><span class=p>:</span> <span class=n>lief</span><span class=o>.</span><span class=n>PE</span><span class=o>.</span><span class=n>Binary</span> <span class=o>=</span> <span class=o>...</span>

<span class=n>pe</span><span class=o>.</span><span class=n>tls</span> <span class=o>=</span> <span class=n>tls</span> <span class=c1># `tls` defined previously</span>

<span class=n>pe</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=s2>"tls_demo.exe"</span><span class=p>)</span>
</pre></div></div></div><div aria-labelledby=tab-2-2-1 class=sphinx-tabs-panel hidden id=panel-2-2-1 name=2-1 role=tabpanel tabindex=0><div class="highlight-cpp notranslate"><div class=highlight><pre><span></span><span class=n>std</span><span class=o>::</span><span class=n>unique_ptr</span><span class=o>&lt;</span><span class=n>LIEF</span><span class=o>::</span><span class=n>PE</span><span class=o>::</span><span class=n>Binary</span><span class=o>></span><span class=w> </span><span class=n>pe</span><span class=p>;</span>

<span class=n>pe</span><span class=o>-></span><span class=n>tls</span><span class=p>(</span><span class=n>tls</span><span class=p>);</span><span class=w> </span><span class=c1>// `tls` defined previously</span>

<span class=n>pe</span><span class=o>-></span><span class=n>write</span><span class=p>(</span><span class=s>"tls_demo.exe"</span><span class=p>);</span>
</pre></div></div></div><div aria-labelledby=tab-2-2-2 class=sphinx-tabs-panel hidden id=panel-2-2-2 name=2-2 role=tabpanel tabindex=0><div class="highlight-rust notranslate"><div class=highlight><pre><span></span><span class=kd>let</span><span class=w> </span><span class=k>mut</span><span class=w> </span><span class=n>pe</span><span class=p>:</span><span class=w> </span><span class=nc>lief</span><span class=p>::</span><span class=n>pe</span><span class=p>::</span><span class=n>Binary</span><span class=p>;</span>

<span class=n>pe</span><span class=p>.</span><span class=n>set_tls</span><span class=p>(</span><span class=o>&</span><span class=n>tls</span><span class=p>);</span><span class=w> </span><span class=c1>// `tls` defined previously</span>

<span class=n>pe</span><span class=p>.</span><span class=n>write</span><span class=p>(</span><span class=s>"tls_demo.exe"</span><span class=p>);</span>
</pre></div></div></div></div><div class="tip admonition"><p class=admonition-title>Relocations<p>Similary to the TLS callbacks modifications, LIEF <strong>automatically</strong> manages the relocations. In addition, it automatically initialize (if not set by the user) <code class="docutils literal notranslate"><span class=pre>AddressOfIndex</span></code> which is mandatory when defining up TLS metadata.</div></section></section></div><div class="col-xl-2 d-none d-xl-block px-0 py-5 docs-sidebar docs-sidebar-right"><aside class="border-left pl-5 py-3"><span class="text-uppercase text-muted font-size-sm d-block mb-3"> On this page: </span><a class="d-block my-2" data-toggle=scroll href=#tls-modifications>TLS Modifications</a><a class="d-block my-2" data-toggle=scroll href=#tls-creation>TLS Creation</a></aside></div></div></div>